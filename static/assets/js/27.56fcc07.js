(window.webpackJsonp=window.webpackJsonp||[]).push([[27,9],{"+KRo":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-get-param"},[t("bk-table",{attrs:{data:e.paramTableData,size:"small"}},[t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),prop:"name"}}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['必选']")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n      ")]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{attrs:{title:i.row.desc}},[e._v(e._s(i.row.desc||"--"))])]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.isStatic?[e._v("\n          "+e._s(i.row.customValue||"--")+"\n        ")]:e.isCustom?[t("bk-input",{attrs:{clearable:!0,placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:i.row.customValue,callback:function(t){e.$set(i.row,"customValue",t)},expression:"props.row.customValue"}})]:[t("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",left:"15px"}},[t("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:i.row.source_type,callback:function(t){e.$set(i.row,"source_type",t)},expression:"props.row.source_type"}},e._l(e.sourceTypeList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),"CUSTOM"===i.row.source_type?t("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[t("bk-input",{class:{"bk-border-error":i.row.isCheck&&!i.row.value.toString()},attrs:{clearable:!0,placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:i.row.value,callback:function(t){e.$set(i.row,"value",t)},expression:"props.row.value"}})],1):t("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[t("bk-select",{class:{"bk-border-error":i.row.isCheck&&!i.row.value.toString()},attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:i.row.value_key,callback:function(t){e.$set(i.row,"value_key",t)},expression:"props.row.value_key"}},[e._l(e.stateList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),e._v(" "),"addField"!==e.entry?[t("div",{staticStyle:{cursor:"pointer"},attrs:{slot:"extension"},on:{click:function(t){return e.addNewItem(i.row)}},slot:"extension"},[t("i",{staticClass:"bk-icon icon-plus-circle mr10"}),e._v(e._s(e.$t('m.treeinfo["添加变量"]'))+"\n                ")])]:e._e()],2)],1)]]}}])})],1)],1)},a=[];n._withStripped=!0},"+LW1":function(e,t,i){},"+PGD":function(e,t,i){},"+QRE":function(e,t,i){"use strict";i.r(t);var n=i("gEzK"),a=i("h1eg");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("LaJ4");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"18c81a71",null);t.default=o.exports},"+iuc":function(e,t,i){i("wgeU"),i("FlQf"),i("bBy9"),i("B9jh"),i("dL40"),i("xvv9"),i("V+O7"),e.exports=i("WEpk").Set},"/5i8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("ukIK")),a=o(i("xl+m")),r=o(i("T3vI")),s=o(i("/ojM"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"responseContent",components:{changeConductor:n.default,sendMessage:a.default,apiCall:r.default,modifyField:s.default},props:{item:{type:Object,default:function(){return{}}},signal:String},data:function(){return{}},computed:{onlyBackendSignals:function(){return this.$store.state.common.configurInfo.only_backend_signals||[]},isShowFrontendTrigger:function(){return!this.onlyBackendSignals.includes(this.signal)},disableRepeat:function(){return"GLOBAL_LEAVE_STATE"===this.signal||"GLOBAL_ENTER_STATE"===this.signal}},watch:{isShowFrontendTrigger:{handler:function(e){e||(this.item.performData.runMode="BACKEND")},immediate:!0},signal:{handler:function(e){"GLOBAL_LEAVE_STATE"!==e&&"GLOBAL_ENTER_STATE"!==e||(this.item.performData.repeat="more")},immediate:!0}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.$set(this.item,"contentStatus",!1),"api"===this.item.wayInfo.key?this.item.wayInfo.field_schema.forEach((function(t){"api_source"===t.key?(e.$set(t,"systemId",""),e.$set(t,"apiId","")):e.$set(t,"apiContent",{})})):this.item.wayInfo.field_schema.forEach((function(t){var i=t.value||"";if("MEMBERS"===t.type||"MULTI_MEMBERS"===t.type)if(i=[],t.value)t.value.forEach((function(e){if(e.value){var t={key:e.value.member_type,value:e.value.members,secondLevelList:[],isLoading:!1};i.push(t)}}));else{i.push({key:"",value:"",secondLevelList:[],isLoading:!1})}e.$set(t,"value",i),"SUBCOMPONENT"===t.type&&t.sub_components&&t.sub_components.length&&t.sub_components.forEach((function(t){t.field_schema.length&&t.field_schema.forEach((function(t){var i=t.value||"";"MEMBERS"!==t.type&&"MULTI_MEMBERS"!==t.type||(i=[],Array.isArray(t.value)?t.value.forEach((function(e){if(e.value){var t={key:e.value.member_type,value:e.value.members,secondLevelList:[],isLoading:!1};i.push(t)}})):i=[{key:"",value:"",secondLevelList:[],isLoading:!1}]),e.$set(t,"value",i)}))}))}))}}}},"/7qM":function(e,t,i){},"/9eO":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("CeR/"),r=i("2Mt+"),s=(n=r)&&n.__esModule?n:{default:n};t.default={name:"apiCall",components:{inputParams:s.default},props:{item:{type:Object,default:function(){return{}}}},data:function(){return{apiSysList:[],apiList:[],apiId:"",isLoading:!1}},mounted:function(){this.getRemoteSystemData(),this.initData()},methods:{initData:function(){var e=this;this.item.wayInfo.field_schema.forEach((function(t){"api_source"===t.key&&t.value&&e.getApiContent(t.value)}))},getRemoteSystemData:function(){var e=this,t={project_key:this.$route.query.project_id};this.$store.dispatch("apiRemote/get_all_remote_system",t).then((function(t){e.apiSysList=t.data.filter((function(e){return e.is_activated}))})).catch((function(t){(0,a.errorHandler)(t,e)})).finally((function(){}))},changeCode:function(){this.getApiTableList(arguments[2].systemId),arguments[2].apiId="",this.apiId=""},getApiTableList:function(e){var t=this;console.log(e);var i={remote_system:e||""};this.$store.dispatch("apiRemote/get_remote_api",i).then((function(e){t.apiList=e.data.filter((function(e){return e.is_activated}))})).catch((function(e){(0,a.errorHandler)(e,t)})).finally((function(){}))},changeApi:function(e){var t=arguments,i=this;this.isLoading=!0;var n=this.apiList.filter((function(e){return e.id===t[0]}))[0];this.item.wayInfo.field_schema.forEach((function(e){e.apiContent=n,i.$set(e.apiContent,"bodyTableData",[])})),this.apiId=e,setTimeout((function(){i.isLoading=!1}),1e3)},getApiContent:function(e){var t=this;this.isLoading=!0;var i={id:e};this.$store.dispatch("apiRemote/get_remote_api_detail",i).then((function(i){var n=i.data;t.item.wayInfo.field_schema.forEach((function(i){"api_source"===i.key&&i.value?(i.apiId=e,i.systemId=n.remote_system):(i.apiContent=n,t.$set(i.apiContent,"bodyTableData",[]))})),t.getApiTableList(n.remote_system),t.apiId=e,setTimeout((function(){t.isLoading=!1}),1e3)})).catch((function(e){(0,a.errorHandler)(e,t)})).finally((function(){}))}}}},"/BG8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("Jwqd"),r=i("WSG0"),s=(n=r)&&n.__esModule?n:{default:n};var o={styles:{type:Object,default:function(){return{}}},value:{type:[String,Array],default:""}};t.default={name:"TagText",mixins:[(0,a.getFormMixins)(o)],data:function(){return{}},computed:{hasChildren:function(){return this.form.children&&Array.isArray(this.form.children)&&!!this.form.children.length}},methods:{onClick:function(){if(this.hasChildren){var e="";e=Array.isArray(this.value)?this.value.map((function(e){return(e.label||"")+e.value})).join(","):(this.label||"")+this.value;var t=this.getContext();if(t.config&&"combine"===t.config.mode)this.getTopViewItem().appendCrumbsItem(e,this.form.children);else(0,s.default)({title:e,formData:this.form.children,context:t})}}}}},"/Hw/":function(e,t,i){"use strict";i.r(t);var n=i("Ncax"),a=i("HOWN");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("5f0d");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"8cd94c38",null);t.default=o.exports},"/KdC":function(e,t,i){"use strict";i.r(t);var n=i("in5P"),a=i("13wB");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},"/ojM":function(e,t,i){"use strict";i.r(t);var n=i("jUNn"),a=i("aDD8");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("20vx");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"b4f443ec",null);t.default=o.exports},"070I":function(e,t,i){"use strict";i.r(t);var n=i("nCLG"),a=i("hAcJ");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("e07s");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"532d79ca",null);t.default=o.exports},"0Oxo":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-select",{class:{"bk-border-error":e.item.checkValue},attrs:{disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,searchable:"",multiple:"","font-size":"medium",placeholder:e.item.desc},on:{selected:e.selected,toggle:function(t){e.item.checkValue=!1}},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}},e._l(e.options,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},"0njq":function(e,t,i){"use strict";i.r(t);var n=i("UL6+"),a=i("Mf0c");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("lSBQ");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"65ef1e14",null);t.default=o.exports},"0nzv":function(e,t,i){"use strict";i("Dx75")},"0rd9":function(e,t,i){"use strict";i.r(t);var n=i("3ncw"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"0uNP":function(e,t,i){"use strict";i.r(t);var n=i("DoRf"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"0vGa":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("QbLZ")),a=o(i("KW1/")),r=i("L2JU"),s=i("CeR/");function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"triggerCondition",components:{triggerField:a.default},props:{triggerRules:{type:Object,default:function(){return{}}}},data:function(){return{keyList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,r.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),mounted:function(){this.keyList=this.triggerVariables,this.$set(this.triggerRules,"checkStatus",!1)},methods:{addLine:function(e,t,i){e.itemList.splice(i+1,0,{condition:"",key:"",value:"",conditionList:[],type:"STRING"})},deleteLine:function(e,t,i){1!==e.itemList.length&&e.itemList.splice(i,1)},changeBetween:function(e){e.type="all"===e.type?"any":"all"},handleBetween:function(){this.triggerRules.type="all"===this.triggerRules.type?"any":"all"},addGroup:function(){this.triggerRules.list.push({type:"all",itemList:[{key:"",condition:"",value:"",conditionList:[],type:"STRING"}]})},deleteGroup:function(e,t){1!==this.triggerRules.list.length&&this.triggerRules.list.splice(t,1)},changeContent:function(e){var t=this.keyList.filter((function(t){return t.key===e.key}))[0],i=t.type.toLowerCase();e.conditionList=this.globalChoise.trigger_methods[i],this.getConditionList(t,e),e.condition="",this.$set(e,"conditionType",""),e.type=t.type;e.value=["MEMBERS","MEMBER","MULTI_MEMBERS","MULTISELECT","CHECKBOX"].some((function(t){return t===e.type}))?[]:""},changeCondition:function(e){var t=e.conditionList.filter((function(t){return t.name===e.condition}))[0];this.$set(e,"conditionType",t.input_type)},getConditionList:function(e,t){var i=this;["SELECT","RADIO","MULTISELECT","CHECKBOX"].some((function(t){return t===e.type}))&&(this.$set(t,"loading",!0),this.$set(t,"options",[]),"DATADICT"===e.source_type?this.$store.dispatch("datadict/get_data_by_key",{key:e.source_uri,field_key:e.key}).then((function(e){t.options=e.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(e){(0,s.errorHandler)(e,i)})).finally((function(){t.loading=!1})):"API"===e.source_type?this.$store.dispatch("apiRemote/get_data_workflow",{kv_relation:e.kv_relation,api_instance_id:e.api_instance_id}).then((function(e){t.options=e.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(e){(0,s.errorHandler)(e,i)})).finally((function(){t.loading=!1})):"RPC"===e.source_type?this.$store.dispatch("apiRemote/getRpcData",{meta:e.meta,source_uri:e.source_uri}).then((function(e){t.options=e.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(e){(0,s.errorHandler)(e,i)})).finally((function(){t.loading=!1})):(t.options=e.choice.map((function(e){return{key:e.key,name:e.name}})),t.loading=!1))}}}},"11QV":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(i("jWXv")),a=y(i("rfXi")),r=y(i("P2sY")),s=y(i("QbLZ")),o=y(i("gDS+")),l=y(i("14Xm")),c=y(i("D3Ub")),u=y(i("GQeE")),f=y(i("PaSM")),d=y(i("Y6/M")),m=y(i("JGQq")),p=y(i("lAAG")),h=y(i("qVGl")),v=y(i("XDfz")),b=y(i("2Vgw")),g=i("ughI"),k=i("CeR/"),_=i("ygAv");function y(e){return e&&e.__esModule?e:{default:e}}t.default={name:"addField",components:{dataSource:d.default,dataContent:m.default,customTableData:p.default,defaultValue:h.default,hiddenConditions:v.default},mixins:[f.default],props:{formAlign:{type:String,default:"vertical"},changeInfo:{type:Object,default:function(){return{}}},workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},sospInfo:{type:Object,default:function(){return{}}},addOrigin:{type:Object,default:function(){return{isOther:!1,addOriginInfo:{}}}},isEditPublic:{type:Boolean,default:!1},templateStage:{type:String,default:""},templateInfo:{type:Object,default:function(){return{}}},autoSelectedType:{type:Boolean,default:!0},nodesList:Array},data:function(){return{isShowDataSource:!1,isDataLoading:!1,trueStatus:!0,falseStatus:!1,secondClick:!1,isPublicField:!1,formInfo:{prevId:"",name:"",key:"",type:"",regex:"",regex_config:{rule:{expressions:[],type:"and"}},customRegex:"",source_type:"",source_uri:"",default_value:"",layout:"",validate:"",desc:"",is_tips:!1,tips:"",show_type:!1,show_conditions:{}},regexFieldList:[],allBetweenList:[{id:1,available:"INT",name:this.$t("m.common['大于']"),typeName:">"},{id:2,available:"INT",name:this.$t("m.common['小于']"),typeName:"<"},{id:3,available:"INT",name:this.$t("m.common['不大于']"),typeName:"<="},{id:4,available:"INT",name:this.$t("m.common['不小于']"),typeName:">="},{id:5,available:"DATE",name:this.$t("m.common['早于']"),typeName:"<"},{id:6,available:"DATE",name:this.$t("m.common['晚于']"),typeName:">"},{id:7,available:"DATE",name:this.$t("m.common['不早于']"),typeName:">="},{id:8,available:"DATE",name:this.$t("m.common['不晚于']"),typeName:"<="}],betweenList:[],customTableInfo:{list:[{name:"",display:"input",choice:"",required:!1,nameCheck:!1,check:!1}]},prevNodeList:[],frontNodesList:[],regexList:[],showType:{sourceList:["SELECT","MULTISELECT","CHECKBOX","RADIO","TABLE","TREESELECT","INPUTSELECT"],belongDefaultList:["STRING","TEXT","INT","DATE","DATETIME","DATETIMERANGE","SELECT","MULTISELECT","CHECKBOX","RADIO","MEMBER","MEMBERS","INPUTSELECT","RICHTEXT","CUSTOM-FORM"],multipleList:["MULTISELECT","CHECKBOX","MEMBERS","MEMBER"],layoutList:["TABLE","CUSTOMTABLE","RICHTEXT","CUSTOM-FORM"]},rules:{},assignValue:{},fieldInfo:{list:[{name:"",key:"",required:!1}]},apiDetail:{},apiInfo:{api_info:{remote_system_id:"",remote_api_id:"",req_params:{},req_body:{},rsp_data:""},kv_relation:{key:"",name:""}},dictionaryData:{list:[],check:""},prcData:{list:[],check:""},prcTable:[],fileList:[],fileVal:"",checkStatus:{customStatus:!1,customTableStatus:!1,customFormStatus:!1},fieldTypeList:[],hiddenConditionStatus:!0,initFormData:{}}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo},isShowDataSourcebtn:function(){return!("API"!==this.formInfo.source_type&&"CUSTOM"!==this.formInfo.source_type||0===(0,u.default)(this.apiDetail).length&&0===this.fieldInfo.list.length)},isDisabled:function(){return"API"===this.formInfo.source_type&&!this.apiInfo.api_info.remote_api_id}},watch:{formInfo:{handler:function(e){this.$emit("getAddFieldStatus",""!==e.name)},deep:!0},isShowDataSource:function(e){e&&(this.initFormData.bodyTableData=(0,_.deepClone)(this.$refs.dataContent[0].$refs.postParam.bodyTableData),this.initFormData.selectInfo=(0,_.deepClone)(this.$refs.dataContent[0].$refs.responseData.selectInfo))}},mounted:function(){var e=this;return(0,c.default)(l.default.mark((function t(){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isDataLoading=!0,t.next=3,e.initData();case 3:e.rules.name=e.checkCommonRules("name").name,e.rules.key=e.checkCommonRules("key").key,e.rules.type=e.checkCommonRules("select").select,e.rules.tips=e.checkCommonRules("select").select,e.rules.prevId=e.checkCommonRules("select").select,e.isDataLoading=!1,"add"===e.changeInfo.id&&e.autoSelectedType&&e.changeType();case 10:case"end":return t.stop()}}),t,e)})))()},methods:{validateContent:function(){this.checkField()?this.openDataSource():this.isShowDataSource=!1,this.$emit("change")},openDataSource:function(){this.isShowDataSource=!0},fieldNameChange:function(){var e=this.$refs.fieldForm.$data.formItems.find((function(e){return"key"===e.property}));e.fieldValue&&(e.validator.content="",e.validator.state=""),this.$emit("change")},initData:function(){var e=this;this.fieldTypeList=this.globalChoise.field_type.filter((function(e){return"DATETIMERANGE"!==e.typeName})),"COMPLEX-MEMBERS"!==this.changeInfo.type&&"SOPS_TEMPLATE"!==this.changeInfo.type||"templateField"!==this.addOrigin.addOriginInfo.type||(this.fieldTypeList=this.fieldTypeList.concat([{name:this.$t("m.common['复杂人员选择']"),typeName:"COMPLEX-MEMBERS"},{name:this.$t("m.common['标准运维模板']"),typeName:"SOPS_TEMPLATE"}])),this.globalChoise.source_type.forEach((function(t){var i="CUSTOM"===t.typeName?e.$t("m.treeinfo['自定义数据每行的name和key都不能相同。']"):e.$t("m.treeinfo['接口中的数据详情']");e.$set(t,"desc",i)})),this.nodesList?this.frontNodesList=this.nodesList:this.getFrontNodesList(),this.changeRegex("ASSOCIATED_FIELD_VALIDATION"),this.assignmentData(),this.getRegexList(),this.getRpcList(),this.getSysDictList(),this.getPreStates()},assignmentData:function(e){var t=this,i=e||this.changeInfo;if(this.formInfo.name=i.name,this.formInfo.key=i.key,this.formInfo.type=i.type,this.formInfo.regex=i.regex,i.regex_config&&i.regex_config.rule&&(this.changeRegex("ASSOCIATED_FIELD_VALIDATION"),this.formInfo.regex_config.rule.type=i.regex_config.rule.type,this.formInfo.regex_config=i.regex_config),"CUSTOM"===this.formInfo.regex&&(this.formInfo.customRegex=i.custom_regex||""),this.formInfo.layout=i.layout,this.formInfo.validate=i.validate_type,this.formInfo.desc=i.desc,this.formInfo.is_tips=i.is_tips,this.formInfo.tips=i.tips,this.formInfo.default_value=this.showType.multipleList.some((function(e){return e===i.type}))&&""!==i.default?i.default.split(","):i.default||"",this.formInfo.source_type=i.source_type,"CUSTOM"===i.source_type)if("FILE"===i.type)for(var n in i.choice)this.fileList.push(i.choice[n]);else 0!==i.choice.length&&(this.fieldInfo.list=[],i.choice.forEach((function(e){t.fieldInfo.list.push({name:e.name,key:e.key,required:!!e.required,nameCheck:!1,keyCheck:!1})})));else"API"===this.formInfo.source_type?this.apiInfo.api_info=i.api_info:"DATADICT"===this.formInfo.source_type?(this.formInfo.source_uri=i.source_uri,this.dictionaryData.check=this.formInfo.source_uri):"RPC"===this.formInfo.source_type&&(this.formInfo.source_uri=i.source_uri,this.prcData.check=i.source_uri);this.formInfo.show_type=0===i.show_type,this.formInfo.show_conditions=i.show_conditions||{},"CUSTOMTABLE"===this.formInfo.type&&(this.customTableInfo.list=[],Object.prototype.hasOwnProperty.call(i.meta,"columns")?i.meta.columns.forEach((function(e){var i=[];e.choice.forEach((function(e){i.push(e.name)})),t.customTableInfo.list.push({name:e.name,display:e.display,choice:i.join("\n"),required:e.required,nameCheck:!1,check:!1})})):this.customTableInfo.list.push({name:"",display:"input",choice:"",required:!1,nameCheck:!1,check:!1})),(0,u.default)(this.sospInfo).length&&(this.formInfo.name=this.sospInfo.name||"",this.formInfo.validate="REQUIRE"),this.initFormData.formInfo=(0,_.deepClone)(this.formInfo),this.assignValue=JSON.parse((0,o.default)(i))},getFrontNodesList:function(){var e=this;return(0,c.default)(l.default.mark((function t(){var i,n;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state||e.templateInfo.id){t.next=2;break}return t.abrupt("return");case 2:return i="",n={},e.state&&(i="apiRemote/get_related_fields",n.workflow=e.workflow,n.state=e.state),e.templateInfo.id&&(i="taskTemplate/getFrontFieldsList",n.id=e.templateInfo.id,n.stage=e.templateStage),t.next=8,e.$store.dispatch(i,n).then((function(t){e.frontNodesList=t.data})).catch((function(t){(0,k.errorHandler)(t,e)}));case 8:case"end":return t.stop()}}),t,e)})))()},addExpression:function(){this.formInfo.regex_config.rule.expressions.push({condition:"",key:"",source:"field",type:this.formInfo.type,value:""})},deleteExpression:function(e){1!==this.formInfo.regex_config.rule.expressions.length&&this.formInfo.regex_config.rule.expressions.splice(e,1)},changeType:function(){var e=this;return(0,c.default)(l.default.mark((function t(){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$emit("change"),e.formInfo.regex="EMPTY",e.formInfo.customRegex="",e.showType.layoutList.includes(e.formInfo.type)&&(e.formInfo.layout="COL_12"),e.formInfo.field="",e.dictionaryData.check="","TREESELECT"===e.formInfo.type?e.formInfo.source_type="DATADICT":e.formInfo.source_type="CUSTOM",e.fieldInfo.list.length||(e.fieldInfo.list=[{name:"",key:"",required:!1,nameCheck:!1,keyCheck:!1}]),"CUSTOM-FORM"===e.formInfo.type&&(e.formInfo.default_value=g.CUSTOM_FORM_DEFAULT_VALUE),t.next=11,e.getRegexList();case 11:e.formInfo.regex_config.rule.expressions=[];case 12:case"end":return t.stop()}}),t,e)})))()},changeRegex:function(e){var t=this;this.formInfo.customRegex="","ASSOCIATED_FIELD_VALIDATION"===e&&(this.regexFieldList=this.frontNodesList.filter((function(e){return"INT"===t.formInfo.type?e.type===t.formInfo.type:"DATE"===e.type||"DATETIME"===e.type})).filter((function(e){return e.id!==t.changeInfo.id})),["DATE","DATETIME"].includes(this.formInfo.type)&&this.regexFieldList.push({name:"系统时间",id:"system_time",key:"system_time",source:"system"}),this.betweenList=this.allBetweenList.filter((function(e){return"INT"===t.formInfo.type?"INT"===e.available:"DATE"===e.available})),this.betweenList.push({name:"等于",typeName:"=="}),this.formInfo.regex_config.rule.expressions.length||this.addExpression())},getRegexList:function(){var e=this,t=this.formInfo.type;this.$store.dispatch("cdeploy/regexList",t).then((function(t){e.regexList=t.data.regex_choice.map((function(t){return{name:t[1]?t[1]:e.$t('m.treeinfo["无"]'),typeName:t[0]}}))})).catch((function(t){(0,k.errorHandler)(t,e)}))},onRegexFieldChange:function(e,t){this.$emit("change");t.source=["system_time"].includes(e)?"system":"field"},relateSelected:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];t[2].type=t[1].type,t[2].source=t[1].source},putKey:function(){var e=this;"number"!=typeof this.changeInfo.id&&(this.formInfo.key="",(0,b.default)(this.formInfo.name,{style:b.default.STYLE_NORMAL,heteronym:!1}).forEach((function(t){e.formInfo.key=""+e.formInfo.key+t})),this.formInfo.key=this.formInfo.key.toUpperCase(),this.formInfo.key=this.formInfo.key.replace(/\ /g,"_"),this.formInfo.key.length>=32&&(this.formInfo.key=this.formInfo.key.substr(0,32)))},changeApiInfo:function(e){this.$emit("change"),this.apiDetail=e},getRpcData:function(e){this.prcTable=e},handleFile:function(e){var t=this;this.$emit("change");for(var i=e.target.files[0],n=i.size/1024,a=i.name,r=0;r<this.fileList.length;r++)if(a===this.fileList[r].name)return void this.$bkMessage({message:this.$t('m.treeinfo["此文件已经上传"]'),theme:"error"});if(n<=1e5){var o=new FormData;o.append("field_file",i),this.$store.dispatch("cdeploy/fileUpload",{data:o}).then((function(e){for(var i in e.data.succeed_files)t.fileList.push((0,s.default)({},e.data.succeed_files[i],{key:i}));t.fileVal="",t.$bkMessage({message:t.$t('m.treeinfo["上传成功"]'),theme:"success"})})).catch((function(e){(0,k.errorHandler)(e,t)}))}else this.fileVal="",this.$bkMessage({message:this.$t('m.treeinfo["该文件大小超过100MB！"]'),theme:"error"})},deleteFile:function(e,t){this.fileList.splice(t,1)},addField:function(){var e=this;return(0,c.default)(l.default.mark((function t(){var i,n,a,s;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDataContent();case 2:if(i=t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!e.secondClick){t.next=7;break}return t.abrupt("return");case 7:e.secondClick=!0,"number"==typeof e.changeInfo.id?(n=e.changeInfo.id,a="TABLE"===e.changeInfo.source?"cdeploy/changeNewModuleField":"cdeploy/changeNewField",e.addOrigin.isOther&&e.addOrigin.addOriginInfo.updateUrl&&(a=e.addOrigin.addOriginInfo.updateUrl,"templateField"===e.addOrigin.addOriginInfo.type&&(i.task_schema_id=e.templateInfo.id,i.stage=e.templateStage,"COMPLEX-MEMBERS"!==i.type&&"SOPS_TEMPLATE"!==i.type||delete i.type)),e.changeInfo.project_key&&(i.project_key=e.changeInfo.project_key),e.$store.dispatch(a,{params:i,id:n}).then((function(){e.$bkMessage({message:e.$t('m.treeinfo["修改成功"]'),theme:"success"}),e.$emit("closeShade"),e.addOrigin.isOther&&e.addOrigin.addOriginInfo.updateUrl&&"templateField"!==e.addOrigin.addOriginInfo.type&&e.$parent.$parent.getList?e.$parent.$parent.getList():e.$parent.$parent.getTableList?e.$parent.$parent.getTableList():e.$emit("getRelatedFields"),e.$emit("onConfirm",(0,r.default)({},e.changeInfo,i))})).catch((function(t){(0,k.errorHandler)(t,e)})).finally((function(){e.secondClick=!1}))):(i.state=e.state,(0,u.default)(e.sospInfo).length&&(i.state=e.formInfo.prevId),s="cdeploy/addNewField",e.addOrigin.isOther&&e.addOrigin.addOriginInfo.addUrl&&(s=e.addOrigin.addOriginInfo.addUrl,"templateField"===e.addOrigin.addOriginInfo.type&&(i.task_schema_id=e.templateInfo.id,i.stage=e.templateStage)),e.changeInfo.project_key&&(i.project_key=e.changeInfo.project_key),e.$store.dispatch(s,{params:i}).then((function(t){e.addNew=t.data,e.$bkMessage({message:e.$t('m.treeinfo["新增成功"]'),theme:"success"}),e.$emit("closeShade"),e.addOrigin.isOther&&e.addOrigin.addOriginInfo.addUrl?"templateField"===e.addOrigin.addOriginInfo.type&&e.$parent.$parent.getTableList?e.$parent.$parent.getTableList():e.$parent.$parent.getList&&e.$parent.$parent.getList():e.$parent.$parent.getTableList?e.$parent.$parent.getTableList():(e.$emit("getRelatedFields"),e.$parent.$parent.showNew&&e.$parent.$parent.showNew(e.sospInfo,t)),e.$emit("onConfirm",t.data)})).catch((function(t){(0,k.errorHandler)(t,e)})).finally((function(){e.secondClick=!1})));case 9:case"end":return t.stop()}}),t,e)})))()},onCancelClick:function(){this.$emit("closeShade"),this.$emit("onCancel")},checkInfo:function(){var e=this;this.$refs.fieldForm.validate().then((function(){e.$refs.dataSource&&e.$refs.dataSource.checkSouce()||e.checkField()||(!e.formInfo.is_tips||e.formInfo.tips?e.addField():e.$bkMessage({theme:"warning",message:e.$t('m.treeinfo["字段释疑为必填项"]')}))}),(function(e){console.error(e)}))},getDataContent:function(){var e=this;return(0,c.default)(l.default.mark((function t(){var i,r,s,o,c,u;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i={}).layout=e.formInfo.layout,i.validate_type=e.formInfo.validate,i.regex=e.formInfo.regex,i.regex_config=e.formInfo.regex_config,i.desc=e.formInfo.desc,i.is_tips=e.formInfo.is_tips,i.tips=e.formInfo.tips,i.default="",e.showType.belongDefaultList.some((function(t){return t===e.formInfo.type}))&&(s=[],(r=["MULTISELECT","CHECKBOX","MEMBERS","MEMBER"]).some((function(t){return t===e.formInfo.type}))&&e.formInfo.default_value&&(s=e.formInfo.default_value.filter((function(e){return""!==e}))),i.default=r.some((function(t){return t===e.formInfo.type}))?s.join(","):e.formInfo.default_value),!e.$refs.hiddenConditions){t.next=20;break}if(!e.$refs.hiddenConditions.checkList()){t.next=14;break}return e.hiddenConditionStatus=!1,t.abrupt("return",!1);case 14:o=e.$refs.hiddenConditions.listInfo,i.show_conditions={type:e.$refs.hiddenConditions.conditionType,expressions:[]},o.forEach((function(e){i.show_conditions.expressions.push({key:e.key,condition:e.condition,value:Array.isArray(e.value)?e.value.join(","):e.value,type:e.type})})),i.show_type=0,t.next=22;break;case 20:i.show_type=1,i.show_conditions={};case 22:if("TABLE"===e.changeInfo.source){t.next=65;break}if(i.workflow=e.workflow,i.name=e.formInfo.name,i.key=e.formInfo.key,i.type=e.formInfo.type,i.desc=e.formInfo.desc,i.source_type=e.formInfo.source_type||"CUSTOM",i.custom_regex=e.formInfo.customRegex,i.is_tips=e.formInfo.is_tips,i.tips=e.formInfo.tips,"FILE"!==e.formInfo.type){t.next=37;break}i.choice={},e.fileList.forEach((function(t){e.$set(i.choice,t.key,t)})),t.next=54;break;case 37:if("CUSTOM"!==e.formInfo.source_type){t.next=42;break}i.choice=[],"SELECT"===e.formInfo.type||"MULTISELECT"===e.formInfo.type||"CHECKBOX"===e.formInfo.type||"RADIO"===e.formInfo.type||"INPUTSELECT"===e.formInfo.type?e.fieldInfo.list.forEach((function(e){i.choice.push({key:e.key,name:e.name})})):"TABLE"===e.formInfo.type&&e.fieldInfo.list.forEach((function(e){i.choice.push({key:e.key,name:e.name,required:e.required})})),t.next=54;break;case 42:if("API"!==e.formInfo.source_type){t.next=53;break}if("API"!==e.formInfo.source_type){t.next=49;break}return t.next=46,e.$refs.dataContent[0].apiFz();case 46:if(t.sent){t.next=49;break}return t.abrupt("return",!1);case 49:i.api_info=e.apiInfo.api_info,i.kv_relation=e.apiInfo.kv_relation,t.next=54;break;case 53:"DATADICT"===e.formInfo.source_type&&(i.choice=[],i.source_uri=e.dictionaryData.check);case 54:if("CUSTOMTABLE"!==e.formInfo.type){t.next=64;break}if(e.customTableInfo.list.forEach((function(e){var t=[];!e.choice||"select"!==e.display&&"multiselect"!==e.display||(t=e.choice.split("\n").filter((function(e){return e.length>0}))),e.nameCheck=0===e.name.length||e.name.length>120,e.check=!t.length&&("select"===e.display||"multiselect"===e.display)})),c=e.customTableInfo.list.some((function(e){return e.nameCheck})),u=e.customTableInfo.list.some((function(e){return e.check})),!c&&!u){t.next=61;break}return e.$bkMessage({theme:"warning",message:e.$t('m.treeinfo["请填写正确格式的自定义数据"]')}),t.abrupt("return",!1);case 61:i.meta={},i.meta.columns=[],e.customTableInfo.list.forEach((function(e){var t=e.choice.split("\n").filter((function(e){return e.length>0}));t=(0,a.default)(new n.default(t)),i.meta.columns.push({name:e.name,display:e.display,choice:e.choice.length?t:[],required:e.required})}));case 64:"RPC"===e.formInfo.source_type&&(i.source_uri=e.prcData.check,i.meta={},e.prcTable.forEach((function(e){var t="CUSTOM"===e.source_type?e.value:"${params_"+e.value_key+"}";i.meta[e.name]=t})));case 65:return t.abrupt("return",e.timeConversion(i));case 66:case"end":return t.stop()}}),t,e)})))()},timeConversion:function(e){var t=this;return""!==e.default&&("DATE"!==e.type&&"DATETIME"!==e.type||(e.default="DATE"===e.type?this.standardDayTime(e.default):this.standardTime(e.default))),e.show_conditions&&e.show_conditions.expressions&&e.show_conditions.expressions.length&&e.show_conditions.expressions.forEach((function(e){"DATE"!==e.type&&"DATETIME"!==e.type||(e.value="DATE"===e.type?t.standardDayTime(e.value):t.standardTime(e.value))})),e},checkField:function(){var e=this;this.checkStatus.customStatus=!1,this.checkStatus.customTableStatus=!1,this.checkStatus.customFormStatus=!1;if(["SELECT","MULTISELECT","CHECKBOX","RADIO","TABLE"].some((function(t){return e.formInfo.type===t}))&&"CUSTOM"===this.formInfo.source_type&&(this.fieldInfo.list.forEach((function(e){e.nameCheck=e.name.length>120||0===e.name.length,e.keyCheck=!/[a-zA-Z0-9]+$/.test(e.key)})),this.fieldInfo.list.forEach((function(t,i){e.fieldInfo.list.forEach((function(e,n){i!==n&&(e.key===t.key&&(t.keyCheck=!0),e.name===t.name&&(t.nameCheck=!0))}))})),this.checkStatus.customStatus=this.fieldInfo.list.some((function(e){return e.nameCheck||e.keyCheck}))),"CUSTOMTABLE"===this.formInfo.type){var t=[];this.customTableInfo.list.forEach((function(e){var i=[];!e.choice||"select"!==e.display&&"multiselect"!==e.display||(i=e.choice.split("\n").filter((function(e){return e.length>0}))),e.nameCheck=0===e.name.length||e.name.length>120,e.check=!i.length&&("select"===e.display||"multiselect"===e.display),t.includes(e.name)?e.nameCheck=!0:t.push(e.name)})),this.checkStatus.customTableStatus=this.customTableInfo.list.some((function(e){return e.nameCheck||e.check}))}if("CUSTOM-FORM"===this.formInfo.type)try{var i=JSON.parse(this.formInfo.default_value);i&&(this.checkStatus.customFormStatus=!i.schemes||!i.form_data)}catch(e){this.checkStatus.customFormStatus=!0}return this.checkStatus.customStatus||this.checkStatus.customTableStatus||this.checkStatus.customFormStatus},getRpcList:function(){var e=this;this.$store.dispatch("datadict/getPrcData").then((function(t){var i=["table_fields","flow_states"];e.prcData.list=t.data.filter((function(e){return-1===i.indexOf(e.key)})),e.prcData.list.filter((function(t){return t.key===e.prcData.check})).length&&(e.prcTable=e.prcData.list.filter((function(t){return t.key===e.prcData.check}))[0].req_params)})).catch((function(t){(0,k.errorHandler)(t,e)}))},getSysDictList:function(){var e=this;this.$store.dispatch("datadict/list",{}).then((function(t){e.dictionaryData.list=t.data.filter((function(e){return e.is_enabled}))})).catch((function(t){(0,k.errorHandler)(t,e)}))},getPreStates:function(){var e=this;this.state&&this.$store.dispatch("deployCommon/getPreStates",{id:this.state}).then((function(t){e.prevNodeList=t.data})).catch((function(t){(0,k.errorHandler)(t,e)}))}}}},"11RT":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mt20 mb20"},[e.openFunction.TRIGGER_SWITCH&&"workflow"!==e.origin&&"transition"!==e.origin?t("div",{staticClass:"more-configuration",attrs:{"data-test-id":"trigger-div-showMoreConfig"},on:{click:function(t){e.showMoreConfig=!e.showMoreConfig}}},[e.showMoreConfig?t("i",{staticClass:"bk-icon icon-up-shape"}):t("i",{staticClass:"bk-icon icon-down-shape"}),e._v(" "),t("span",[e._v(e._s(e.$t("m.taskTemplate['高级配置']")))])]):e._e(),e._v(" "),e.showMoreConfig?t("div",{staticClass:"common-section-card-block mt20",class:[{"inner-mode":"workflow"===e.origin||"transition"===e.origin}]},[t("label",{staticClass:"common-section-card-label"},[e._v("\n      "+e._s(e.$t("m.newCommon['触发器']"))+"\n    ")]),e._v(" "),t("div",{staticClass:"common-section-card-body"},[e.showMoreConfig?[t("collapse-transition",[t("div",[t("div",[t("ul",{staticClass:"bk-trigger-content"},[e._l(e.boundTriggerList,(function(i,n){return t("li",{key:n,class:{"li-transition":"transition"===e.origin},on:{click:function(t){return t.stopPropagation(),e.openNew("add",i)}}},[t("span",{staticClass:"bk-trigger-icon"},[t("i",{staticClass:"bk-itsm-icon icon-info-circle icon-slide",staticStyle:{"font-size":"24px"}})]),e._v(" "),t("span",{staticClass:"bk-trigger-name",attrs:{title:i.name}},[e._v(e._s(i.name||"--")+"\n                    "),i.is_draft?t("span",{staticStyle:{color:"#3A84FF"}},[e._v(e._s(e.$t('m.taskTemplate["(草稿)"]')))]):e._e()]),e._v(" "),t("span",{staticClass:"bk-trigger-delete"},[t("i",{staticClass:"bk-icon icon-delete",on:{click:function(t){return t.stopPropagation(),e.delTrigger(i)}}})])])})),e._v(" "),t("bk-dropdown-menu",{staticStyle:{float:"left"},attrs:{trigger:"click"}},[t("div",{staticClass:"bk-trigger-add",attrs:{slot:"dropdown-trigger",title:e.$t("m.taskTemplate['添加触发器']")},slot:"dropdown-trigger"},[t("i",{staticClass:"bk-icon icon-plus"})]),e._v(" "),t("ul",{staticClass:"bk-dropdown-list",attrs:{slot:"dropdown-content"},slot:"dropdown-content"},[t("li",[t("a",{attrs:{href:"javascript:;","data-test-id":"taskTemplate-li-addTrigger"},on:{click:function(t){return e.openNew("add")}}},[e._v(e._s(e.$t("m.taskTemplate['新建']")))])]),e._v(" "),t("li",[t("a",{attrs:{href:"javascript:;","data-test-id":"taskTemplate-li-quoteCommonTrigger"},on:{click:function(t){return e.openNew("cite")}}},[e._v(e._s(e.$t("m.taskTemplate['引用公共触发器']")))])])])])],2)])])])]:e._e()],2),e._v(" "),[t("bk-dialog",{attrs:{theme:"primary",width:"660","mask-close":!1},model:{value:e.triggerDialogInfo.isShow,callback:function(t){e.$set(e.triggerDialogInfo,"isShow",t)},expression:"triggerDialogInfo.isShow"}},[t("div",{staticClass:"trigger-dialog-header",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(e.$t("m.taskTemplate['引用公共触发器']")))]),e._v(" "),t("div",{staticClass:"bk-search-key"},[t("bk-input",{attrs:{clearable:!0,"right-icon":"bk-icon icon-search"},on:{enter:e.searchInfo,clear:e.clearSearch},model:{value:e.triggerDialogInfo.searchKey,callback:function(t){e.$set(e.triggerDialogInfo,"searchKey",t)},expression:"triggerDialogInfo.searchKey"}})],1)]),e._v(" "),t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.triggerDialogInfo.listLoading},expression:"{ isLoading: triggerDialogInfo.listLoading }"}],staticClass:"trigger-dialog-box"},[0===e.triggerDialogInfo.list.length?t("p",{staticClass:"dialog-none-content"},[t("i",{staticClass:"bk-icon icon-info-circle"}),e._v(" "),t("span",[e._v(e._s(e.$t("m.taskTemplate['暂无匹配的公共触发器，']")))]),e._v(" "),t("span",{staticClass:"bk-primary",on:{click:e.newTrigger}},[e._v(e._s(e.$t("m.taskTemplate['跳转创建']")))])]):[t("span",[e._v(e._s(e.$t("m.taskTemplate['根据您当前的引用位置，系统已筛选出适用的公共触发器。']")))]),e._v(" "),t("ul",{staticClass:"bk-trigger-content"},e._l(e.triggerDialogInfo.list,(function(i,n){return t("li",{key:n,class:{"li-checked":i.checked},on:{click:function(e){i.checked=!i.checked}}},[t("span",{staticClass:"bk-trigger-icon"},[t("i",{staticClass:"bk-itsm-icon icon-info-circle",class:[i.iconKey],staticStyle:{"font-size":"24px"}})]),e._v(" "),t("span",{staticClass:"bk-trigger-name",attrs:{title:i.name}},[e._v(e._s(i.name||"--"))]),e._v(" "),t("span",{staticClass:"bk-trigger-delete"},[t("bk-checkbox",{attrs:{value:i.checked}})],1)])})),0)]],2),e._v(" "),t("div",{staticClass:"trigger-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("bk-checkbox",{attrs:{value:Boolean(e.triggerDialogInfo.list.length===e.citeList.length&&e.triggerDialogInfo.list.length),"ext-cls":"checkbox",disabled:!e.triggerDialogInfo.list.length},on:{change:e.selectAllFn}},[e._v(e._s(e.$t("m.taskTemplate['全选']")))]),e._v(" "),t("span",[e._v(e._s(e.$t("m.taskTemplate['已选']"))),t("span",[e._v(e._s(e.citeList.length))]),e._v("个")]),e._v(" "),t("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"common-trigger-confirm",title:e.$t("m.taskTemplate['确定']")},on:{click:e.citeTrigger}},[e._v("\n            "+e._s(e.$t("m.taskTemplate['确定']"))+"\n          ")]),e._v(" "),t("bk-button",{staticClass:"mr10",attrs:{theme:"default",title:e.$t("m.taskTemplate['取消']")},on:{click:e.initDialogInfo}},[e._v("\n            "+e._s(e.$t("m.taskTemplate['取消']"))+"\n          ")])],1)])],e._v(" "),[t("bk-sideslider",{attrs:{"is-show":e.triggerSliderInfo.isShow,title:e.triggerSliderInfo.title,width:e.triggerSliderInfo.width,"quick-close":!0,"before-close":e.handleBeforeClose},on:{"update:isShow":function(t){return e.$set(e.triggerSliderInfo,"isShow",t)},"update:is-show":function(t){return e.$set(e.triggerSliderInfo,"isShow",t)}}},[t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.triggerSliderInfo.addLoading},expression:"{ isLoading: triggerSliderInfo.addLoading }"}],staticStyle:{"min-height":"300px"},attrs:{slot:"content"},slot:"content"},[e.triggerSliderInfo.isShow?t("add-trigger",{attrs:{"node-type":e.nodeType,"trigger-info":e.triggerSliderInfo.item,"origin-info-to-trigger":e.originInfoToTrigger},on:{closeTrigger:function(t){e.triggerSliderInfo.isShow=!1},getList:e.getBoundTriggerList,change:function(t){e.isFormChanged=!0}}}):e._e()],1)])]],2):e._e()])},a=[];n._withStripped=!0},"12KD":function(e,t,i){"use strict";i.r(t);var n=i("si5w"),a=i("9RFn");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("Nq3X");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"1c26078b",null);t.default=o.exports},"13wB":function(e,t,i){"use strict";i.r(t);var n=i("ohl0"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"1TTJ":function(e,t,i){},"1h6V":function(e,t,i){"use strict";i("nDi6")},"1hFm":function(e,t,i){"use strict";i.r(t);var n=i("NFkJ"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"1u4o":function(e,t,i){"use strict";i("GXg3")},"1w2S":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this._self._c;return e("div",{staticClass:"no-data"},[e("img",{attrs:{src:this.imgUrl}}),this._v(" "),e("p",{style:{"font-size":this.fontSize+"px"}},[this._v("\n    "+this._s(this.text||this.$t('m.treeinfo["暂无数据"]'))+"\n  ")])])},a=[];n._withStripped=!0},"20vx":function(e,t,i){"use strict";i("8MAP")},"25E2":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=x(i("z1yn")),a=x(i("jub7")),r=x(i("Za/z")),s=x(i("u14n")),o=x(i("/KdC")),l=x(i("TNjk")),c=x(i("qyUP")),u=x(i("VrAx")),f=x(i("4K0D")),d=x(i("nxpg")),m=x(i("eOfU")),p=x(i("MBfY")),h=x(i("/Hw/")),v=x(i("Q3ZP")),b=x(i("Wl5c")),g=x(i("0njq")),k=x(i("+QRE")),_=x(i("070I")),y=x(i("gy7N")),I=x(i("aYIO")),C=x(i("SUIt")),w=x(i("BWJp")),S=x(i("PaSM")),T=i("ygAv"),L=i("CeR/");function x(e){return e&&e.__esModule?e:{default:e}}t.default={name:"fieldInfo",components:{"CW-STRING":n.default,"CW-LINK":a.default,"CW-INT":r.default,"CW-TEXT":s.default,"CW-CHECKBOX":o.default,"CW-RADIO":l.default,"CW-SELECT":c.default,"CW-INPUTSELECT":u.default,"CW-MULTISELECT":f.default,"CW-DATE":d.default,"CW-DATETIME":m.default,"CW-MEMBER":p.default,"CW-MEMBERS":h.default,"CW-TABLE":v.default,"CW-CUSTOMTABLE":b.default,"CW-RICHTEXT":g.default,"CW-TREESELECT":k.default,"CW-FILE":_.default,"CW-CASCADE":y.default,"CW-SOPS_TEMPLATE":I.default,"CW-DEVOPS_TEMPLATE":C.default},mixins:[w.default,S.default],props:{fields:{type:Array,required:!0,default:function(){return[]}},allFieldList:{type:Array,default:function(){return[]}},basicInfomation:{type:Object,default:function(){return{}}},origin:{type:String,default:"normal"},typeInfo:{type:String,default:function(){return""}},disabled:{type:Boolean,default:!1}},data:function(){return{rotate:!1,labelWidth:200}},created:function(){var e=this;this.fields.forEach((function(t){e.$set(t,"checkValue",!1)}))},mounted:function(){var e=this;this.$nextTick((function(){e.labelWidth=e.$refs.fieldContent.clientWidth/2||200}))},methods:{freshBtn:function(e){this.rotate=!this.rotate,"CreateTicket"===this.$route.name?this.freshApi(e,this.fields,"submit"):this.freshApi(e,this.fields,"field")},freshRpc:function(e){var t=this;this.rotate=!this.rotate,this.$store.dispatch("apiRemote/getRpcData",e).then((function(t){e.choice=t.data,e.val=""})).catch((function(e){(0,L.errorHandler)(e,t)}))},fieldChange:function(){this.fieldFormatting(this.fields)},checkBuiltInTaskTemplate:function(){var e=this,t=[];return this.fields.forEach((function(i,n){"SOPS_TEMPLATE"!==i.type&&"DEVOPS_TEMPLATE"!==i.type||t.push(e.$refs["component"+n][0].validate())})),t.every((function(e){return!!e}))},jointVerification:function(){var e=this,t=!0;return this.relatedRegex(this.fields,(0,T.isEmpty)(this.allFieldList)?this.fields:this.allFieldList).validList.forEach((function(i){i.result||(t=!1,i.validList.forEach((function(t){var i=e.fields.find((function(e){return e.key===t.key}));i&&!i.checkValue&&(i.checkValue=!0,i.checkMessage=t.tips)})))})),t},requiredVerification:function(){var e=this,t=this.fields.filter((function(e){return e.showFeild&&"REQUIRE"===e.validate_type})).filter((function(e){return"CUSTOMTABLE"===e.type?e.meta.columns.some((function(e){return e.required})):"SOPS_TEMPLATE"!==e.type&&"DEVOPS_TEMPLATE"!==e.type})).filter((function(t){var i=!1;t.checkValue=!1;var n="";switch(t.type){case"TABLE":var a=!0;t.choice.forEach((function(e){""!==t.value[0][e.key]?a=!1:n+=e.name+", "})),i=a,n&&(n+=e.$t('m.newCommon["为必填项！"]'));break;case"CUSTOMTABLE":var r=!1;t.meta.columns.forEach((function(e){return t.value.forEach((function(t){e.required&&(0,T.isEmpty)(t[e.key])&&(n+=e.name+", ",r=!0)}))})),i=r,n&&(n+=e.$t('m.newCommon["为必填项！"]'));break;default:i=(0,T.isEmpty)(t.value)}return n&&(t.checkMessage=n,i=!0),t.checkValue=i,i})),i=this.checkBuiltInTaskTemplate();return!t.length&&i},checkValue:function(){this.fieldChange();var e=this.requiredVerification(),t=this.jointVerification();return e&&t}}}},"29mx":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-date-picker",{class:{"bk-border-error":e.item.checkValue},attrs:{placeholder:e.$t("m.newCommon['选择日期']"),disabled:e.item.is_readonly&&!e.isCurrent||e.disabled},on:{"open-change":function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},"2Mt+":function(e,t,i){"use strict";i.r(t);var n=i("OV2Y"),a=i("TOmV");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("0nzv");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"89121fbe",null);t.default=o.exports},"30Fg":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.loading},expression:"{ isLoading: loading }"},{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeTree,expression:"closeTree"}],staticClass:"bk-search-tree",class:e.extCls},[t("div",{staticClass:"bk-search-tree-wrapper",on:{click:function(t){return t.stopPropagation(),e.showTree("view")}}},[t("span",{class:{"bk-color-tree":e.displayName}},[e._v("\n      "+e._s(e.displayName||e.$t('m.serviceConfig["请选择"]'))+"\n    ")]),e._v(" "),e.organizationLoading?t("i",{staticClass:"bk-select-angle bk-itsm-icon icon-icon-loading"}):e._e()]),e._v(" "),t("transition",{attrs:{name:"common-fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowTree,expression:"isShowTree"}],staticClass:"bk-search-tree-content"},[t("tree",{attrs:{"tree-data-list":e.displayList},on:{toggle:e.toggleInfo,toggleChildren:function(t){return e.toggleChildren(...arguments,"view")}}})],1)])],1)},a=[];n._withStripped=!0},"34/K":function(e,t,i){"use strict";i.r(t);var n=i("8fx1"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"3Xpq":function(e,t,i){"use strict";i("TlPd")},"3jvg":function(e,t,i){"use strict";i.r(t);var n=i("j7Oh"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"3nH4":function(e,t,i){"use strict";i("wXXQ")},"3ncw":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("efIh"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"LINK",mixins:[r.default],props:{item:{type:Object,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value)}}},"429m":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("14Xm")),a=r(i("D3Ub"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"getRpcParam",components:{},props:{prcTable:{type:Array,default:function(){return[]}},changeInfo:{type:Object,default:function(){return{}}},stateList:{type:Array,default:function(){return[]}},formInfo:{type:Object,default:function(){return{}}}},data:function(){return{sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}]}},computed:{},watch:{prcTable:function(){this.initData()}},mounted:function(){var e=this;return(0,a.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.changeInfo;case 2:e.initData();case 3:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;this.prcTable.forEach((function(t){for(var i in e.$set(t,"isCheck",!1),e.$set(t,"isSatisfied",!1),e.$set(t,"el",null),e.$set(t,"source_type","CUSTOM"),e.$set(t,"value_key",""),e.changeInfo.meta)t.name===i&&(-1!==e.changeInfo.meta[i].indexOf("{params_")?(t.source_type="FIELDS",t.value_key=e.changeInfo.meta[i].split("${params_")[1].split("}")[0]):(t.source_type="CUSTOM",t.value=e.changeInfo.meta[i]))}))}}}},"45Gy":function(e,t,i){"use strict";i("tnQB")},"46OK":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(i("gDS+")),a=u(i("14Xm")),r=u(i("D3Ub")),s=u(i("PRQd")),o=u(i("bcjM")),l=u(i("u8Ap")),c=i("CeR/");function u(e){return e&&e.__esModule?e:{default:e}}t.default={name:"commonStep",components:{fieldConfig:s.default,commonTriggerList:o.default,memberSelect:l.default},props:{templateInfo:{type:Object,default:function(){return{}}},step:{type:Number,default:""},stepList:{type:Array,default:function(){return[]}}},data:function(){return{firstStepInfo:{name:"",ownersInputValue:"",desc:"",changeName:"",changeOwners:"",changeDesc:""},formRule:{name:[{required:!0,message:this.$t("m.taskTemplate['请输入任务名称']"),trigger:"blur"}]},buttonLoading:!1,changedTemplateInfo:{}}},watch:{step:function(){this.initData()}},mounted:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.changedTemplateInfo=JSON.parse((0,n.default)(e.templateInfo.itemInfo)),e.firstStepInfo.name=e.changedTemplateInfo.name,e.firstStepInfo.ownersInputValue=e.changedTemplateInfo.owners?e.changedTemplateInfo.owners.split(","):[],e.firstStepInfo.desc=e.changedTemplateInfo.desc;case 4:case"end":return t.stop()}}),t,e)})))()},cancelStep:function(){this.$parent.backTab()},stepChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"next",t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,r.default)(a.default.mark((function r(){var s,o;return a.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("changeName"!==n){a.next=6;break}return s=!1,a.next=4,t.$refs.taskInfoForm.validate().then((function(){s=!0}),(function(){}));case 4:if(s){a.next=6;break}return a.abrupt("return");case 6:o={params:{name:t.firstStepInfo.name,component_type:t.changedTemplateInfo.component_type,is_draft:!!i||2!==t.step&&t.changedTemplateInfo.is_draft,is_builtin:!1,owners:t.firstStepInfo.ownersInputValue.join(","),desc:t.firstStepInfo.desc},id:t.changedTemplateInfo.id},n||(o.params.task_fields={stage:t.stepList[t.step].stage,task_field_ids:t.$refs.field.showTabList.map((function(e){return e.id}))}),t.buttonLoading=!0,t.$store.dispatch("taskTemplate/updateTemplate",o).then((function(e){t.$bkMessage({message:t.$t("m.taskTemplate['保存成功']"),theme:"success"}),t.changedTemplateInfo=e.data})).catch((function(e){(0,c.errorHandler)(e,t)})).finally((function(){if(t.$parent.changeTemplateInfo(t.changedTemplateInfo),t.initData(),t.buttonLoading=!1,n)t.cancelEdit(n);else if(!i)if(2!==t.step){var a="previous"===e?t.step-1:t.step+1,r={id:a+1,name:t.stepList[a].name,type:"primary",is_draft:t.changedTemplateInfo.is_draft,show:!1};t.$parent.changeTree(r,a)}else t.$parent.backTab()}));case 10:case"end":return a.stop()}}),r,t)})))()},cancelEdit:function(e){this.firstStepInfo[e]="","changeName"===e?this.firstStepInfo.name=this.changedTemplateInfo.name:"changeOwners"===e?this.firstStepInfo.ownersInputValue=this.changedTemplateInfo.owners?this.changedTemplateInfo.owners.split(","):[]:this.firstStepInfo.desc=this.changedTemplateInfo.desc}}}},"4K0D":function(e,t,i){"use strict";i.r(t);var n=i("0Oxo"),a=i("CyHO");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},"4lVZ":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i("m1cH")),a=f(i("14Xm")),r=f(i("gDS+")),s=f(i("GQeE")),o=f(i("D3Ub")),l=f(i("BkRI")),c=f(i("VflG")),u=f(i("9ZYk"));function f(e){return e&&e.__esModule?e:{default:e}}t.default={name:"responseData",components:{exportTree:u.default},mixins:[c.default],props:{changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){}},stateList:{type:Array,default:function(){return[]}},remoteApiIid:{type:[String,Number],default:function(){return""}},formInfo:{type:Object,default:function(){return{}}}},data:function(){return{organization:{processorPerson:[],processorTree:{},assignorPerson:[],assignorTree:{}},organizaInfo:{assignorShow:[!1,!1,!1]},cascaderData:[],bodyTableData:[],responseTableData:[],paramTableData:[],checkInfo:{name:"",road:""},sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],paramTableInfo:{value:"",placeholder:this.$t('m.treeinfo["请选择数据来源"]')},selectInfo:{selectkeylist:[],selectkey:"",selectvaluelist:[],selectvalue:""},isShow:!1,tampFormInfo:{ancestorsList_str:"",isSelectedKey:"",isSelectedValue:"",settingKeyName:"",settingValueName:""},isCheck:!1,maxLevel:1,maxLevelTree:[1,1,1],settingKeyName:"",settingValueName:""}},computed:{},watch:{"apiDetail.rsp_data":{handler:function(){this.initData()},deep:!0}},mounted:function(){this.initData()},methods:{initData:function(){this.responseTableDataChange()},responseTableDataChange:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var i,n,c,u,f,d,m,p;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.selectInfo={selectkeylist:[],selectkey:"",selectvaluelist:[],selectvalue:""},e.organization={processorPerson:[],processorTree:{},assignorPerson:[],assignorTree:{}},e.maxLevel=1,e.maxLevelTree=[1,1,1],e.settingKeyName="",e.settingValueName="",t.next=8,e.changeInfo;case 8:if((0,s.default)(e.apiDetail.rsp_data).length){t.next=13;break}e.apiDetail.responseTreeDataList=[{has_children:!1,showChildren:!0,checkInfo:!1,key:"root",is_necessary:!0,type:"object",desc:e.$t('m.treeinfo["初始化数据"]'),parentInfo:"",children:[]}],e.apiDetail.responseTableData=[],t.next=19;break;case 13:return t.next=15,e.jsonschemaToList({root:JSON.parse((0,r.default)(e.apiDetail.rsp_data))});case 15:return e.apiDetail.responseTreeDataList=t.sent,t.next=18,e.treeToTableList(JSON.parse((0,r.default)(e.apiDetail.responseTreeDataList[0].children)));case 18:e.apiDetail.responseTableData=t.sent;case 19:return t.next=21,JSON.parse((0,r.default)(e.apiDetail.responseTableData));case 21:return i=t.sent,t.next=24,i.forEach((function(t){t.children=[],t.source_type="CUSTOM",t.value="",t.name=t.key,t.isSelectAbled=!1,t.isSelectedKey=!1,t.isSelectedKeyDisabled=!1,t.isSelectedValue=!1,t.isSelectedValueDisabled=!e.changeInfo.api_info}));case 24:return t.next=26,e.recordChildren(i);case 26:return t.next=28,e.recordParent(i);case 28:return t.next=30,e.showSelectAbled(i);case 30:return n=t.sent,t.next=33,n.forEach(function(){var t=(0,o.default)(a.default.mark((function t(i){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.markCanUseArray(i);case 2:case"end":return t.stop()}}),t,e)})));return function(e){return t.apply(this,arguments)}}());case 33:return t.next=35,i;case 35:return e.responseTableData=t.sent,c=e.responseTableData.filter((function(e){return!e.level&&"data"===e.key})),t.next=39,e.makeArrayTree(c);case 39:if(e.cascaderData=t.sent,e.organization.assignorPerson=e.cascaderData[0]||[],!e.changeInfo.api_info||e.changeInfo.api_info.remote_api_id!==e.apiDetail.id){t.next=64;break}return t.next=44,e.changeInfo.api_info.rsp_data.split(".");case 44:return u=t.sent,t.next=47,u.map((function(e,t){return e=t+"_"+e}));case 47:return f=t.sent,d=f.length+"_items_0",f.push(d),m=f.concat(e.changeInfo.kv_relation.key.split(".").map((function(e,t){return f.length+t+"_"+e}))).join(),p=f.concat(e.changeInfo.kv_relation.name.split(".").map((function(e,t){return f.length+t+"_"+e}))).join(),e.tampFormInfo.ancestorsList_str=f.toString(),e.responseTableData.forEach((function(t){t.ancestorsList_str===m&&(t.isSelectedKey=!0,e.tampFormInfo.isSelectedKey=t.ancestorsList_str,e.tampFormInfo.settingKeyName=t.name),t.ancestorsList_str===p&&(t.isSelectedValue=!0,e.tampFormInfo.isSelectedValue=t.ancestorsList_str,e.tampFormInfo.settingValueName=t.name)})),t.next=56,e.organization.assignorPerson.forEach((function(t){e.treeData(t,"assignors")}));case 56:e.selectInfo.selectkeylist=e.responseTableData.filter((function(e){return e.ancestorsList.join()===f.join()})),e.selectInfo.selectkey=e.tampFormInfo.isSelectedKey,e.selectInfo.selectvaluelist=(0,l.default)(e.selectInfo.selectkeylist),e.selectInfo.selectvalue=e.tampFormInfo.isSelectedValue,e.settingValueName=e.tampFormInfo.settingValueName,e.settingKeyName=e.tampFormInfo.settingKeyName,e.giveFirstCheckInfo(e.selectInfo.selectkeylist,m),e.giveFirstCheckInfo(e.selectInfo.selectvaluelist,p);case 64:case"end":return t.stop()}}),t,e)})))()},giveFirstCheckInfo:function(e,t){var i=this;e.forEach((function(e){e.ancestorsList_str===t&&(e.checkInfo=!0),e.has_children&&e.children.length&&"object"===e.type&&i.giveFirstCheckInfo(e.children,t)}))},treeData:function(e,t){var i=this;e.checkInfo=!1,e.has_children=!(!e.children||!e.children.length),e.showChildren=!0,String(this.tampFormInfo.ancestorsList_str.split(",").slice(0,-1).toString())===String(e.ancestorsList_str)&&"assignors"===t&&(e.checkInfo=!0,this.organization.assignorTree=e),e.has_children&&e.children.forEach((function(e){i.treeData(e,t)}))},recordChildren:function(e,t){var i=e.map((function(e){return e.level}));this.maxLevel=Math.max.apply(Math,(0,n.default)(i));for(var a=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0].children.push(t)}(e,t)}))},r=this.maxLevel;r>(t||0);r--)a(r)},recordParent:function(e,t){for(var i=this.maxLevel,n=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){t.level?t.parentInfo=e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0]:t.parentInfo=""}(e,t)}))},a=0;a<=(t||i);a++)n(a)},markCanUseArray:function(e){e.isCanUseArray=!0,e.level&&this.markCanUseArray(e.parentInfo)},makeArrayTree:function(e){var t=[];return function e(t,i){i.forEach((function(n){i.name=n.name,i.isSelect=!1,i.ancestorsList_str=n.ancestorsList_str;var a=n.children;i.children=[],t.push(i),a&&a.length&&e(i.children,a)}))}(t,e),t},changeState:function(e){e.showChildren=!e.showChildren,e.children.forEach((function(t){t.isShow=e.showChildren})),e.showChildren||this.closeChildren(e)},closeChildren:function(e){var t=this;e.children.forEach((function(e){e.isShow=!1,e.has_children&&(e.showChildren=!1,t.closeChildren(e))}))},changeType:function(){},selectOneKey:function(e){var t=e.isSelectedKey;this.responseTableData.forEach((function(e){e.isSelectedKey=!1})),e.isSelectedKey=!t,this.responseTableData.filter((function(e){return e.isSelectAbled})).forEach((function(t){t.isSelectedKeyDisabled=!1,t.isSelectedValueDisabled=t.parentInfo!==e.parentInfo})),this.responseTableData.filter((function(t){return t.isSelectAbled&&t.parentInfo!==e.parentInfo})).forEach((function(e){e.isSelectedValue=!1}))},selectOneValue:function(e){var t=e.isSelectedValue;this.responseTableData.forEach((function(e){e.isSelectedValue=!1})),e.isSelectedValue=!t},countArrayAncestors:function(e){var t=[];return function e(i){"array"===i.parentInfo.type&&(t.push(i.parentInfo),e(i.parentInfo)),"object"===i.parentInfo.type&&e(i.parentInfo)}(e),t},showSelectAbled:function(e){var t=this;return(0,o.default)(a.default.mark((function i(){var n,r;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=[],r=e.filter((function(e){return"array"!==e.type&&"object"!==e.type&&e.level&&(!e.children||!e.children.length)&&-1!==e.ancestorsList.indexOf("0_data")})),r.filter((function(e){var i=t.countArrayAncestors(e),a=1===i.length&&("array"===e.parentInfo.type||"array"===e.parentInfo.parentInfo.type);return a&&-1===n.indexOf(i[0])&&n.push(i[0]),a})).forEach((function(e){e.isSelectAbled=!0})),i.abrupt("return",n);case 5:case"end":return i.stop()}}),i,t)})))()},showTree:function(e){if(e){var t=this.selectInfo.selectkeylist.map((function(e){return e.level}));this.$set(this.maxLevelTree,1,Math.max.apply(Math,(0,n.default)(t))-1),this.$set(this.maxLevelTree,2,Math.max.apply(Math,(0,n.default)(t))-1)}else{var i=this.organization.assignorPerson.map((function(e){return e.level}));this.$set(this.maxLevelTree,0,Math.max.apply(Math,(0,n.default)(i))-1)}for(var a=this.organizaInfo.assignorShow[e],r=0;r<3;r++)this.$set(this.organizaInfo.assignorShow,r,!1);this.$set(this.organizaInfo.assignorShow,e,!a)},closeOther0:function(){this.$set(this.organizaInfo.assignorShow,0,!1)},closeOther1:function(){this.$set(this.organizaInfo.assignorShow,1,!1)},closeOther2:function(){this.$set(this.organizaInfo.assignorShow,2,!1)},recordCheckFn:function(e){var t=this;e.checkInfo=!1,null===e.children||e.children&&!e.children.length||e.children.forEach((function(e){t.recordCheckFn(e)}))},assignorToggle:function(e,t){var i=this;"object"===e.type||t&&"array"===e.type||(t?1===t?(this.selectInfo.selectkeylist.forEach((function(e){i.recordCheckFn(e)})),this.selectInfo.selectkey=e.ancestorsList_str,this.settingKeyName=e.name,this.responseTableData.forEach((function(e){e.isSelectedKey=!1})),this.responseTableData.filter((function(t){return t.ancestorsList_str===e.ancestorsList_str}))[0].isSelectedKey=!0):(this.selectInfo.selectvaluelist.forEach((function(e){i.recordCheckFn(e)})),this.selectInfo.selectvalue=e.ancestorsList_str,this.settingValueName=e.name,this.responseTableData.forEach((function(e){e.isSelectedValue=!1})),this.responseTableData.filter((function(t){return t.ancestorsList_str===e.ancestorsList_str}))[0].isSelectedValue=!0):(this.organization.assignorPerson.forEach((function(e){i.recordCheckFn(e)})),this.selectInfo.selectkeylist=e.children[0].children,this.selectInfo.selectvaluelist=(0,l.default)(this.selectInfo.selectkeylist),this.organization.assignorTree=e,this.tampFormInfo.assignors=e.id,this.checkInfo.assignors=!1),e.checkInfo=!0,this.closeTree(t))},closeTree:function(e){this.$set(this.organizaInfo.assignorShow,e,!1)},toggleChildren:function(){arguments[0].showChildren=!arguments[0].showChildren}}}},"5/Zn":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"CASCADE",props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,required:!0,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{firstShow:!1,firstInfo:this.item.val,firstList:[],secondInfo:"",firstPlace:this.$t('m.newCommon["请选择所属的厅委办"]'),secondPlace:this.$t('m.newCommon["请选择所属业务"]'),clickChange:!1}},computed:{changeFields:function(){return this.fields}},watch:{"item.val":function(){this.changeInfo()}},mounted:function(){this.changeInfo()},methods:{itemSelect:function(e){var t=this.item.choice.filter((function(t){return t.key===e}))[0];this.clickInfo=!0,this.firstShow=!!t.items,this.firstInfo=e,this.item.val=this.firstShow?"":e,this.firstList=t.items,this.secondInfo="",this.clickChange=!0},changeFrist:function(e){this.secondInfo=e,this.item.val=this.secondInfo},changeInfo:function(){if(this.clickChange)this.clickChange=!1;else if(this.item.val){this.firstShow=!1,this.firstList=[];for(var e=!0,t=0;t<this.item.choice.length;t++)if(String(this.item.choice[t].key)===String(this.item.val)){this.firstInfo=this.item.val,e=!1,this.firstShow=!!this.item.choice[t].items;break}if(e)for(var i=0;i<this.item.choice.length;i++)if(this.item.choice[i].items){var n=this.item.choice[i].items;this.firstShow=!0,this.firstInfo===this.item.choice[i].key&&(this.firstList=n);for(var a=0;a<n.length;a++)if(String(n[a].key)===String(this.item.val)){this.firstList=n,this.secondInfo=this.item.val,this.firstInfo=this.item.choice[i].key;break}}}else this.firstShow=!1,this.firstList=[],this.firstInfo=""}}}},"5CRB":function(e,t,i){"use strict";i.r(t);var n=i("T6OW"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"5Pf/":function(e,t,i){"use strict";i.r(t);var n=i("7yQo"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"5R1Y":function(e,t,i){"use strict";i.r(t);var n=i("lR6s"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"5f0d":function(e,t,i){"use strict";i("zcr8")},"5hmv":function(e,t,i){"use strict";i.r(t);var n=i("eM+a"),a=i("kQq5");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("l3JT");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},"65Fp":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-field-info mb20"},[e.isShowTitle?t("p",{staticClass:"bk-field-title"},[e._v(e._s(e.$t("m['字段配置']")))]):e._e(),e._v(" "),t("div",{staticClass:"bk-node-btn"},["APPROVAL"!==e.configur.type?t("bk-button",{staticClass:"mr10",attrs:{"data-test-id":"fieldConfig-button-addField",theme:"default",title:e.$t("m.treeinfo['新增字段']")},on:{click:e.addField}},[e._v("\n      "+e._s(e.$t("m.treeinfo['新增字段']"))+"\n    ")]):e._e(),e._v(" "),"APPROVAL"===e.configur.type||"SIGN"===e.configur.type||e.templateStage?e._e():t("bk-button",{staticClass:"mr10",attrs:{"data-test-id":"fieldConfig-button-addModelField",theme:"default",title:e.$t("m.treeinfo['选择模型字段']")},on:{click:e.openAddModule}},[e._v("\n      "+e._s(e.$t("m.treeinfo['选择模型字段']"))+"\n    ")]),e._v(" "),t("bk-button",{staticClass:"mr10",staticStyle:{float:"right",border:"0"},attrs:{theme:"default","data-test-id":"fieldConfig-button-previewField",title:e.$t("m.treeinfo['字段预览']"),disabled:!e.showTabList.length},on:{click:e.previewField}},[t("i",{staticClass:"bk-itsm-icon icon-itsm-icon-three",staticStyle:{"font-size":"16px"}}),e._v("\n      "+e._s(e.$t("m.treeinfo['字段预览']"))+"\n    ")])],1),e._v(" "),t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isDataLoading},expression:"{ isLoading: isDataLoading }"}],staticClass:"mt15 bk-draggable"},[t("table",{staticClass:"bk-draggable-table"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.$t('m.treeinfo["字段名称"]')))]),e._v(" "),t("th",{staticStyle:{"max-width":"150px"}},[e._v(e._s(e.$t('m.treeinfo["唯一标识"]')))]),e._v(" "),t("th",[e._v(e._s(e.$t('m.treeinfo["字段类型"]')))]),e._v(" "),t("th",[e._v(e._s(e.$t('m.treeinfo["是否只读"]')))]),e._v(" "),t("th",{staticStyle:{"min-width":"50px"}},[e._v(e._s(e.$t('m.treeinfo["布局"]')))]),e._v(" "),t("th",{staticStyle:{"max-width":"100px"}},[e._v(e._s(e.$t('m.treeinfo["字段描述"]')))]),e._v(" "),t("th",[e._v(e._s(e.$t('m.treeinfo["是否必填"]')))]),e._v(" "),t("th",[e._v(e._s(e.$t('m.treeinfo["更新人"]')))]),e._v(" "),t("th",[e._v(e._s(e.$t('m.treeinfo["操作"]')))])])]),e._v(" "),t("draggable",{attrs:{tag:"tbody",handle:".move-handler-content"},on:{end:e.updateInfo},model:{value:e.showTabList,callback:function(t){e.showTabList=t},expression:"showTabList"}},[e.showTabList.length?e._l(e.showTabList,(function(i,n){return t("tr",{key:n},[t("td",{staticClass:"move-handler-content"},[t("span",[t("i",{staticClass:"bk-itsm-icon icon-move-new move-handler"}),e._v(e._s(i.name))])]),e._v(" "),t("td",{staticStyle:{"max-width":"150px"},attrs:{title:i.key}},[e._v("\n              "+e._s(i.key)+"\n            ")]),e._v(" "),t("td",[e._v("\n              "+e._s(i.typeName||"--")+"\n            ")]),e._v(" "),t("td",{staticStyle:{"max-width":"100px"},attrs:{title:i.is_readonly?e.$t("m.treeinfo['是']"):e.$t("m.treeinfo['否']")}},[e._v("\n              "+e._s(i.is_readonly?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n            ")]),e._v(" "),t("td",{staticStyle:{"min-width":"50px"}},[e._v("\n              "+e._s("COL_6"===i.layout?e.$t('m.treeinfo["半行"]'):e.$t('m.treeinfo["整行"]'))+"\n            ")]),e._v(" "),t("td",{staticStyle:{"max-width":"100px"},attrs:{title:i.desc}},[t("pre",[t("span",[e._v(e._s(i.desc||"--"))])])]),e._v(" "),t("td",[e._v("\n              "+e._s(i.is_required||"--")+"\n            ")]),e._v(" "),t("td",[e._v("\n              "+e._s(i.updated_by||"--")+"\n            ")]),e._v(" "),t("td",[t("bk-button",{staticClass:"table-opt-button",attrs:{theme:"primary",disabled:e.checkEditDisabled(i),text:""},on:{click:function(t){return e.openField(i)}}},[e._v("\n                "+e._s(e.$t('m.user["编辑"]'))+"\n              ")]),e._v(" "),t("bk-button",{staticClass:"table-opt-button",attrs:{theme:"primary",disabled:e.checkDeleteDisabled(i),text:""},on:{click:function(t){return e.deleteTable(i)}}},[e._v("\n                "+e._s(e.$t('m.user["删除"]'))+"\n              ")])],1)])})):[t("tr",{},[t("td",{staticClass:"bk-none-content",attrs:{colspan:"10"}},[t("i",{staticClass:"bk-table-empty-icon bk-icon icon-empty"}),e._v(" "),t("p",{staticClass:"bk-none-info"},[e._v(e._s(e.$t('m.treeinfo["暂无数据"]')))])])])]],2)],1)]),e._v(" "),t("bk-dialog",{attrs:{width:"760",position:e.processInfo.position,draggable:e.processInfo.draggable,title:e.processInfo.title,"render-directive":"if","ext-cls":"bk-preview-overflow"},model:{value:e.processInfo.isShow,callback:function(t){e.$set(e.processInfo,"isShow",t)},expression:"processInfo.isShow"}},[t("field-preview",{attrs:{fields:e.previewTab}}),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("bk-button",{attrs:{theme:"default"},on:{click:function(t){e.processInfo.isShow=!1}}},[e._v("\n        "+e._s(e.$t('m.home["取消"]'))+"\n      ")])],1)],1),e._v(" "),t("bk-sideslider",{attrs:{"is-show":e.sliderInfo.show,"quick-close":!0,title:e.sliderInfo.title,width:e.sliderInfo.width,"before-close":e.handleBeforeClose},on:{"update:isShow":function(t){return e.$set(e.sliderInfo,"show",t)},"update:is-show":function(t){return e.$set(e.sliderInfo,"show",t)}}},[e.sliderInfo.show?t("div",{staticClass:"p20",attrs:{slot:"content"},slot:"content"},[t("add-field",{attrs:{"change-info":e.changeInfo,"template-info":e.templateInfo,"template-stage":e.templateStage,"nodes-list":e.nodesList,"add-origin":e.addOrigin,"table-list":e.showTabList,"is-edit-public":e.isEditPublic,workflow:e.flowInfo?e.flowInfo.id:0,state:e.configur.id?e.configur.id:0},on:{change:function(t){e.isFormChanged=!0},closeShade:e.closeShade}})],1):e._e()]),e._v(" "),t("bk-dialog",{attrs:{"render-directive":"if",width:e.moduleInfo.width,"header-position":e.moduleInfo.headerPosition,loading:e.secondClick,"auto-close":e.moduleInfo.autoClose,"mask-close":e.moduleInfo.autoClose},on:{confirm:e.submitModule},model:{value:e.moduleInfo.isShow,callback:function(t){e.$set(e.moduleInfo,"isShow",t)},expression:"moduleInfo.isShow"}},[t("p",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.$t('m.treeinfo["选择模型字段"]')))]),e._v(" "),t("div",{staticClass:"bk-add-module"},[t("inherit-state",{ref:"inheritState",attrs:{workflow:e.flowInfo?e.flowInfo.id:0,state:e.configur.id?e.configur.id:0,configur:e.configur,"show-tab-list":e.showTabList}})],1)])],1)},a=[];n._withStripped=!0},"676K":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-trigger-condition"},[t("div",{staticClass:"bk-condition-name"},[t("span",[e._v(e._s(e.$t("m.trigger['触发条件']")))])]),e._v(" "),t("div",{staticClass:"bk-condition-content",on:{click:function(t){e.triggerRules.checkStatus=!1}}},[t("ul",{staticClass:"bk-content-step"},[e._l(e.triggerRules.list,(function(i,n){return t("li",{key:n,staticClass:"bk-content-li"},[t("ul",{staticClass:"bk-content-item",class:{"bk-more-margin":1!==i.itemList.length}},e._l(i.itemList,(function(n,a){return t("li",{key:a,staticClass:"bk-content-item-li",class:{"bk-none-margin":i.itemList.length-1===a}},[1!==i.itemList.length?[a!==i.itemList.length-1?t("div",{staticClass:"bk-content-type",on:{click:function(t){return e.changeBetween(i)}}},[t("span",[e._v(e._s("all"===i.type?e.$t("m.trigger['且']"):e.$t("m.trigger['或']")))]),e._v(" "),t("i",{staticClass:"bk-icon icon-down-shape"})]):e._e(),e._v(" "),t("div",{staticClass:"bk-item-line"}),e._v(" "),0===a?t("div",{staticClass:"bk-item-line-none bk-item-none"}):e._e(),e._v(" "),a===i.itemList.length-1?t("div",{staticClass:"bk-item-line-none bk-item-none-bottom"}):e._e()]:e._e(),e._v(" "),t("bk-select",{staticStyle:{width:"190px"},attrs:{"ext-cls":"bk-item-float",clearable:!1,searchable:""},on:{change:function(t){return e.changeContent(n)}},model:{value:n.key,callback:function(t){e.$set(n,"key",t)},expression:"node.key"}},e._l(e.keyList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),t("bk-select",{staticStyle:{width:"140px"},attrs:{"ext-cls":"bk-item-float",clearable:!1,searchable:""},on:{selected:function(t){return e.changeCondition(n)}},model:{value:n.condition,callback:function(t){e.$set(n,"condition",t)},expression:"node.condition"}},e._l(n.conditionList,(function(e){return t("bk-option",{key:e.name,attrs:{id:e.name,name:e.label}})})),1),e._v(" "),"none"!==n.conditionType?[t("trigger-field",{staticStyle:{width:"170px",float:"left","margin-right":"8px"},attrs:{item:n}})]:e._e(),e._v(" "),t("div",{staticClass:"bk-between-operat"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(t){return e.addLine(i,n,a)}}}),e._v(" "),t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===i.itemList.length},on:{click:function(t){return e.deleteLine(i,n,a)}}})])],2)})),0),e._v(" "),t("i",{staticClass:"bk-icon icon-close-circle-shape",class:{"bk-no-delete":1===e.triggerRules.list.length},on:{click:function(t){return e.deleteGroup(i,n)}}}),e._v(" "),t("div",{staticClass:"bk-content-type",on:{click:e.handleBetween}},[t("span",[e._v(e._s("all"===e.triggerRules.type?e.$t("m.trigger['且']"):e.$t("m.trigger['或']")))]),e._v(" "),t("i",{staticClass:"bk-icon icon-down-shape"})]),e._v(" "),t("div",{staticClass:"bk-item-line"}),e._v(" "),0===n?t("div",{staticClass:"bk-item-line-none bk-item-none"}):e._e(),e._v(" "),1!==i.itemList.length?t("div",{staticClass:"bk-content-line"}):e._e()])})),e._v(" "),t("li",{staticClass:"bk-content-add"},[t("span",{on:{click:e.addGroup}},[t("i",{staticClass:"bk-icon icon-plus-circle mr5"}),t("span",[e._v(e._s(e.$t("m.trigger['添加']")))])]),e._v(" "),t("div",{staticClass:"bk-item-line"}),e._v(" "),t("div",{staticClass:"bk-item-line-none",class:{"bk-item-over-line":e.triggerRules.checkStatus}})])],2),e._v(" "),t("div",{staticClass:"bk-content-line"}),e._v(" "),e.triggerRules.checkStatus?t("p",{staticClass:"bk-error-info"},[e._v(e._s(e.$t("m.trigger['请填写完整的触发条件']")))]):e._e()])])},a=[];n._withStripped=!0},"6jts":function(e,t,i){"use strict";i("OzIr")},"6z7N":function(e,t,i){},"7DqX":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"TABLE",props:{item:{type:Object,required:!0,default:function(){}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){if(""===this.item.val){this.item.val=[];for(var e={},t=0;t<this.item.choice.length;t++){e[this.item.choice[t].key]=""}this.item.val.push(e)}"function"==typeof this.$parent.refresh&&this.$parent.refresh()}},created:function(){if(""===this.item.val||Array.isArray(this.item.val)&&!this.item.val.length){this.item.val=[];for(var e={},t=0;t<this.item.choice.length;t++){e[this.item.choice[t].key]=""}this.item.val.push(e)}},methods:{addOne:function(){for(var e={},t=0;t<this.item.choice.length;t++){e[this.item.choice[t].key]=""}this.item.val.push(e)},deleteOne:function(e){var t=this;1===this.item.val.length?this.$bkMessage({message:"默认行不能删除",theme:"warning"}):this.$bkInfo({title:"确认要删除此条数据？",confirmFn:function(){t.item.val.splice(e.$index,1)}})}}}},"7LjQ":function(e,t,i){"use strict";i("UftK")},"7V2o":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-select",{class:{"bk-border-error":e.item.checkValue},attrs:{searchable:"",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.desc,"font-size":"medium"},on:{selected:e.selected,toggle:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}},e._l(e.options,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},"7XAC":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("2eEL"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"exportTree",components:{collapseTransition:r.default},props:{treeDataList:{type:Array,default:function(){return[]}},treeIndex:{type:Number,default:0},isKeyValue:{type:Number,default:0}},data:function(){return{pLeft:"padding-left:"+25*(this.treeIndex+1)+"px; padding-right: 10px;"}},methods:{toggleChildren:function(e){this.$emit("toggleChildren",e)},toggle:function(e){this.$emit("toggle",e,this.isKeyValue)},checkItem:function(e){this.$emit("selectItem",e)},selectItem:function(e){this.$emit("selectItem",e)}}}},"7yQo":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("QbLZ")),a=l(i("u8Ap")),r=l(i("OE89")),s=i("L2JU"),o=i("CeR/");function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"changeConductor",components:{memberSelect:a.default,exportTree:r.default},props:{itemInfo:{type:Object,default:function(){return{}}},recipientItem:{type:Object,default:function(){return{}}},recipientIndex:{type:Number,default:function(){return""}}},data:function(){return{recipientKeyList:[],roles:{viewTreeDataList:[],viewtree:{},viewTreeOpen:!1},variableList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,s.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.variableList=e}},created:function(){var e=["OPEN","STARTER","BY_ASSIGNOR","EMPTY"];this.recipientKeyList=this.globalChoise.processor_type.filter((function(t){return!e.some((function(e){return e===t.typeName}))})),this.recipientItem.key&&(this.recipientItem.secondLevelList=[],"ORGANIZATION"===this.recipientItem.key?(this.getOrganization(),this.recipientItem.value&&this.setinitValue(Number(this.recipientItem.value))):"VARIABLE"===this.recipientItem.key?this.recipientItem.value=this.recipientItem.value:"PERSON"===this.recipientItem.key?(this.recipientItem.secondLevelList=[],this.recipientItem.value=Array.isArray(this.recipientItem.value)?this.recipientItem.value:this.recipientItem.value.split(",")):(this.recipientItem.value=Array.isArray(this.recipientItem.value)?this.recipientItem.value:this.recipientItem.value.split(","),this.secondListFn(this.recipientItem)))},mounted:function(){this.variableList=this.triggerVariables},methods:{setinitValue:function(e){var t=this;this.$store.dispatch("cdeploy/getTreeInfoChildren",{id:e}).then((function(e){t.roles.viewtree=e.data,t.concatName()}))},getSecondLevelList:function(){this.recipientItem.value=[],this.recipientItem.secondLevelList=[],"ORGANIZATION"===this.recipientItem.key?(this.recipientItem.value="",this.getOrganization()):"VARIABLE"===this.recipientItem.key?this.recipientItem.value="":"PERSON"===this.recipientItem.key?this.recipientItem.secondLevelList=[]:this.secondListFn(this.recipientItem)},secondListFn:function(e){var t=this;if(e.key){e.isLoading=!0;var i={role_type:e.key};"IAM"!==e.key&&(i.project_key=this.$store.state.project.id),this.$store.dispatch("deployCommon/getSecondUser",i).then((function(t){var i=t.data,n=[];"GENERAL"===e.key?i.forEach((function(e){n.push({id:String(e.id),name:e.name+"("+e.count+")",disabled:0===e.count})})):i.forEach((function(e){n.push({id:String(e.id),name:e.name})})),e.secondLevelList=n})).catch((function(e){(0,o.errorHandler)(e,t)})).finally((function(){e.isLoading=!1}))}},getOrganization:function(){var e=this;this.$store.dispatch("cdeploy/getTreeInfo").then((function(t){e.roles.viewTreeDataList=t.data,e.roles.viewTreeDataList.forEach((function(t){e.setCheckedValue(t,"view")}))})).catch((function(){}))},recordCheckFn:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.roles.viewTreeDataList;t.forEach((function(t){e.$set(t,"checkInfo",!1),t.children&&t.children.length&&e.recordCheckFn(t.children)}))},toggleInfo:function(e){this.recordCheckFn(),e.checkInfo=!0,this.roles.viewtree=e,this.concatName(),this.recipientItem.value=e.id,this.closeTree()},toggleChildren:function(e,t){var i=this;"view"===t&&(this.$set(e,"showChildren",!e.showChildren),this.$store.dispatch("cdeploy/getTreeInfoChildren",{id:e.id}).then((function(t){t.data.children.forEach((function(e){i.setCheckedValue(e,"view")})),i.$set(e,"children",t.data.children||[])})))},openChildren:function(e,t){var i=this;e.showChildren=!1,"view"===t&&(e.showChildren=this.roles.viewtree.route.some((function(t){return String(t.id)===String(e.id)}))),e.children&&e.children.length&&e.children.forEach((function(e){i.openChildren(e,t)}))},setCheckedValue:function(e,t){if(this.$set(e,"checkInfo",!1),this.$set(e,"has_children",e.has_children),String(this.recipientItem.value)===String(e.id)&&"view"===t)return e.checkInfo=!0,this.checked=e,void this.concatName();e.has_children&&(this.$set(e,"showChildren",!1),this.$set(e,"children",[]))},showTree:function(e){"view"===e&&(this.roles.viewTreeOpen=!this.roles.viewTreeOpen,this.roles.otherTreeOpen=!1)},closeTree:function(){this.roles.viewTreeOpen=!1},concatName:function(){this.$set(this.roles.viewtree,"showName",this.roles.viewtree.full_name)},addRecipient:function(){this.itemInfo.value.splice(this.recipientIndex+1,0,{type:"",value:"",secondLevelList:[],isLoading:!1})},deleteRecipient:function(){1!==this.itemInfo.value.length&&this.itemInfo.value.splice(this.recipientIndex,1)}}}},"8/xK":function(e,t,i){},"8MAP":function(e,t,i){},"8O5U":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-field-preview",attrs:{id:"bkPreview"}},[t("bk-form",{attrs:{"label-width":200,"form-type":"vertical","ext-cls":"bk-ext-form"}},[e._l(e.fields,(function(i,n){return[i.showFeild?t("div",{key:n,class:{"bk-field-line":"COL_12"===i.layout,"bk-field-half":"COL_6"===i.layout}},[t("CW-"+i.type,{tag:"component",attrs:{item:i,fields:e.fields,"is-preview":e.isPreview,"is-file-preview":e.isFilePreview}})],1):e._e()]}))],2)],1)},a=[];n._withStripped=!0},"8aPs":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-input",{class:{"bk-border-error":e.item.checkValue},attrs:{maxlength:e.maxLength,disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.desc},on:{focus:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},"8fx1":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("z/5e")),a=r(i("efIh"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"INT",mixins:[a.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{max:n.default,isErrMessage:!1}},watch:{"item.val":function(e){this.isErrMessage=e>this.max||!1,this.conditionField(this.item,this.fields)}},mounted:function(){this.item.value&&!this.item.val&&(this.item.val=this.item.value)},methods:{}}},"8iia":function(e,t,i){var n=i("QMMT"),a=i("RRc/");e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},"8zq1":function(e,t,i){"use strict";i.r(t);var n=i("eYYl"),a=i("0uNP");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("3nH4");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"5426a860",null);t.default=o.exports},"9MBU":function(e,t,i){"use strict";i.r(t);var n=i("k85c"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"9RFn":function(e,t,i){"use strict";i.r(t);var n=i("46OK"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"9ZYk":function(e,t,i){"use strict";i.r(t);var n=i("e+8O"),a=i("EQfD");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("jeD0");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"06fcffc1",null);t.default=o.exports},"9g4e":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("bk-sideslider",{attrs:{"is-show":e.isShow,"quick-close":!0,title:e.title,width:e.width,"ext-cls":"ui-sideslider"},on:{"update:isShow":function(t){e.isShow=t},"update:is-show":function(t){e.isShow=t}}},[t("div",{attrs:{slot:"content"},slot:"content"},[t("render-view",{attrs:{"form-data":e.formData,context:e.context}})],1)])},a=[];n._withStripped=!0},"9psX":function(e,t,i){"use strict";i.r(t);var n=i("ptjD"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},Abqk:function(e,t,i){"use strict";i.r(t);var n=i("25E2"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},Axd5:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-input",{class:{"bk-border-error":e.item.checkValue},attrs:{placeholder:e.item.desc,type:"textarea",rows:8,disabled:e.item.is_readonly&&!e.isCurrent||e.disabled},on:{focus:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},B9jh:function(e,t,i){"use strict";var n=i("Wu5q"),a=i("n3ko");e.exports=i("raTm")("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(a(this,"Set"),e=0===e?0:e,e)}},n)},BFl6:function(e,t,i){"use strict";i.r(t);var n=i("ew6e"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},Bi2R:function(e,t,i){},BkRI:function(e,t,i){var n=i("OBhP");e.exports=function(e){return n(e,5)}},C2SN:function(e,t,i){var n=i("93I4"),a=i("kAMH"),r=i("UWiX")("species");e.exports=function(e){var t;return a(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!a(t.prototype)||(t=void 0),n(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},C65D:function(e,t,i){"use strict";i.r(t);var n=i("9g4e"),a=i("Vv2+");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("xgIe");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},C6tm:function(e,t,i){"use strict";i.r(t);var n=i("P+p4"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},CBo5:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("efIh"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"TEXT",mixins:[r.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value)},methods:{}}},CPxG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-send-message"},[e.show?t("bk-tab",{attrs:{active:e.activeName},on:{"tab-change":e.changPanel}},e._l(e.itemInfo.sub_components,(function(i,n){return t("bk-tab-panel",e._b({key:n,attrs:{"test-posi-id":i.key}},"bk-tab-panel",i,!1),[t("template",{slot:"label"},[t("bk-checkbox",{staticStyle:{float:"left",margin:"0px 8px 0 0"},attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus},model:{value:i.checked,callback:function(t){e.$set(i,"checked",t)},expression:"panel.checked"}}),e._v(" "),t("i",{staticClass:"bk-icon",class:[i.icon]}),e._v(" "),t("span",{staticClass:"panel-name"},[e._v(e._s(i.label))])],1),e._v(" "),e._l(i.field_schema,(function(a,r){return t("div",{key:a.key,staticClass:"mb20",attrs:{"test-posi-id":a.key}},[t("bk-form-item",{key:n,attrs:{label:a.name,required:a.required,desc:a.tips}},[t("change-conductor",{attrs:{index:n,"item-info":a,origin:"message","is-show-var":e.isShowVar},on:{"change-panel-status":function(t){return e.changePanelStatus(i,r)}}})],1)],1)}))],2)})),1):e._e()],1)},a=[];n._withStripped=!0},CQIX:function(e,t,i){"use strict";i("f9M4")},"CXV/":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMDI0IDEwMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojNzM3OTg3O30KPC9zdHlsZT4KPGc+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNzA0LDY0TDcwNCw2NEgxMjh2ODk2aDc2OFYyNTZsMCwwTDcwNCw2NHogTTcwNCwxNTQuNUw4MDUuNSwyNTZINzA0VjE1NC41eiBNODMyLDg5NkgxOTJWMTI4aDQ0OHYxOTJoMTkyCgkJVjg5NnoiLz4KCTxyZWN0IHg9IjI4OCIgeT0iMzIwIiBjbGFzcz0ic3QwIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjY0Ii8+Cgk8cmVjdCB4PSIyODgiIHk9IjQ0OCIgY2xhc3M9InN0MCIgd2lkdGg9IjQ0OCIgaGVpZ2h0PSI2NCIvPgoJPHJlY3QgeD0iMjg4IiB5PSI1NzYiIGNsYXNzPSJzdDAiIHdpZHRoPSI0NDgiIGhlaWdodD0iNjQiLz4KCTxyZWN0IHg9IjI4OCIgeT0iNzA0IiBjbGFzcz0ic3QwIiB3aWR0aD0iNDQ4IiBoZWlnaHQ9IjY0Ii8+CjwvZz4KPC9zdmc+Cg=="},CjxG:function(e,t,i){"use strict";i.r(t);var n=i("mW7z"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},CyHO:function(e,t,i){"use strict";i.r(t);var n=i("HxM3"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},Cyyo:function(e,t,i){"use strict";i.r(t);var n=i("/BG8"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"Ddt+":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-data-content",on:{click:e.closeError}},["CUSTOM"===e.formInfo.source_type?e._l(e.fieldInfo.list,(function(i,n){return t("div",{key:n,staticClass:"bk-custom-line",class:{mb20:n!==e.fieldInfo.list.length-1}},[t("div",{staticClass:"bk-costom-form"},[t("bk-input",{attrs:{maxlength:120,"ext-cls":"bk-custom-input",clearable:!0,disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source)&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入选项名']")},on:{blur:function(t){return e.putChar(i,n)}},model:{value:i.name,callback:function(t){e.$set(i,"name",t)},expression:"item.name"}}),e._v(" "),"TABLE"===e.formInfo.type?[t("bk-checkbox",{staticStyle:{float:"left","margin-right":"10px","line-height":"32px"},attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus},model:{value:i.required,callback:function(t){e.$set(i,"required",t)},expression:"item.required"}},[e._v("\n            "+e._s(e.$t("m.treeinfo['必填']"))+"\n          ")])]:e._e(),e._v(" "),t("bk-input",{attrs:{"ext-cls":"bk-custom-input",disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入选项ID']")},model:{value:i.key,callback:function(t){e.$set(i,"key",t)},expression:"item.key"}}),e._v(" "),t("div",{staticClass:"bk-custom-icon"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",class:{"bk-no-delete":e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code},on:{click:function(t){return e.addDataLine(i,n)}}}),e._v(" "),t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.fieldInfo.list.length||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code},on:{click:function(t){return e.deleteDataLine(i,n)}}})])],2),e._v(" "),t("div",{staticClass:"bk-field-error-tip"},[i.nameCheck?t("p",{staticClass:"bk-field-error"},[e._v(e._s(e.$t('m.deployPage["名称不能为空且不能重复"]')))]):[i.keyCheck?t("p",{staticClass:"bk-field-error"},[e._v(e._s(e.$t('m.deployPage["名称ID为英文数字及下划线且不能重复"]')))]):e._e()]],2)])})):e._e(),e._v(" "),"API"===e.formInfo.source_type?[e.apiInfo.remote_system_id&&e.apiInfo.remote_api_id?t("div",{staticClass:"bk-api-param"},[e.apiDetail.req_params&&e.apiDetail.req_params.length&&e.apiDetail.req_params[0].name?t("div",{staticClass:"bk-param"},[t("get-param",{ref:"getParam",attrs:{entry:"addField","form-info":e.formInfo,"change-info":e.changeInfo,"state-list":e.stateList,"api-detail":e.apiDetail}})],1):e._e(),e._v(" "),e.apiDetail.req_body&&Object.keys(e.apiDetail.req_body).length&&e.apiDetail.req_body.properties&&Object.keys(e.apiDetail.req_body.properties).length?t("div",{staticClass:"bk-param"},[t("post-param",{ref:"postParam",attrs:{entry:"addField","form-info":e.formInfo,"change-info":e.changeInfo,"state-list":e.stateList,"api-detail":e.apiDetail}})],1):e._e(),e._v(" "),e.apiDetail.rsp_data&&Object.keys(e.apiDetail.rsp_data).length&&e.apiDetail.rsp_data.properties&&Object.keys(e.apiDetail.rsp_data.properties).length?t("div",{staticClass:"bk-param"},[t("response-data",{ref:"responseData",attrs:{"remote-api-iid":e.apiInfo.remote_api_id,"change-info":e.changeInfo,"form-info":e.formInfo,"state-list":e.stateList,"api-detail":e.apiDetail}})],1):e._e()]):e._e()]:e._e(),e._v(" "),"RPC"===e.formInfo.source_type?[e.prcTable.length?t("div",{staticClass:"bk-api-param"},[t("div",{staticClass:"bk-param"},[t("get-rpc-param",{ref:"getRpcParam",attrs:{"form-info":e.formInfo,"change-info":e.changeInfo,"state-list":e.stateList,"prc-table":e.prcTable}})],1)]):e._e()]:e._e()],2)},a=[];n._withStripped=!0},DoRf:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("14Xm")),a=o(i("gDS+")),r=o(i("D3Ub")),s=o(i("TQwK"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"responseCondition",components:{responseContent:s.default},props:{responseWayList:{type:Array,default:function(){return[]}},responseList:{type:Array,default:function(){return[]}},signal:String},data:function(){return{wayList:[],apiList:[]}},created:function(){},methods:{addResponse:function(e,t){this.responseList.splice(t+1,0,{way:"",wayInfo:{},performData:{runMode:"BACKEND",displayName:"",repeat:"one"},isLoading:!1})},deleteResponse:function(e,t){1!==this.responseList.length&&this.responseList.splice(t,1)},selectedWay:function(){var e=arguments,t=this;return(0,r.default)(n.default.mark((function i(){return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e[2].wayStatus&&(e[2].wayStatus=!1),e[2].isLoading=!0,e[2].wayInfo=JSON.parse((0,a.default)(t.responseWayList.filter((function(t){return t.key===e[0]}))[0])),setTimeout((function(){e[2].isLoading=!1}),1e3);case 4:case"end":return i.stop()}}),i,t)})))()}}}},DtGf:function(e,t,i){"use strict";i("SJYp")},Du1T:function(e,t,i){"use strict";i.r(t);var n=i("429m"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},Dx75:function(e,t,i){},EQfD:function(e,t,i){"use strict";i.r(t);var n=i("7XAC"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},FCVG:function(e,t,i){"use strict";i.r(t);var n=i("f5y/"),a=i("9MBU");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"4ffb4b8c",null);t.default=o.exports},FGMr:function(e,t,i){"use strict";i.r(t);var n=i("afA4"),a=i("Du1T");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"ec63f852",null);t.default=o.exports},FbwU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"NoData",props:{text:{type:String},fontSize:{type:[Number,String],default:16}},data:function(){return{imgUrl:i("tNV3")}}}},G4fa:function(e,t,i){},G6uA:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("ybrk"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"RICHTEXT",components:{RichTextEditor:r.default},props:{item:{type:Object,required:!0,default:function(){}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted:function(){this.item.value&&!this.item.val&&(this.item.val=this.item.value)}}},GXg3:function(e,t,i){},GauI:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",{staticClass:"member-field"},[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,"ext-cls":"bk-ext-item",desc:e.item.tips,"desc-type":"icon"}},[t("div",{staticClass:"member-form-item",on:{click:function(t){e.item.checkValue=!1}}},[t("member-select",{class:{"bk-border-error":e.item.checkValue},attrs:{multiple:!1,disabled:e.item.is_readonly},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}}),e._v(" "),t("business-card",{staticStyle:{"margin-top":"3px"},attrs:{item:e.item}})],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},Gogv:function(e,t,i){},Gz9R:function(e,t,i){"use strict";i.r(t);var n=i("nrD6"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},H2GU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(i("QbLZ")),a=p(i("m1cH")),r=p(i("jWXv")),s=p(i("rfXi")),o=p(i("14Xm")),l=p(i("D3Ub")),c=p(i("GQeE")),u=p(i("aNPh")),f=p(i("2eEL")),d=p(i("ibAw")),m=i("CeR/");function p(e){return e&&e.__esModule?e:{default:e}}t.default={name:"commonTriggerList",components:{addTrigger:u.default,collapseTransition:f.default},props:{sourceId:{type:[String,Number],default:""},stepSignal:{type:String,default:""},origin:{type:String,default:"task"},sender:{type:[Number,String],default:""},templateStage:{type:String,default:""},table:{type:[Number,String],default:""},nodeType:{type:String,default:""}},data:function(){return{boundTriggerList:[],boundListLoading:!1,showMoreConfig:!1,triggerDialogInfo:{isShow:!1,searchKey:"",list:[],listLoading:!1},triggerSliderInfo:{isShow:!1,title:this.$t("m.taskTemplate['创建触发器']"),width:950,addLoading:!1,item:{}},iconList:[{key:"icon-icon-notice-new",name:"",typeName:"message"},{key:"icon-icon-user-new",name:"",typeName:"user"},{key:"icon-icon-status-new",name:"",typeName:"status"},{key:"icon-icon-api-new",name:"",typeName:"api"}],originInfoToTrigger:{},stage:"",signal:"",type:"",sourceType:"",senderId:"",triggerEventListFilter:"",isFormChanged:!1}},computed:{citeList:function(){return this.triggerDialogInfo.list.filter((function(e){return e.checked}))},globalChoise:function(){return this.$store.state.common.configurInfo},openFunction:function(){return this.$store.state.openFunction},allSignal:function(){var e={state:"STATE",transition:"TRANSITION",workflow:"FLOW"};return this.stepSignal?this.stepSignal:e[this.origin]?(0,c.default)(this.globalChoise.trigger_signals[e[this.origin]]).join(","):""}},watch:{sourceId:function(e){e&&this.initData()},stepSignal:function(){this.initData()}},mounted:function(){var e=this;return(0,l.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;return(0,l.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.initParams(),e.setFilterSignal(),e.getPublicTriggerList(),t.next=5,e.getBoundTriggerList();case 5:case"end":return t.stop()}}),t,e)})))()},initParams:function(){if(this.senderId=this.sourceId,this.sourceType="workflow",this.stepSignal)return this.sourceType="task",this.triggerEventListFilter="TASK",this.type="task_schemas",void(this.stage=this.templateStage);"state"===this.origin&&(this.triggerEventListFilter="STATE",this.senderId=this.sender,this.type="states"),"transition"===this.origin&&(this.showMoreConfig=!0,this.triggerEventListFilter="TRANSITION",this.senderId=this.sender,this.type="transitions"),"workflow"===this.origin&&(this.showMoreConfig=!0,this.triggerEventListFilter="FLOW",this.type="templates")},setFilterSignal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e;["TASK","TASK-SOPS","SIGN"].indexOf(this.nodeType)>-1&&"state"===this.origin&&(t=(0,s.default)(new r.default(["CLAIM_STATE","DELIVER_STATE","DISTRIBUTE_STATE"].concat((0,a.default)(e)))));var i=this.allSignal.split(",");this.signal=i.filter((function(e){return-1===t.indexOf(e)})).join(",")},getBoundTriggerList:function(){var e=this;return(0,l.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.sourceId){t.next=2;break}return t.abrupt("return");case 2:return i={source_id:e.sourceId,source_type:e.sourceType,sender:e.senderId,signal__in:e.signal,project_key:e.$store.state.project.id},e.boundListLoading=!0,t.next=6,e.$store.dispatch("taskTemplate/getTemplateTriggers",i).then((function(t){e.boundTriggerList=t.data.map((function(t){return(0,n.default)({},t,{iconKey:e.iconList.find((function(e){return e.typeName===t.icon})).key})}))})).catch((function(t){(0,m.errorHandler)(t,e)})).finally((function(){e.showMoreConfig=Boolean(e.boundTriggerList.length)||"workflow"===e.origin||"transition"===e.origin,e.boundListLoading=!1}));case 6:case"end":return t.stop()}}),t,e)})))()},selectAllFn:function(){var e=this.triggerDialogInfo.list.length!==this.citeList.length;this.triggerDialogInfo.list.forEach((function(t){t.checked=e}))},openNew:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.originInfoToTrigger={id:this.sourceId,signal:this.signal,sender:this.senderId,filter:this.triggerEventListFilter,source:this.sourceType,type:this.type,stage:this.stage},"cite"===e?this.triggerDialogInfo.isShow=!0:(this.triggerSliderInfo.item=t,this.triggerSliderInfo.isShow=!0),this.isFormChanged=!1},citeTrigger:function(){var e=this,t={project_key:this.$store.state.project.id,src_trigger_ids:this.citeList.map((function(e){return e.id})),dst_source_id:this.sourceId,dst_source_type:this.sourceType,dst_sender:this.senderId};this.$store.dispatch("taskTemplate/patchCloneTriggers",t).then((function(){e.$bkMessage({message:e.$t("m.taskTemplate['引用成功']"),theme:"success"})})).catch((function(t){(0,m.errorHandler)(t,e)})).finally((function(){e.triggerDialogInfo.isShow=!1,e.getBoundTriggerList()}))},delTrigger:function(e){var t=this;this.$bkInfo({type:"warning",title:this.$t("m.taskTemplate['确认删除触发器？']"),subTitle:this.$t("m.taskTemplate['一旦删除，该触发器相关的动作将会一并删除。']"),confirmFn:function(){t.doDelTrigger(e)}})},doDelTrigger:function(e){var t=this;this.$store.dispatch("taskTemplate/deleteTrigger",e.id).then((function(){t.$bkMessage({message:t.$t("m.flowManager['删除成功']"),theme:"success"})})).catch((function(e){(0,m.errorHandler)(e,t)})).finally((function(){t.getBoundTriggerList()}))},getPublicTriggerList:function(){var e=this,t={source_id:0,source_type:"basic",sender:0,is_draft:!1,signal__in:this.signal,name__icontains:this.triggerDialogInfo.searchKey,project_key:this.$store.state.project.id};this.table&&(t.source_table_id=this.table),this.triggerDialogInfo.listLoading=!0,this.$store.dispatch("taskTemplate/getTemplateTriggers",t).then((function(t){e.triggerDialogInfo.list=t.data.map((function(t){return(0,n.default)({},t,{checked:!1,iconKey:e.iconList.find((function(e){return e.typeName===t.icon})).key})}))})).catch((function(t){(0,m.errorHandler)(t,e)})).finally((function(){e.triggerDialogInfo.listLoading=!1}))},newTrigger:function(){this.initDialogInfo(),this.$router.push({name:"projectTrigger",query:{project_id:this.$route.query.project_id}})},initDialogInfo:function(){this.triggerDialogInfo.isShow=!1,this.triggerDialogInfo.searchKey=""},searchInfo:function(){this.getPublicTriggerList()},clearSearch:function(){this.triggerDialogInfo.searchKey="",this.getPublicTriggerList()},handleBeforeClose:function(){var e=this;return(0,l.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isFormChanged){t.next=5;break}return t.next=3,(0,d.default)();case 3:return i=t.sent,t.abrupt("return",i);case 5:return t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t,e)})))()}}}},HOWN:function(e,t,i){"use strict";i.r(t);var n=i("lWSq"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"Ha+5":function(e,t,i){"use strict";i.r(t);var n=i("NLOC"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},HxM3:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),a=s(i("D3Ub")),r=s(i("efIh"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"MULTISELECT",mixins:[r.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{options:[],selectedItems:[]}},watch:{"item.val":function(){this.selectedItems=""===this.item.val?[]:this.item.val.split(","),this.conditionField(this.item,this.fields)},"item.choice":function(e,t){"API"!==this.item.source_type&&"DATADICT"!==this.item.source_type&&"RPC"!==this.item.source_type||t.length===e.length||this.getOption()}},mounted:function(){var e=this;return(0,a.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.item.value&&!e.item.val&&(e.item.val=e.item.value),t.next=3,e.getOption();case 3:return t.next=5,e.judgeValue(e.item.val,e.item.choice);case 5:i=t.sent,e.item.val=i?e.item.val:"",e.selectedItems=""===e.item.val?[]:e.item.val.split(","),e.conditionField(e.item,e.fields);case 9:case"end":return t.stop()}}),t,e)})))()},methods:{getOption:function(){var e=this;return(0,a.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldOptions(e.item);case 2:e.item.choice=t.sent,e.options=e.item.choice;case 4:case"end":return t.stop()}}),t,e)})))()},selected:function(e){var t=this;this.item.val=e.join(","),this.item.related_fields&&this.item.related_fields.be_relied&&this.item.related_fields.be_relied.forEach((function(e){t.fields.forEach((function(t){e===t.key&&(t.value="",t.val=t.value)}))}))}}}},I1Ty:function(e,t,i){"use strict";i.r(t);var n=i("1w2S"),a=i("qgII");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("y5Cw");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"f0f1344a",null);t.default=o.exports},IDfM:function(e,t,i){"use strict";i.r(t);var n=i("mVIP"),a=i("fkix");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},IcrL:function(e,t,i){"use strict";i("SqHb")},JGQq:function(e,t,i){"use strict";i.r(t);var n=i("Ddt+"),a=i("qJoz");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("kvWR");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"028000e9",null);t.default=o.exports},JXR1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=S(i("z1yn")),a=S(i("jub7")),r=S(i("Za/z")),s=S(i("u14n")),o=S(i("/KdC")),l=S(i("TNjk")),c=S(i("qyUP")),u=S(i("VrAx")),f=S(i("4K0D")),d=S(i("nxpg")),m=S(i("eOfU")),p=S(i("MBfY")),h=S(i("/Hw/")),v=S(i("Q3ZP")),b=S(i("Wl5c")),g=S(i("0njq")),k=S(i("+QRE")),_=S(i("070I")),y=S(i("gy7N")),I=S(i("aYIO")),C=S(i("g9b+")),w=S(i("IDfM"));function S(e){return e&&e.__esModule?e:{default:e}}t.default={name:"preview",components:{"CW-STRING":n.default,"CW-LINK":a.default,"CW-INT":r.default,"CW-TEXT":s.default,"CW-CHECKBOX":o.default,"CW-RADIO":l.default,"CW-SELECT":c.default,"CW-INPUTSELECT":u.default,"CW-MULTISELECT":f.default,"CW-DATE":d.default,"CW-DATETIME":m.default,"CW-MEMBER":p.default,"CW-MEMBERS":h.default,"CW-TABLE":v.default,"CW-CUSTOMTABLE":b.default,"CW-RICHTEXT":g.default,"CW-TREESELECT":k.default,"CW-FILE":_.default,"CW-CASCADE":y.default,"CW-SOPS_TEMPLATE":I.default,"CW-COMPLEX-MEMBERS":C.default,"CW-CUSTOM-FORM":w.default},props:{fields:{type:Array,required:!0,default:function(){return[]}},isPreview:{type:Boolean,default:!1},isFilePreview:{type:Boolean,default:!1}},data:function(){return{}}}},Jje2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("efIh"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"STRING",mixins:[r.default],props:{item:{type:Object,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},computed:{maxLength:function(){return"title"===this.item.key?120:"task_name"===this.item.key?50:null}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value)}}},JtQW:function(e,t,i){"use strict";i("iYOz")},Jwqd:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMMON_ATTRS=void 0;var n,a=i("QbLZ"),r=(n=a)&&n.__esModule?n:{default:n};t.getFormMixins=function(e){var t={};for(var i in e)"value"!==i&&(t[i]=e[i]);return{props:(0,r.default)({},s,t),inject:["getContext"],data:function(){return{value:this.$attrs.value?this.$attrs.value:e.value.default}},methods:{getTopViewItem:function(){for(var e=this,t=!1;!t;)e.$parent&&e.$parent.isRootRenderView?t=!0:e=e.$parent;return e}}}};var s=t.COMMON_ATTRS={label:{type:String,required:!1},hiddenLabel:{type:Boolean,default:!1},form:{type:Object,default:function(){return{}}},children:{type:[String,Array],required:!1},desc:{type:String,required:!1}}},"KW1/":function(e,t,i){"use strict";i.r(t);var n=i("LwjM"),a=i("f5Dy");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},L2Eo:function(e,t,i){"use strict";i("8/xK")},LJsK:function(e,t,i){"use strict";i.r(t);var n=i("z/kA"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},LVBE:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form",{ref:"taskForm",attrs:{model:e.item.sopsContent,rules:e.rules,"label-width":200,"form-type":"vertical"}},[e.editTask?e._e():[t("bk-form-item",{attrs:{label:e.$t("m.newCommon['创建方式']"),required:!0}},[t("bk-radio-group",{on:{change:e.handleCreateWayChange},model:{value:e.item.sopsContent.createWay,callback:function(t){e.$set(e.item.sopsContent,"createWay",t)},expression:"item.sopsContent.createWay"}},[t("bk-radio",{staticClass:"bk-form-radio",attrs:{disabled:e.disabled,value:"template"}},[e._v(e._s(e.$t('m.newCommon["手动创建"]')))]),e._v(" "),t("bk-radio",{staticClass:"bk-form-radio",attrs:{disabled:e.disabled,value:"task"}},[e._v(e._s(e.$t('m.newCommon["关联未执行的任务"]')))]),e._v(" "),t("bk-radio",{staticClass:"bk-form-radio",attrs:{disabled:e.disabled,value:"started_task"}},[e._v(e._s(e.$t('m.newCommon["关联已执行的任务"]')))])],1)],1),e._v(" "),"template"===e.item.sopsContent.createWay?t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"ext-cls":"bk-line-height",property:"id","error-display-type":"normal"}},[t("bk-select",{attrs:{searchable:"","ext-cls":"form-item-inline-width mr5",loading:e.loading.templateList,disabled:"RETRY"===e.typeInfo||e.disabled,clearable:!1},on:{selected:e.onSelectTpl},model:{value:e.item.sopsContent.id,callback:function(t){e.$set(e.item.sopsContent,"id",t)},expression:"item.sopsContent.id"}},e._l(e.templateList,(function(e,i){return t("bk-option",{key:i,attrs:{name:e.name,id:e.id}})})),1),e._v(" "),e.item.sopsContent.id?t("bk-select",{attrs:{loading:e.loading.plan,disabled:e.disabled,multiple:"","ext-cls":"form-item-inline-width mr0",placeholder:e.$t("m['选择执行方案，默认选择全部任务节点']")},on:{selected:e.onplanSelect},model:{value:e.item.sopsContent.planId,callback:function(t){e.$set(e.item.sopsContent,"planId",t)},expression:"item.sopsContent.planId"}},[e._l(e.planList,(function(i){return t("bk-option",{key:i.id,staticClass:"sops-plan-option",attrs:{id:i.id,name:i.name}},[t("span",[e._v(e._s(i.name))]),e._v(" "),t("span",{staticClass:"preview-sops-plan",on:{click:function(t){return t.stopPropagation(),e.jumpToSopsSelectSchemePage.apply(null,arguments)}}},[t("i",{staticClass:"bk-icon icon-eye"}),e._v("\n              "+e._s(e.$t('m.flowManager["预览"]'))+"\n            ")])])})),e._v(" "),t("div",{staticClass:"add-sops-scheme",attrs:{slot:"extension"},on:{click:e.jumpToSopsSelectSchemePage},slot:"extension"},[t("i",{staticClass:"bk-icon icon-plus"}),e._v("\n            "+e._s(e.$t("m.newCommon['创建执行方案']"))+"\n          ")])],2):e._e(),e._v(" "),e.item.sopsContent.id?t("div",{staticClass:"reload-template-plan",on:{click:e.onReloadPlanBtnClick}},[t("i",{staticClass:"bk-icon icon-refresh"}),e._v("\n          "+e._s(e.$t('m.newCommon["刷新"]'))+"\n        ")]):e._e()],1):t("bk-form-item",{attrs:{label:"标准运维的任务选择",required:!0,property:"sopsTaskId"}},[t("bk-select",{attrs:{loading:e.loading.sopsTaskList,disabled:e.disabled,searchable:""},on:{change:e.onSopsTaskChange},model:{value:e.item.sopsContent.sopsTask.id,callback:function(t){e.$set(e.item.sopsContent.sopsTask,"id",t)},expression:"item.sopsContent.sopsTask.id"}},e._l(e.sopsTaskList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),e.item.sopsContent.sopsTask.id?t("div",{staticClass:"preview-sops-task",on:{click:function(t){return t.stopPropagation(),e.jumpToSops.apply(null,arguments)}}},[t("i",{staticClass:"bk-icon icon-eye"}),e._v("\n          "+e._s(e.$t('m.flowManager["预览"]'))+"\n        ")]):e._e()],1)]],2),e._v(" "),e.formLoading?e._e():t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.configLoading},expression:"{ isLoading: configLoading }"}],staticClass:"form-wrapper"},[t("h3",{staticClass:"setion-title"},[e._v(e._s(e.$t('m.newCommon["参数配置"]')))]),e._v(" "),e.showRenderForm?t("render-form",{ref:"renderForm",attrs:{"form-option":e.formOptions,constants:e.item.sopsContent.constants,context:e.item.sopsContent.context,hooked:e.hookedVarList},on:{configLoadingChange:function(t){e.configLoading=t}},scopedSlots:e._u([{key:"tagHook",fn:function({scheme:i}){return[t("div",{staticClass:"hook-area"},[t("bk-checkbox",{attrs:{disabled:e.disabled||e.disabledRenderForm,value:!!e.hookedVarList[i.tag_code]},on:{change:function(t){return e.onHookChange(t,i)}}},[e._v("\n            "+e._s(e.$t('m.tickets["引用变量"]'))+"\n          ")]),e._v(" "),e.hookedVarList[i.tag_code]?t("div",{staticClass:"var-select"},[t("bk-select",{class:{"quote-error":e.quoteErrors.includes(i.tag_code)},attrs:{disabled:e.disabled||e.disabledRenderForm,clearable:!1,value:e.item.sopsContent.formData[i.tag_code].replace(/^\$\{/,"").replace(/\}$/,"")},on:{selected:function(t){return e.onSelectVar(t,i)}}},e._l(e.quoteVars,(function(i){return t("bk-option",{key:i.key,attrs:{id:i.key,name:i.name}},[e._v("\n                "+e._s(i.name)+"\n              ")])})),1),e._v(" "),e.quoteErrors.includes(i.tag_code)?t("span",{staticClass:"quote-error-text"},[e._v(e._s(e.$t('m.tickets["请选择变量"]')))]):e._e(),e._v(" "),e.item.sopsContent.constants.find(e=>e.key===i.tag_code).changed?e._e():t("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top",value:e.$t("m.tickets['配置有更新']"),expression:"$t(`m.tickets['配置有更新']`)",modifiers:{top:!0}}],staticClass:"bk-icon icon-info update-tips"})],1):e._e()],1)]}}],null,!1,2175907120),model:{value:e.item.sopsContent.formData,callback:function(t){e.$set(e.item.sopsContent,"formData",t)},expression:"item.sopsContent.formData"}}):t("no-data")],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},a=[];n._withStripped=!0},LaJ4:function(e,t,i){"use strict";i("Gogv")},Lbk4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(i("gDS+")),a=m(i("14Xm")),r=m(i("D3Ub")),s=m(i("t2rG")),o=m(i("BWJp")),l=m(i("ibAw")),c=m(i("eQfd")),u=m(i("rMih")),f=m(i("jFOa")),d=i("CeR/");function m(e){return e&&e.__esModule?e:{default:e}}t.default={name:"fieldInfo",components:{draggable:s.default,fieldPreview:c.default,addField:u.default,inheritState:f.default},mixins:[o.default],props:{flowInfo:{type:Object,default:function(){return{}}},configur:{type:Object,default:function(){return{}}},templateStage:{type:String,default:""},templateInfo:{type:Object,default:function(){return{}}},isShowTitle:{type:Boolean,default:function(){return!1}}},data:function(){return{nodesList:[],isDataLoading:!1,secondClick:!1,showTabList:[],changeInfo:{},sliderInfo:{title:this.$t('m.treeinfo["新增字段"]'),show:!1,width:700},processInfo:{isShow:!1,title:this.$t('m.treeinfo["字段预览"]'),position:{top:150},draggable:!0},previewTab:[],isEditPublic:!1,moduleInfo:{isShow:!1,width:700,headerPosition:"left",autoClose:!1},addOrigin:{isOther:!1},isFormChanged:!1}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},watch:{"templateInfo.id":function(){this.initData()},templateStage:function(){this.initData()}},mounted:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:case"end":return t.stop()}}),t,e)})))()},beforeDestroy:function(){this.clearFieldsIndexInfo()},methods:{initData:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.templateStage&&(e.addOrigin.isOther=!0,e.addOrigin.addOriginInfo={type:"templateField",addUrl:"taskTemplate/createTemplateField",updateUrl:"taskTemplate/updateTemplateField"}),t.next=3,e.getTableList();case 3:case"end":return t.stop()}}),t,e)})))()},getTableList:function(){var e=this,t="deployCommon/getFieldList",i={};if(this.templateInfo.id)t="taskTemplate/getTemplateFields",i.task_schema_id=this.templateInfo.id,i.stage=this.templateStage;else{if(!this.flowInfo||!this.flowInfo.id)return;i.workflow=this.flowInfo.id,i.state=this.configur.id}this.isDataLoading=!0,this.$store.dispatch(t,i).then((function(t){e.showTabList=e.orderByCacheInfo(t.data),e.showTabList.forEach((function(t){e.globalChoise.field_type.forEach((function(i){t.type===i.typeName&&e.$set(t,"typeName",i.name)})),"COMPLEX-MEMBERS"===t.type&&e.$set(t,"typeName",e.$t("m.newCommon['处理人']")),"SOPS_TEMPLATE"===t.type&&e.$set(t,"typeName",e.$t("m.newCommon['流程模板']")),e.globalChoise.validate_type.forEach((function(i){t.validate_type===i.typeName&&e.$set(t,"is_required",i.name)}))}))})).catch((function(t){(0,d.errorHandler)(t,e)})).finally((function(){e.isDataLoading=!1}))},checkDeleteDisabled:function(e){return!(!e.is_builtin||!this.configur.is_first_state||-1!==["impact","urgency","priority","current_status"].indexOf(e.key))||("APPROVE_RESULT"===e.meta.code||(-1!==["processors","task_name"].indexOf(e.key)||"APPROVAL"===this.configur.type))},checkEditDisabled:function(){return"APPROVAL"===this.configur.type},updateInfo:function(){this.cacheFieldsIndexInfo()},handleBeforeClose:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isFormChanged){t.next=5;break}return t.next=3,(0,l.default)();case 3:return i=t.sent,t.abrupt("return",i);case 5:return t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t,e)})))()},closeShade:function(){this.sliderInfo.show=!1},orderByCacheInfo:function(e){var t=this,i=[],n=[];return e.forEach((function(e){var a=t.getOneFieldCacheIndex(e.id);a||0===a?i[a]=e:n.push(e)})),i.filter((function(e){return!!e})).concat(n)},cacheFieldsIndexInfo:function(){var e=this,t=this.showTabList.reduce((function(t,i,n){return t[window.username+"_"+e.flowInfo.id+"_"+e.configur.id+"_"+i.id]=n,t}),{});sessionStorage.setItem("fieldsIndexMap",(0,n.default)(t))},getOneFieldCacheIndex:function(e){var t=sessionStorage.getItem("fieldsIndexMap")||"{}";return JSON.parse(t)[window.username+"_"+this.flowInfo.id+"_"+this.configur.id+"_"+e]},clearFieldsIndexInfo:function(){sessionStorage.removeItem("fieldsIndexMap")},getFrontNodesList:function(){var e=this;if(this.configur.id||this.templateInfo.id){var t="",i={};this.configur.id&&(t="apiRemote/get_related_fields",i.workflow=this.workflow,i.state=this.configur.id),this.templateInfo.id&&(t="taskTemplate/getFrontFieldsList",i.id=this.templateInfo.id,i.stage=this.templateStage),this.$store.dispatch(t,i).then((function(t){e.nodesList=t.data,e.sliderInfo.show=!0,e.isFormChanged=!1})).catch((function(t){(0,d.errorHandler)(t,e)}))}},addField:function(){this.changeInfo={workflow:"",id:"",key:"",name:"",type:"STRING",desc:"",layout:"COL_12",validate_type:"REQUIRE",choice:[],is_builtin:!1,source_type:"CUSTOM",source_uri:"",regex:"EMPTY",custom_regex:"",is_tips:!1,tips:"",meta:{}},this.sliderInfo.title=this.$t('m.treeinfo["新增字段"]'),this.getFrontNodesList()},openField:function(e){this.changeInfo=e,this.changeInfo.is_tips=e.is_tips||!1,this.sliderInfo.title=this.$t('m.treeinfo["编辑字段"]'),this.getFrontNodesList()},previewField:function(){if(this.showTabList.length){this.previewTab=this.showTabList;for(var e=this.previewTab.some((function(e){return"impact"===e.key||"urgency"===e.key})),t=0;t<this.previewTab.length;t++){for(var i=0;i<this.previewTab[t].choice.length;i++)this.previewTab[t].choice[i].typeName=this.previewTab[t].choice[0]?this.previewTab[t].choice[0].key:"";this.$set(this.previewTab[t],"val",this.previewTab[t].default||""),this.$set(this.previewTab[t],"showFeild",!0),"priority"!==this.previewTab[t].key||e||this.$set(this.previewTab[t],"is_readonly",!1)}this.processInfo.isShow=!0,this.isNecessaryToWatch({fields:this.previewTab},"workflow")}},deleteTable:function(e){var t=this;this.$bkInfo({type:"warning",title:this.$t('m.treeinfo["确认删除此字段？"]'),subTitle:this.$t('m.treeinfo["字段一旦删除，此字段将不在可用。请谨慎操作。"]'),confirmFn:function(){var i="deployCommon/deleteField",n={id:e.id,params:{state_id:t.configur.id}};t.templateInfo.id&&(i="taskTemplate/deleteTemplateField",delete n.params),t.secondClick||(t.secondClick=!0,t.$store.dispatch(i,n).then((function(){t.$bkMessage({message:t.$t('m.systemConfig["删除成功"]'),theme:"success"}),t.getTableList()})).catch((function(e){(0,d.errorHandler)(e,t)})).finally((function(){t.secondClick=!1})))}})},openAddModule:function(){this.moduleInfo.isShow=!0},submitModule:function(){var e=this,t=this.$refs.inheritState.checkList.filter((function(e){return!e.is_disabled}));if(t.length){var i={fields:t},n=this.configur.id;if(this.secondClick)return;this.secondClick=!0,this.$store.dispatch("basicModule/add_fields_from_table",{params:i,id:n}).then((function(){e.$bkMessage({message:e.$t('m.systemConfig["添加成功"]'),theme:"success"}),e.moduleInfo.isShow=!1,e.getTableList()})).catch((function(t){(0,d.errorHandler)(t,e)})).finally((function(){e.secondClick=!1}))}else this.moduleInfo.isShow=!1}}}},LexG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],staticClass:"bk-hidden-conditions",on:{click:function(t){e.checkStatus=!1}}},[t("div",{staticClass:"bk-form-content",staticStyle:{"margin-left":"0"}},[t("p",{staticClass:"bk-form-p"},[e._v(e._s(e.$t("m.treeinfo['条件组间关系']")))]),e._v(" "),t("bk-radio-group",{model:{value:e.conditionType,callback:function(t){e.conditionType=t},expression:"conditionType"}},[t("bk-radio",{attrs:{value:"and","ext-cls":"mr20"}},[e._v(e._s(e.$t("m.treeinfo['且']")))]),e._v(" "),t("bk-radio",{attrs:{value:"or"}},[e._v(e._s(e.$t("m.treeinfo['或']")))])],1)],1),e._v(" "),e.checkStatus?t("p",{staticClass:"bk-error-msg"},[e._v(e._s(e.$t("m.treeinfo['关系名称，关系表达式，关系值不能为空']")))]):e._e(),e._v(" "),t("i",{staticClass:"bk-icon icon-close",on:{click:e.clearCondition}}),e._v(" "),e._l(e.listInfo,(function(i,n){return t("div",{key:n,staticClass:"bk-between-form",class:{mt20:n}},[t("bk-select",{staticStyle:{"min-width":"85px",float:"left","margin-right":"10px"},attrs:{searchable:""},on:{selected:function(t){return e.changeName(...arguments,i)}},model:{value:i.key,callback:function(t){e.$set(i,"key",t)},expression:"node.key"}},e._l(e.fieldList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),t("bk-select",{staticStyle:{"min-width":"60px",float:"left","margin-right":"10px"},attrs:{searchable:""},model:{value:i.condition,callback:function(t){e.$set(i,"condition",t)},expression:"node.condition"}},e._l(i.betweenList,(function(e){return t("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),"SELECT"===i.type||"MULTISELECT"===i.type||"RADIO"===i.type||"CHECKBOX"===i.type||"MEMBERS"===i.type||"TREESELECT"===i.type?[i.choiceList.length?[t("bk-select",{staticStyle:{width:"80px"},attrs:{"ext-cls":"bk-form-style",searchable:"",multiple:i.multiSelect},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"node.value"}},e._l(i.choiceList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:[t("bk-input",{attrs:{"ext-cls":"bk-form-style",type:"INT"===i.type?"number":"text",placeholder:e.$t("m.treeinfo['请输入关系值']")},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"node.value"}})]]:"DATE"===i.type||"DATETIME"===i.type?[t("bk-date-picker",{attrs:{"ext-cls":"bk-form-style",type:"DATETIME"===i.type?"datetime":"date"},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"node.value"}})]:[t("bk-input",{attrs:{"ext-cls":"bk-form-style",type:"INT"===i.type?"number":"text",placeholder:e.$t("m.treeinfo['请输入关系值']")},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"node.value"}})],e._v(" "),t("div",{staticClass:"bk-between-operat"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(t){return e.addNode(i,n)}}}),e._v(" "),t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.listInfo.length},on:{click:function(t){return e.deleteNode(i,n)}}})])],2)}))],2)},a=[];n._withStripped=!0},LwjM:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-trigger-field"},["STRING"===e.item.type||"TEXT"===e.item.type?[t("bk-input",{attrs:{maxlength:120},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:"INT"===e.item.type?[t("bk-input",{attrs:{clearable:!0,type:"number"},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:"SELECT"===e.item.type||"RADIO"===e.item.type?[t("bk-select",{attrs:{searchable:"",loading:e.item.loading},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}},e._l(e.item.options,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:"CHECKBOX"===e.item.type||"MULTISELECT"===e.item.type?[t("bk-select",{attrs:{searchable:"",multiple:"",loading:e.item.loading},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}},e._l(e.item.options,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:"MEMBERS"===e.item.type||"MULTI_MEMBERS"===e.item.type||"MEMBER"===e.item.type?[t("member-select",{model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:"DATE"===e.item.type?[t("bk-date-picker",{attrs:{placeholder:e.$t("m.newCommon['选择日期']")},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:"DATETIME"===e.item.type?[t("bk-date-picker",{attrs:{type:"datetime",placeholder:e.$t("m.newCommon['选择日期时间']")},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:[t("bk-input",{attrs:{maxlength:120},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]],2)},a=[];n._withStripped=!0},MBfY:function(e,t,i){"use strict";i.r(t);var n=i("GauI"),a=i("T2YI");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("pLkd");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"6d0b7e2a",null);t.default=o.exports},MHZE:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",{staticClass:"ci-template"},[t("bk-form",{ref:"devopsForm",attrs:{model:e.item.devopsContent,rules:e.defaultRules,"label-width":200,"form-type":"vertical"}},[t("bk-form-item",{attrs:{label:e.$t("m.tickets['项目']"),required:!0,property:"project_id","error-display-type":"normal"}},[t("bk-select",{attrs:{loading:e.projectLoading,searchable:"",disabled:e.disabled},on:{selected:e.handleProjectChange},model:{value:e.item.devopsContent.project_id,callback:function(t){e.$set(e.item.devopsContent,"project_id",t)},expression:"item.devopsContent.project_id"}},e._l(e.projectList,(function(e){return t("bk-option",{key:e.projectCode,attrs:{id:e.projectCode,name:e.project_name}})})),1)],1),e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.tickets['流水线']"),required:!0,property:"pipeline_id","error-display-type":"normal"}},[t("bk-select",{attrs:{loading:e.pipelineLoading,searchable:"",disabled:e.disabled},on:{selected:e.handlePipelineChange},model:{value:e.item.devopsContent.pipeline_id,callback:function(t){e.$set(e.item.devopsContent,"pipeline_id",t)},expression:"item.devopsContent.pipeline_id"}},e._l(e.pipelineList,(function(e){return t("bk-option",{key:e.pipelineId,attrs:{id:e.pipelineId,name:e.pipelineName}})})),1)],1)],1),e._v(" "),t("h3",{staticClass:"setion-title"},[t("span",{staticClass:"setion-title-icon",on:{click:function(t){t.stopPropagation(),e.showPipelineVariable=!e.showPipelineVariable}}},[e.showPipelineVariable?t("i",{staticClass:"bk-icon icon-angle-down"}):t("i",{staticClass:"bk-icon icon-angle-right"})]),e._v("\n    "+e._s(e.$t("m.tickets['流水线变量']"))+"\n  ")]),e._v(" "),t("bk-form",{directives:[{name:"show",rawName:"v-show",value:e.showPipelineVariable,expression:"showPipelineVariable"},{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.pipelineStartLoading},expression:"{ isLoading: pipelineStartLoading }"}],ref:"devopsVariable",attrs:{model:e.item.devopsContent.variables,"label-width":200,"form-type":"vertical"}},e._l(e.pipelineVariableList,(function(i){return t("bk-form-item",{key:i.id,staticClass:"half-width-item",attrs:{label:i.id,required:!0,property:i.id,rules:e.rules[i.id],"error-display-type":"normal"}},[t("bk-input",{attrs:{disabled:e.disabled,clearable:!0},model:{value:e.item.devopsContent.variables[i.id],callback:function(t){e.$set(e.item.devopsContent.variables,i.id,t)},expression:"item.devopsContent.variables[variable.id]"}})],1)})),1),e._v(" "),t("h3",{staticClass:"setion-title border-none"},[t("span",{staticClass:"setion-title-icon",on:{click:function(t){t.stopPropagation(),e.showPipelineStages=!e.showPipelineStages}}},[e.showPipelineStages?t("i",{staticClass:"bk-icon icon-angle-down"}):t("i",{staticClass:"bk-icon icon-angle-right"})]),e._v("\n    "+e._s(e.$t("m.tickets['插件预览']"))+"\n  ")]),e._v(" "),t("devops-preview",{directives:[{name:"show",rawName:"v-show",value:e.showPipelineStages,expression:"showPipelineStages"}],attrs:{stages:e.pipelineStages,loading:e.pipelineDetailLoading}})],1):e._e()},a=[];n._withStripped=!0},MI7q:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("GQeE")),a=o(i("gDS+")),r=o(i("14Xm")),s=o(i("D3Ub"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"getParam",components:{},props:{changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){}},stateList:{type:Array,default:function(){return[]}},isStatic:{type:Boolean,default:function(){return!1}},isCustom:{type:Boolean,default:function(){return!1}},queryValue:{type:Object,default:function(){return{}}},entry:{type:String,default:function(){return""}},formInfo:{type:Object,default:function(){return{}}}},data:function(){return{paramTableData:[],checkInfo:{name:"",road:""},sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],paramTableInfo:{value:"",placeholder:this.$t('m.treeinfo["请选择数据来源"]')}}},computed:{},watch:{apiDetail:function(){this.initData()}},mounted:function(){var e=this;return(0,s.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.changeInfo;case 2:return t.next=4,e.isStatic;case 4:return t.next=6,e.queryValue;case 6:return t.next=8,e.initData();case 8:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;return(0,s.default)(r.default.mark((function t(){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,JSON.parse((0,a.default)(e.apiDetail.req_params));case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:return i=t.t0,t.next=8,i.forEach((function(t){if(t.isCheck=!1,t.isSatisfied=!1,t.el=null,t.customValue=t.value||"",t.source_type="CUSTOM",t.value_key="",e.isStatic)t.value=e.queryValue[t.name]||"";else if(e.changeInfo.api_info&&(0,n.default)(e.changeInfo.api_info.req_params).length&&e.changeInfo.api_info.remote_api_id===e.apiDetail.id)if(/^\$\{params_.*\}$/.test(e.changeInfo.api_info.req_params[t.name]))t.source_type="FIELDS",t.value_key=e.changeInfo.api_info.req_params[t.name]?JSON.parse((0,a.default)(e.changeInfo.api_info.req_params[t.name])).replace(/^\$\{params_/,"").replace(/\}$/,""):"";else{var i=e.changeInfo.api_info.req_params[t.name];t.source_type="CUSTOM",t.value=i}}));case 8:return t.next=10,JSON.parse((0,a.default)(i));case 10:e.paramTableData=t.sent;case 11:case"end":return t.stop()}}),t,e)})))()},addNewItem:function(e){this.$emit("addNewItem",e)}}}},"MX/Q":function(e,t,i){},Mf0c:function(e,t,i){"use strict";i.r(t);var n=i("G6uA"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},N8nL:function(e,t,i){"use strict";i("G4fa")},NFkJ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("ukIK"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"sendMessage",components:{changeConductor:r.default},props:{itemInfo:{type:Object,default:function(){return{}}},isShowVar:{type:Boolean,default:function(){return!0}}},data:function(){return{trueStatus:!0,falseStatus:!1,activeName:"send_email_message",show:!0}},computed:{},created:function(){var e=this;this.itemInfo.sub_components.forEach((function(t){switch(e.$set(t,"checked",t.checked||!1),t.checked&&(e.activeName=t.name),e.$set(t,"label",t.name),e.$set(t,"icon",""),t.key){case"send_email_message":t.icon="icon-email";break;case"send_sms_message":t.icon="icon-mobile";break;case"send_wechat_message":t.icon="icon-weixin"}}))},mounted:function(){},methods:{changPanel:function(e){this.activeName=e},changePanelStatus:function(e,t){console.log(e,t)}}}},NGZu:function(e,t,i){"use strict";i.r(t);var n=i("+KRo"),a=i("VtRw");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("N8nL");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"60ae7397",null);t.default=o.exports},NLOC:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("efIh"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"DATE",mixins:[r.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){if(this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value),!this.item.val){var e=new Date;this.item.val=e,this.item.value=e}},methods:{}}},NPk7:function(e,t,i){"use strict";i.r(t);var n=i("q4Iw"),a=i("Cyyo");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("qkdU");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"21fd4902",null);t.default=o.exports},NXOa:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("efIh")),a=r(i("FCVG"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"CUSTOM-FORM",components:{RenderView:a.default},mixins:[n.default],props:{item:{type:Object,default:function(){}},fields:{type:Array,default:function(){return[]}}},data:function(){return{formData:[],context:{},errMessage:""}},watch:{"item.val":{handler:function(){this.conditionField(this.item,this.fields),this.initRenderView()},immediate:!0}},mounted:function(){this.item.value&&!this.item.val&&(this.item.val=this.item.value)},methods:{initRenderView:function(){this.errMessage="";try{var e="string"==typeof this.item.val?JSON.parse(this.item.val):this.item.val,t=e.form_data,i=e.schemes,n=e.config;this.formData=t,this.context={schemes:i,config:n}}catch(e){this.errMessage=e,this.formData=[]}}}}},Ncax:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,"ext-cls":"bk-ext-item",desc:e.item.tips,"desc-type":"icon"}},[t("div",{staticClass:"member-form-item",on:{click:function(t){e.item.checkValue=!1}}},[t("member-select",{class:{"bk-border-error":e.item.checkValue},attrs:{disabled:e.item.is_readonly&&!e.isCurrent||e.item.evaluDisable||e.disabled,placeholder:e.item.desc},on:{change:e.onMemberSelectChange},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}}),e._v(" "),t("business-card",{attrs:{item:e.item}})],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},NesJ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("efIh"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"DATETIME",mixins:[r.default],props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){if(this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value),!this.item.val){var e=new Date;this.item.val=e,this.item.value=e}},methods:{}}},Nq3X:function(e,t,i){"use strict";i("wQ82")},Nxk6:function(e,t,i){i("dbV7"),e.exports=9007199254740991},O4pD:function(e,t,i){"use strict";i.r(t);var n=i("RnPO"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},OE89:function(e,t,i){"use strict";i.r(t);var n=i("n5mh"),a=i("O4pD");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("1h6V");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"55a2ec1b",null);t.default=o.exports},OV2Y:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-input-params"},[t("bk-table",{attrs:{data:e.paramTableData,size:"small"}},[t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"bk-more"},[t("span",{style:{paddingLeft:20*i.row.level+"px"}},[i.row.has_children?t("span",{class:["bk-icon","tree-expanded-icon",i.row.showChildren?"icon-down-shape":"icon-right-shape"],on:{click:function(t){return e.changeState(i.row)}}}):t("span",{staticClass:"bk-icon bk-more-icon"}),e._v(" "),t("span",[e._v(e._s(i.row.key||"--"))])])])]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['必选']"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n      ")]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{attrs:{title:i.row.desc}},[e._v(e._s(i.row.desc||"--"))])]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"280"},scopedSlots:e._u([{key:"default",fn:function(i){return["object"!==i.row.type&&"array"!==i.row.type?[t("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",left:"10px"}},[t("bk-select",{attrs:{clearable:!1,searchable:""},model:{value:i.row.source_type,callback:function(t){e.$set(i.row,"source_type",t)},expression:"props.row.source_type"}},e._l(e.sourceTypeList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),i.row.source_type&&"CUSTOM"!==i.row.source_type?t("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",right:"10px"}},[t("bk-select",{attrs:{clearable:!1,searchable:""},model:{value:i.row.value_key,callback:function(t){e.$set(i.row,"value_key",t)},expression:"props.row.value_key"}},e._l(e.variableList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1):t("div",{staticStyle:{width:"120px",position:"absolute",top:"4px",right:"10px"}},["string"===i.row.type||"number"===i.row.type?[t("bk-input",{attrs:{type:"string"===i.row.type?"text":"number",placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:i.row.value,callback:function(t){e.$set(i.row,"value",t)},expression:"props.row.value"}})]:e._e(),e._v(" "),"boolean"===i.row.type?[t("bk-radio-group",{model:{value:i.row.value,callback:function(t){e.$set(i.row,"value",t)},expression:"props.row.value"}},[t("bk-radio",{attrs:{value:e.trueSatatus}},[e._v("true")]),e._v(" "),t("bk-radio",{attrs:{value:e.falseSatatus}},[e._v("false")])],1)]:e._e()],2)]:e._e()]}}])}),e._v(" "),t("bk-table-column",{attrs:{width:"60","class-name":"last-add-row-column"},scopedSlots:e._u([{key:"default",fn:function(i){return["array"===i.row.lastType?t("div",{staticClass:"bk-between-operat"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(t){return e.addChildren(i.row)}}}),e._v(" "),"array"===i.row.lastType?t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":e.countSon(i.row)},on:{click:function(t){return e.deletChildren(i.row)}}}):e._e()]):e._e()]}}])})],1)],1)},a=[];n._withStripped=!0},OjZH:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("WgRI"),r=(n=a)&&n.__esModule?n:{default:n},s=i("ygAv");t.default={name:"SelectTree",components:{Tree:r.default},model:{prop:"value",event:"selected"},props:{list:{type:Array,default:function(){return[]}},value:{type:[Number,String,Array],default:""},placeholder:{type:String,default:""},loading:{type:Boolean,default:!1},extCls:{type:String,default:""},organizationLoading:Boolean},data:function(){return{isShowTree:!1,displayName:"",displayList:[],checked:null}},watch:{list:function(){this.initData()},value:function(){this.initData()},loading:function(){this.initData()}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.displayList=(0,s.deepClone)(this.list),this.displayList.length&&this.displayList.forEach((function(t){e.setCheckedValue(t)})),this.value&&this.checked&&this.displayList.forEach((function(t){e.openChildren(t)})),this.checked&&this.$emit("change",(0,s.deepClone)(this.checked))},setCheckedValue:function(e){var t=this;if(this.$set(e,"checkInfo",!1),this.$set(e,"has_children",!(!e.children||!e.children.length)),this.value&&String(this.value)===String(e.id))return e.checkInfo=!0,this.checked=e,void this.setDispalyName();e.has_children&&(this.$set(e,"showChildren",!1),e.children.forEach((function(e){t.setCheckedValue(e)})))},openChildren:function(e){var t=this;this.$set(e,"showChildren",!1),this.$set(e,"showChildren",this.checked.route.some((function(t){return String(t.id)===String(e.id)}))),e.children&&e.children.length&&e.children.forEach((function(e){t.openChildren(e)}))},setDispalyName:function(){var e=[];this.checked.route.length&&(e=this.checked.route.map((function(e){return e.name}))),e.push(this.checked.name),this.displayName=e.join("/")},showTree:function(){this.loading||(this.isShowTree=!0)},closeTree:function(){this.isShowTree=!1},toggleInfo:function(e){this.checked=e,this.setDispalyName(),this.cancelAllSectedStatus(),this.$set(e,"checkInfo",!0),this.$emit("selected",e.id),this.$emit("change",(0,s.deepClone)(e)),this.closeTree()},cancelAllSectedStatus:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.displayList;t.forEach((function(t){e.$set(t,"checkInfo",!1),t.children&&t.children.length&&e.cancelAllSectedStatus(t.children)}))},toggleChildren:function(e){this.$set(e,"showChildren",!e.showChildren)}}}},OkDz:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Jwqd"),a={column:{type:Array,default:function(){return[{name:"操作",type:"text",key:"column1"},{name:"关联相关内容",key:"column2",scheme:"table_text_scheme",attrs:{}},{name:"申请期限",type:"text",key:"column3",attrs:{sort:!0}}]}},value:{type:Array,default:function(){return[]}}};t.default={name:"TagTable",components:{ViewItem:function(){return Promise.resolve().then(i.bind(null,"UsFA"))}},mixins:[(0,n.getFormMixins)(a)],methods:{getScheme:function(e,t){var i=this.getContext().schemes;return t&&t.scheme&&i[t.scheme]?i[t.scheme]:e.scheme?i[e.scheme]:t&&t.type?{type:t.type}:{type:e.type}}}}},"Om//":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isDataLoading},expression:"{ isLoading: isDataLoading }"}],staticClass:"bk-add-field"},[t("bk-form",{ref:"fieldForm",staticClass:"bk-add-field bk-form-vertical",attrs:{"label-width":200,"form-type":e.formAlign,model:e.formInfo,rules:e.rules}},[Object.keys(e.sospInfo).length?[t("bk-form-item",{style:{marginTop:"vertical"===e.formAlign?0:"20px"},attrs:{label:e.$t("m.treeinfo['前置节点']"),required:!0,property:"prevId","error-display-type":"normal","ext-cls":"bk-mt0-item"}},[t("bk-select",{attrs:{searchable:""},on:{change:function(t){return e.$emit("change")}},model:{value:e.formInfo.prevId,callback:function(t){e.$set(e.formInfo,"prevId",t)},expression:"formInfo.prevId"}},e._l(e.prevNodeList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1)]:e._e(),e._v(" "),t("bk-form-item",{style:{marginTop:"vertical"===e.formAlign?0:"20px"},attrs:{"data-test-id":"field-input-fieldName",label:e.$t("m.treeinfo['字段名']"),required:!0,property:"name","error-display-type":"normal","ext-cls":"bk-halfline-item bk-halfline-margin"}},[t("bk-input",{attrs:{maxlength:"120",disabled:"TABLE"===e.changeInfo.source&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入字段显示名']")},on:{change:e.fieldNameChange,input:e.putKey},model:{value:e.formInfo.name,callback:function(t){e.$set(e.formInfo,"name",t)},expression:"formInfo.name"}})],1),e._v(" "),t("bk-form-item",{style:{marginTop:"vertical"===e.formAlign?0:"20px"},attrs:{label:e.$t("m.treeinfo['唯一标识']"),required:!0,property:"key","error-display-type":"normal","ext-cls":"bk-halfline-item"}},[t("bk-input",{attrs:{placeholder:e.$t("m.treeinfo['请输入唯一标识']"),disabled:"number"==typeof e.changeInfo.id||e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source},on:{change:function(t){return e.$emit("change")}},model:{value:e.formInfo.key,callback:function(t){e.$set(e.formInfo,"key",t)},expression:"formInfo.key"}})],1),e._v(" "),t("bk-form-item",{attrs:{"data-test-id":"field-select-fieldType",label:e.$t("m.treeinfo['字段类型']"),required:!0,property:"type","error-display-type":"normal","ext-cls":"bk-halfline-item bk-halfline-margin bk-mt20-item"}},[t("bk-select",{attrs:{clearable:!1,disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key,searchable:""},on:{selected:e.changeType},model:{value:e.formInfo.type,callback:function(t){e.$set(e.formInfo,"type",t)},expression:"formInfo.type"}},e._l(e.fieldTypeList,(function(e){return t("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1)],1),e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['校验方式']"),required:!0,"error-display-type":"normal","ext-cls":"bk-halfline-item bk-mt20-item"}},[t("bk-select",{attrs:{clearable:!1,disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key,searchable:""},on:{selected:e.changeRegex},model:{value:e.formInfo.regex,callback:function(t){e.$set(e.formInfo,"regex",t)},expression:"formInfo.regex"}},e._l(e.regexList,(function(e){return t("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1)],1),e._v(" "),"ASSOCIATED_FIELD_VALIDATION"!==e.formInfo.regex||e.isEditPublic?e._e():t("div",{staticClass:"bk-form-item bk-relate-conditions",staticStyle:{width:"100%"}},[t("div",{staticClass:"bk-form-content",staticStyle:{"margin-left":"0"}},[t("p",{staticClass:"bk-form-p"},[e._v(e._s(e.$t('m.newCommon["字段间关系"]')))]),e._v(" "),t("bk-radio-group",{on:{change:function(t){return e.$emit("change")}},model:{value:e.formInfo.regex_config.rule.type,callback:function(t){e.$set(e.formInfo.regex_config.rule,"type",t)},expression:"formInfo.regex_config.rule.type"}},[t("bk-radio",{attrs:{value:"and","ext-cls":"mr20"}},[e._v(e._s(e.$t("m.treeinfo['且']")))]),e._v(" "),t("bk-radio",{attrs:{value:"or"}},[e._v(e._s(e.$t("m.treeinfo['或']")))])],1)],1),e._v(" "),e._l(e.formInfo.regex_config.rule.expressions,(function(i,n){return t("div",{key:n,staticClass:"bk-between-form"},[t("p",{staticClass:"current-field"},[e._v(e._s(e.$t('m.newCommon["当前字段"]')))]),e._v(" "),t("bk-select",{staticStyle:{width:"120px"},attrs:{"ext-cls":"field-valid-select",clearable:!1},on:{change:function(t){return e.$emit("change")}},model:{value:i.condition,callback:function(t){e.$set(i,"condition",t)},expression:"expression.condition"}},e._l(e.betweenList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),t("bk-select",{staticStyle:{width:"210px"},attrs:{"ext-cls":"field-valid-select",clearable:!1},on:{change:function(t){return e.onRegexFieldChange(t,i)}},model:{value:i.key,callback:function(t){e.$set(i,"key",t)},expression:"expression.key"}},e._l(e.regexFieldList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),t("div",{staticClass:"bk-between-operate"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(t){return e.addExpression()}}}),e._v(" "),t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.formInfo.regex_config.rule.expressions.length},on:{click:function(t){return e.deleteExpression(n)}}})])],1)}))],2),e._v(" "),"CUSTOM"===e.formInfo.regex?[t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['正则规则']"),required:!0,property:"key","error-display-type":"normal","ext-cls":"bk-halfline-item bk-halfline-margin bk-mt20-item"}},[t("bk-input",{attrs:{disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source)&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入正则规则']")},on:{change:function(t){return e.$emit("change")}},model:{value:e.formInfo.customRegex,callback:function(t){e.$set(e.formInfo,"customRegex",t)},expression:"formInfo.customRegex"}})],1)]:e._e()],2),e._v(" "),t("bk-form",{ref:"dataForm",staticClass:"bk-form-vertical",attrs:{"label-width":200,"form-type":e.formAlign,model:e.formInfo}},[e.showType.sourceList.some(t=>t===e.formInfo.type)?[t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['数据源']"),required:!0,"ext-cls":"bk-mt20-item"}},[t("data-source",{ref:"dataSource",attrs:{"form-info":e.formInfo,"prc-data":e.prcData,"change-info":e.assignValue,"api-info":e.apiInfo.api_info,"dictionary-data":e.dictionaryData},on:{changeApiInfo:e.changeApiInfo,getRpcData:e.getRpcData}})],1),e._v(" "),"DATADICT"!==e.formInfo.source_type&&"RPC"!==e.formInfo.source_type||"RPC"===e.formInfo.source_type&&e.prcTable.length?[e._l(e.globalChoise.source_type,(function(i,n){return[i.typeName===e.formInfo.source_type?t("bk-form-item",{key:n,attrs:{label:i.name,desc:i.desc,required:!0,"ext-cls":"bk-mt20-item"}},[e.isShowDataSourcebtn?t("bk-button",{staticClass:"configuration-data-source",attrs:{disabled:e.isDisabled,theme:"primary",title:e.$t("m['配置数据源']"),outline:!0},on:{click:e.openDataSource}},[e._v(e._s(e.$t("m['配置数据源']")))]):e._e(),e._v(" "),t("bk-dialog",{attrs:{width:"960",title:"API"===e.formInfo.source_type?e.$t("m['配置接口数据']"):e.$t("m['配置自定义数据']"),theme:"primary","auto-close":!1,"mask-close":!1},on:{confirm:e.validateContent},model:{value:e.isShowDataSource,callback:function(t){e.isShowDataSource=t},expression:"isShowDataSource"}},[t("data-content",{ref:"dataContent",refInFor:!0,attrs:{"form-info":e.formInfo,workflow:e.workflow,state:e.state,"change-info":e.assignValue,"api-detail":e.apiDetail,"api-info":e.apiInfo.api_info,"kv-relation":e.apiInfo.kv_relation,"prc-table":e.prcTable,"field-info":e.fieldInfo}})],1)],1):e._e()]}))]:e._e()]:e._e(),e._v(" "),"CUSTOMTABLE"===e.formInfo.type?[t("bk-form-item",{attrs:{"data-test-id":"field_form_custom",label:e.$t("m.treeinfo['自定义数据']"),required:!0,"ext-cls":"bk-mt20-item"}},[t("div",{on:{click:function(t){e.checkStatus.customTableStatus=!1}}},[t("custom-table-data",{attrs:{"custom-table-info":e.customTableInfo}}),e._v(" "),e.checkStatus.customTableStatus?t("p",{staticClass:"bk-field-error"},[e._v(e._s(e.$t('m.treeinfo["请填写正确格式的自定义数据"]')))]):e._e()],1),e._v(" "),(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key?t("div",{staticClass:"bk-form-disabled"}):e._e()])]:e._e(),e._v(" "),"FILE"===e.formInfo.type?[t("bk-form-item",{attrs:{"ext-cls":"bk-input-position bk-mt20-item",label:e.$t("m.treeinfo['上传附件模板']")}},[t("bk-button",{attrs:{theme:"default",title:e.$t("m.treeinfo['点击上传']")}},[e._v("\n          "+e._s(e.$t("m.treeinfo['点击上传']"))+"\n        ")]),e._v(" "),t("input",{staticClass:"bk-input-file",attrs:{type:"file"},domProps:{value:e.fileVal},on:{change:e.handleFile}}),e._v(" "),t("ul",{staticClass:"bk-file-list"},e._l(e.fileList,(function(i,n){return t("li",{key:n},[t("span",{staticClass:"bk-file-success"},[t("i",{staticClass:"bk-icon icon-check-1"})]),e._v(" "),t("span",[e._v(e._s(i.name))]),e._v(" "),t("span",{staticClass:"bk-file-delete",on:{click:function(t){return e.deleteFile(i,n)}}},[e._v("×")])])})),0),e._v(" "),!e.changeInfo.is_builtin&&"TABLE"!==e.changeInfo.source||"bk_biz_id"===e.formInfo.key?e._e():t("div",{staticClass:"bk-form-disabled"})],1)]:e._e(),e._v(" "),e.showType.belongDefaultList.some(t=>e.formInfo.type===t)?[t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['默认值']"),"ext-cls":"bk-mt20-item"}},[t("default-value",{attrs:{"form-info":e.formInfo,"field-info":e.fieldInfo,"dictionary-data":e.dictionaryData,"change-info":e.changeInfo,"api-info":e.apiInfo,"check-status":e.checkStatus,label:e.$t("m.treeinfo['默认值']")}})],1)]:e._e(),e._v(" "),e.addOrigin.isOther&&"publicField"===e.addOrigin.addOriginInfo.type?e._e():[t("bk-form-item",{attrs:{"ext-cls":"bk-halfline-item bk-halfline-margin bk-mt20-item",label:e.$t("m.treeinfo['布局要求']"),required:!0}},[t("bk-radio-group",{on:{change:function(t){return e.$emit("change")}},model:{value:e.formInfo.layout,callback:function(t){e.$set(e.formInfo,"layout",t)},expression:"formInfo.layout"}},[e._l(e.globalChoise.layout_type,(function(i,n){return[t("bk-radio",{key:n,attrs:{"ext-cls":"mr20",value:i.typeName,disabled:e.showType.layoutList.some(t=>t===e.formInfo.type)}},[e._v("\n              "+e._s(i.name)+"\n            ")])]}))],2)],1),e._v(" "),t("bk-form-item",{attrs:{"ext-cls":"bk-halfline-item bk-mt20-item",label:e.$t("m.treeinfo['字段必填']"),required:!0}},[t("bk-radio-group",{on:{change:function(t){return e.$emit("change")}},model:{value:e.formInfo.validate,callback:function(t){e.$set(e.formInfo,"validate",t)},expression:"formInfo.validate"}},[e._l(e.globalChoise.validate_type,(function(i,n){return[t("bk-radio",{key:n,attrs:{"ext-cls":"mr20",value:i.typeName,disabled:"title"===e.changeInfo.key||e.changeInfo.is_builtin||"bk_biz_id"===e.formInfo.key}},[e._v("\n              "+e._s(i.name)+"\n            ")])]}))],2)],1)],e._v(" "),t("bk-form-item",{attrs:{"ext-cls":"bk-tanble-height bk-mt20-item",label:e.$t("m.treeinfo['填写说明']")}},[t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.formInfo.desc,expression:"formInfo.desc",modifiers:{trim:!0}}],staticClass:"bk-form-textarea bk-textarea-tanble bk-halfline-item bk-halfline-margin field-input-tips",attrs:{placeholder:e.$t("m.treeinfo['请输入字段填写说明']")},domProps:{value:e.formInfo.desc},on:{change:function(t){return e.$emit("change")},input:function(t){t.target.composing||e.$set(e.formInfo,"desc",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),t("p",{staticClass:"field-tips-checkbox",staticStyle:{"margin-left":"335px"}},[t("bk-checkbox",{attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus},on:{change:function(t){return e.$emit("change")}},model:{value:e.formInfo.is_tips,callback:function(t){e.$set(e.formInfo,"is_tips",t)},expression:"formInfo.is_tips"}},[e._v("\n          "+e._s(e.$t('m.treeinfo["添加额外提示说明"]'))+"\n        ")])],1)]),e._v(" "),e.formInfo.is_tips?[t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['字段释疑']"),required:!0,"ext-cls":"bk-mt20-item"}},[t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.formInfo.tips,expression:"formInfo.tips",modifiers:{trim:!0}}],staticClass:"bk-form-textarea bk-textarea-tanble bk-halfline-item bk-halfline-margin",attrs:{placeholder:e.$t("m.treeinfo['请输入，用于鼠标经过提示']")},domProps:{value:e.formInfo.tips},on:{change:function(t){return e.$emit("change")},input:function(t){t.target.composing||e.$set(e.formInfo,"tips",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),t("p",{staticClass:"bk-label-tips"},[t("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top",value:e.formInfo.tips||e.$t("m.treeinfo['字段释疑填填看哦']"),expression:"(formInfo.tips || $t(`m.treeinfo['字段释疑填填看哦']`))",modifiers:{top:!0}}]},[e._v("\n            "+e._s(e.$t('m.treeinfo["效果预览"]'))+"\n          ")])])])]:e._e(),e._v(" "),e.addOrigin.isOther&&"publicField"===e.addOrigin.addOriginInfo.type||!e.changeInfo.meta||"APPROVE_RESULT"===e.changeInfo.meta.code?e._e():[t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['是否设置字段隐藏条件']"),"ext-cls":"bk-mt20-item"}},[t("bk-switcher",{attrs:{size:"small",disabled:"title"===e.changeInfo.key},on:{change:function(t){return e.$emit("change")}},model:{value:e.formInfo.show_type,callback:function(t){e.$set(e.formInfo,"show_type",t)},expression:"formInfo.show_type"}})],1),e._v(" "),e.formInfo.show_type?[t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['隐藏条件']"),desc:e.$t("m.treeinfo['字段默认为显示。当满足以下配置条件时，该字段将会被隐藏。']"),"ext-cls":"bk-mt20-item"}},[t("hidden-conditions",{ref:"hiddenConditions",attrs:{"template-info":e.templateInfo,"template-stage":e.templateStage,"add-origin":e.addOrigin,workflow:e.workflow,state:e.state,"form-info":e.formInfo}})],1)]:e._e()]],2),e._v(" "),t("div",{staticClass:"operate-btns mt20"},[t("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"field_button_submit",title:e.$t("m.treeinfo['提交']"),loading:e.secondClick},on:{click:e.checkInfo}},[e._v("\n      "+e._s(e.$t("m.treeinfo['提交']"))+"\n    ")]),e._v(" "),t("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"field_button_cancel",title:e.$t("m.treeinfo['取消']"),disabled:e.secondClick},on:{click:e.onCancelClick}},[e._v("\n      "+e._s(e.$t("m.treeinfo['取消']"))+"\n    ")])],1)],1)},a=[];n._withStripped=!0},OzIr:function(e,t,i){},"P+p4":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("P2sY"),r=(n=a)&&n.__esModule?n:{default:n},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i("wsa1"));var o={language:"javascript",theme:"vs-dark",automaticLayout:!0,minimap:{enabled:!1},wordWrap:"on",wrappingIndent:"same"};t.default={name:"CodeEditor",props:{value:{type:String,default:""},options:{type:Object,default:function(){return{}}}},data:function(){return{editorOptions:(0,r.default)({},o,this.options,{value:this.value}),monacoInstance:null}},watch:{value:function(e){e!==this.monacoInstance.getValue()&&this.monacoInstance.setValue(e)},options:{deep:!0,handler:function(e){this.editorOptions=(0,r.default)({},o,e,{value:this.value}),this.updateOptions()}}},mounted:function(){this.initIntance()},beforeDestroy:function(){this.monacoInstance&&this.monacoInstance.dispose()},methods:{initIntance:function(){var e=this;this.monacoInstance=s.editor.create(this.$el,this.editorOptions);var t=this.monacoInstance.getModel();if(t.setEOL(0),this.value.indexOf("\r\n")>-1){var i=document.createElement("textarea");i.value=this.value,this.$emit("input",i.value)}t.onDidChangeContent((function(){var t=e.monacoInstance.getValue();e.$emit("input",t)})),this.monacoInstance.addCommand(s.KeyMod.CtrlCmd|s.KeyCode.KEY_S,(function(){var t=e.monacoInstance.getValue();e.$emit("saveContent",t)}))},updateOptions:function(){this.monacoInstance.updateOptions(this.editorOptions)}}}},P0kt:function(e,t,i){"use strict";i.r(t);var n=i("/5i8"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},P2aA:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"devops-preview",class:{"full-screen":e.isFullScreen}},[t("header",{staticClass:"devops-header"},[e.isFullScreen?t("span",{staticClass:"exit-full-screen",on:{click:function(t){return t.stopPropagation(),e.onCloseFullScreen.apply(null,arguments)}}},[t("i",{staticClass:"bk-itsm-icon icon-order-close"}),e._v(" "),t("span",{staticClass:"exit-text"},[e._v(e._s(e.$t("m.common['退出全屏']")))])]):t("i",{staticClass:"bk-itsm-icon icon-order-open",on:{click:function(t){return t.stopPropagation(),e.openFullScreen()}}})]),e._v(" "),t("section",{staticClass:"devops-preview-wrap"},[t("div",{staticClass:"devops-preview-body"},e._l(e.stages,(function(i,n){return t("div",{key:i.id,staticClass:"stage"},[t("span",{staticClass:"stage-connect-line"}),e._v(" "),t("h4",{staticClass:"stage-name"},[e._v(e._s(i.name))]),e._v(" "),e._l(i.containers,(function(a,r){return t("ul",{key:a.id,staticClass:"containers"},[0!==n?t("svg",{staticClass:"container-connect-line left",style:e.getSvgStyle(i,r),attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"60",height:0===r?70:56*(i.containers[r-1].elements.length+1)}},[t("path",{attrs:{d:e.getPath(i,r)}})]):e._e(),e._v(" "),t("svg",{staticClass:"container-connect-line",style:e.getSvgStyle(i,r),attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"60",height:0===r?70:56*(i.containers[r-1].elements.length+1)}},[t("path",{attrs:{d:e.getPath(i,r)}})]),e._v(" "),t("li",{staticClass:"element container-title"},[e._v("\n            "+e._s(a.name)+"\n            "),0!==n?t("span",{staticClass:"semicircle"}):e._e(),e._v(" "),0!==n?t("span",{staticClass:"triangle"}):e._e()]),e._v(" "),e._l(a.elements,(function(i){return t("li",{key:i.id,class:["element",{"not-execute":!e.isElementCanExecute(i)}]},[e._v("\n            "+e._s(i.name)+"\n          ")])}))],2)}))],2)})),0),e._v(" "),e.loading?t("div",{staticClass:"loading"},[t("i",{staticClass:"bk-itsm-icon icon-icon-loading"}),e._v(" "),t("span",[e._v(e._s(e.$t("m.tickets['预览正在加载中']")))])]):e._e()])])},a=[];n._withStripped=!0},PAo4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("QbLZ")),a=s(i("tQ05")),r=i("L2JU");function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"modifyFields",components:{fieldInfo:a.default},props:{fieldSchema:{type:Array,default:function(){return[]}}},data:function(){return{fieldKeyItem:"",fieldValueItem:"",fieldValue:"",show:!0,sourceTypeList:[{id:1,key:"custom",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"reference",name:this.$t('m.treeinfo["引用变量"]')}],variableList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,r.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.variableList=e}},mounted:function(){this.variableList=this.triggerVariables,this.initData()},methods:{initData:function(){var e=this;if(this.fieldSchema.forEach((function(t){e.$set(t,"referenceType",t.ref_type||"custom")})),this.fieldKeyItem=this.fieldSchema[0],this.fieldValueItem=this.fieldSchema[1],this.$set(this.fieldValueItem,"itemInfo",[]),this.fieldKeyItem.value){var t=this.fieldKeyItem.choice.filter((function(t){return t.key===e.fieldKeyItem.value}));t[0].val=this.fieldValueItem.value,t[0].value=t[0].val,this.fieldValueItem.itemInfo=t,this.show=!0}},selectedFieldKey:function(e){var t=this;this.fieldValueItem.itemInfo.splice(0,this.fieldValueItem.itemInfo.length),this.show=!1,this.$nextTick((function(){var i=t.fieldKeyItem.choice.find((function(t){return t.key===e}));i.showFeild=!0,t.fieldValueItem.itemInfo.push(i),t.show=!0}))},selectedReference:function(){this.fieldValueItem.itemInfo[0].value=""}}}},PGA1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("GQeE")),a=d(i("P2sY")),r=d(i("14Xm")),s=d(i("D3Ub")),o=d(i("I1Ty")),l=i("CeR/"),c=i("ygAv"),u=d(i("efIh")),f=d(i("PaSM"));function d(e){return e&&e.__esModule?e:{default:e}}t.default={name:"SOPS_TEMPLATE",components:{NoData:o.default},mixins:[u.default,f.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},basicInfomation:{type:Object,default:function(){return{}}},typeInfo:{type:String,default:function(){return""}},disabled:{type:Boolean,default:!1}},data:function(){return{disabledRenderForm:!1,editTask:!0,constantDefaultValue:{},templateList:[],planList:[],sopsTaskList:[],optionalNodeIdList:[],hookedVarList:{},quoteVars:[],quoteVarsLoading:!1,quoteErrors:[],configLoading:!1,formLoading:!1,loading:{templateList:!1,sopsTaskList:!1,plan:!1},lastEditTaskName:"",rules:{},previewSopsTaskUrl:""}},computed:{bkBizId:function(){return this.basicInfomation&&-1!==this.basicInfomation.bk_biz_id?this.basicInfomation.bk_biz_id:""},showRenderForm:function(){return this.item.sopsContent.constants.filter((function(e){return"show"===e.show_type})).length>0},formOptions:function(){return{showRequired:!0,showGroup:!0,showLabel:!0,showHook:!0,showDesc:!0,formEdit:!this.disabled&&!this.disabledRenderForm}}},created:function(){this.item.sopsContent||this.$set(this.item,"sopsContent",{id:"",sopsTask:{id:"",template_id:""},planId:"",createWay:"template",exclude_task_nodes_id:[],formData:{},context:{project:{id:"",bk_biz_id:"",name:"",from_cmdb:!0},bk_biz_id:"",site_url:window.SITE_URL_SOPS+window.PREFIX_SOPS},constants:[]}),this.rules.id=this.checkCommonRules("select").select,this.rules.sopsTaskId=this.checkCommonRules("select").select},mounted:function(){var e=this;return(0,s.default)(r.default.mark((function t(){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.item.value&&(e.item.sopsContent.id=e.item.value.id,(i=e.templateList.find((function(t){return t.id===e.item.sopsContent.id})))&&void 0!==i.bk_biz_id&&(e.item.sopsContent.context.project.bk_biz_id=i.bk_biz_id,e.item.sopsContent.context.project.id=e.item.sopsContent.id,e.item.sopsContent.context.project.name=e.item.name),e.item.sopsContent.constants=e.item.value.constants,e.item.value.constants.forEach((function(t){t.value&&(e.item.sopsContent.formData[t.key]=(0,c.deepClone)(t.value)),t.is_quoted&&(e.hookedVarList[t.key]=!0)}))),e.editTask=!!e.item.value,e.editTask&&e.item.value.id&&e.getTemplateDetail(e.item.value.bk_biz_id,e.item.value.id),e.basicInfomation.id&&e.getTicketOutput(),e.getTemplateList();case 5:case"end":return t.stop()}}),t,e)})))()},methods:{getTicketOutput:function(){var e=this;return(0,s.default)(r.default.mark((function t(){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.quoteVarsLoading=!0,t.next=4,e.$store.dispatch("ticket/getTicketOutput",e.basicInfomation.id);case 4:i=t.sent,e.quoteVars=i.data,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:return t.prev=11,e.quoteVarsLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,e,[[0,8,11,14]])})))()},onSelectTpl:function(e){var t=this;this.item.sopsContent.id=e;var i=this.templateList.find((function(e){return e.id===t.item.sopsContent.id}));i&&void 0!==i.bk_biz_id&&(this.item.sopsContent.context.project.bk_biz_id=i.bk_biz_id,this.item.sopsContent.context.project.id=i.project_id,this.item.sopsContent.context.project.name=i.project_name),this.hookedVarList={},this.quoteErrors=[],this.getTempaltePlanList(),this.getTemplateDetail(i.bk_biz_id,this.item.sopsContent.id)},onSopsTaskChange:function(e){if(!e)return!1;this.hookedVarList={},this.quoteErrors=[],this.setTaskNameAndDisable(e),this.getSopsTaskDetail(e)},setTaskNameAndDisable:function(e){var t=this.fields.find((function(e){return"task_name"===e.key})),i=this.sopsTaskList.find((function(t){return t.id===e}));t&&(this.lastEditTaskName=t.val||t.value,t.val=i.name,t.value=i.name,t.is_readonly=!0),this.disabledRenderForm="started_task"===this.item.sopsContent.createWay},clearTaskNameAndDisable:function(){if(this.item.sopsContent.sopsTask.id){var e=this.fields.find((function(e){return"task_name"===e.key}));e&&(e.val=this.lastEditTaskName,e.value=this.lastEditTaskName,e.is_readonly=!1)}},getSopsTaskDetail:function(e){var t=this;return(0,s.default)(r.default.mark((function i(){var n;return r.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.configLoading=!0,n={bk_biz_id:t.bkBizId,task_id:e},i.next=4,t.$store.dispatch("taskFlow/getSopsTaskDetail",n).then((function(e){t.previewSopsTaskUrl=e.data.task_url;var i=[];for(var n in e.data.constants)"show"===e.data.constants[n].show_type&&i.push(e.data.constants[n]);i.sort((function(e,t){return e-t})),t.item.sopsContent.constants=i,t.item.sopsContent.sopsTask.template_id=e.data.template_id})).catch((function(e){(0,l.errorHandler)(e,t)})).finally((function(){t.configLoading=!1}));case 4:case"end":return i.stop()}}),i,t)})))()},getTemplateDetail:function(e,t){var i=this;this.formLoading=!0;var n={template_id:t,bk_biz_id:e||""};this.$store.dispatch("getTemplateDetail",n).then((function(e){var t=[];e.data.constants.forEach((function(e){var n=i.item.sopsContent.constants.find((function(t){return t.key===e.key}));i.editTask&&!n||(n&&(e=(0,a.default)(n,e)),e.is_meta&&(e.meta=(0,c.deepClone)(e)),i.item.value&&(e.value=(0,c.deepClone)(i.item.sopsContent.formData[e.key])),i.constantDefaultValue[e.key]=(0,c.deepClone)(e.value),"show"===e.show_type&&t.push(e))})),i.item.sopsContent.constants=t,i.optionalNodeIdList=e.data.optional_ids})).catch((function(e){(0,l.errorHandler)(e,i)})).finally((function(){i.formLoading=!1}))},getTemplateList:function(){var e=this;return(0,s.default)(r.default.mark((function t(){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading.templateList=!0,i={bk_biz_id:e.bkBizId,with_common:!0},t.next=4,e.$store.dispatch("getTemplateList",i).then((function(t){e.templateList=t.data})).catch((function(t){(0,l.errorHandler)(t,e)})).finally((function(){e.loading.templateList=!1}));case 4:case"end":return t.stop()}}),t,e)})))()},getSopsTaskList:function(){var e=this;return(0,s.default)(r.default.mark((function t(){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading.sopsTaskList=!0,i={bk_biz_id:e.bkBizId,is_started:"started_task"===e.item.sopsContent.createWay},t.next=4,e.$store.dispatch("taskFlow/getSopsTask",i).then((function(t){e.sopsTaskList=t.data})).catch((function(t){(0,l.errorHandler)(t,e)})).finally((function(){e.loading.sopsTaskList=!1}));case 4:case"end":return t.stop()}}),t,e)})))()},getTempaltePlanList:function(){var e=this;return(0,s.default)(r.default.mark((function t(){var i,n,a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.item.sopsContent.id,n=e.templateList.find((function(e){return e.id===i})),e.planList=[],e.loading.plan=!0,a={bk_biz_id:n.bk_biz_id,template_id:n.id},t.next=7,e.$store.dispatch("getTemplatePlanList",a).then((function(t){e.planList=t.data})).catch((function(t){(0,l.errorHandler)(t,e)})).finally((function(){e.loading.plan=!1}));case 7:case"end":return t.stop()}}),t,e)})))()},onplanSelect:function(e){var t=this;return(0,s.default)(r.default.mark((function i(){var n,a,s,o,l;return r.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=[],e.length>0?(e.forEach((function(e){var i=t.planList.find((function(t){return t.id===e}));if(i.data)for(var a=JSON.parse(i.data),r=0;r<a.length;r++)-1===n.indexOf(a[r])&&n.push(a[r])})),t.item.sopsContent.exclude_task_nodes_id=t.optionalNodeIdList.filter((function(e){return!n.includes(e)}))):t.item.sopsContent.exclude_task_nodes_id=[],a=t.templateList.find((function(e){return e.id===t.item.sopsContent.id})),i.prev=3,t.formLoading=!0,i.next=7,t.$store.dispatch("taskFlow/getSopsPreview",{bk_biz_id:a.bk_biz_id,template_id:a.id,exclude_task_nodes_id:t.item.sopsContent.exclude_task_nodes_id});case 7:for(l in s=i.sent,o=[],s.data.pipeline_tree.constants)"show"===s.data.pipeline_tree.constants[l].show_type&&o.push(s.data.pipeline_tree.constants[l]);o.sort((function(e,t){return e.index-t.index})),t.item.sopsContent.constants=o,i.next=17;break;case 14:i.prev=14,i.t0=i.catch(3),console.error(i.t0);case 17:return i.prev=17,t.formLoading=!1,i.finish(17);case 20:case"end":return i.stop()}}),i,t,[[3,14,17,20]])})))()},jumpToSops:function(){window.open(this.previewSopsTaskUrl)},handleCreateWayChange:function(e){this.clearTaskNameAndDisable(),this.item.sopsContent.id="",this.item.sopsContent.planId="",this.item.sopsContent.constants=[],this.item.sopsContent.sopsTask.id="","task"===e||"started_task"===e?this.getSopsTaskList():this.getTemplateList()},onReloadPlanBtnClick:function(){this.item.sopsContent.id&&this.getTempaltePlanList()},validate:function(){var e=this;this.$refs.taskForm.validate();var t=!0;this.disabled||this.disabledRenderForm?t=!0:this.$refs.renderForm&&(t=this.$refs.renderForm.validate());var i="template"===this.item.sopsContent.createWay?!!this.item.sopsContent.id:!!this.item.sopsContent.sopsTask.id,a=(0,n.default)(this.hookedVarList).every((function(t){return!e.hookedVarList[t]||""!==e.item.sopsContent.formData[t]||(e.quoteErrors.push(t),!1)}));return t&&i&&a},jumpToSopsSelectSchemePage:function(){var e=this.item.sopsContent.id,t="taskflow/newtask/"+this.templateList.find((function(t){return t.id===e})).project_id+"/selectnode/?template_id="+e+"&entrance=templateEdit";window.open(window.SOPS_URL+t,"__blank")},onHookChange:function(e,t){this.$set(this.hookedVarList,t.tag_code,e);var i=this.item.sopsContent.constants.find((function(e){return e.key===t.tag_code}));if(i.is_quoted=e,e)this.item.sopsContent.formData[t.tag_code]="";else{this.item.sopsContent.formData[t.tag_code]=i?(0,c.deepClone)(this.constantDefaultValue[t.tag_code]):"";var n=this.quoteErrors.findIndex((function(e){return e===t.tag_code}));n>-1&&this.quoteErrors.splice(n,1)}},onSelectVar:function(e,t){this.item.sopsContent.formData[t.tag_code]="${"+e+"}";var i=this.quoteErrors.findIndex((function(e){return e===t.tag_code}));i>-1&&this.quoteErrors.splice(i,1)}}}},PLXv:function(e,t,i){},PRQd:function(e,t,i){"use strict";i.r(t);var n=i("65Fp"),a=i("f1Q0");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("xXNg");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"24384eed",null);t.default=o.exports},PSjz:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-response-content"},[t("div",{on:{click:function(t){e.item.contentStatus=!1}}},[t("bk-form",{ref:"conductorForm",attrs:{"form-type":"horizontal","label-width":200}},["api"===e.item.wayInfo.key?[t("api-call",{attrs:{item:e.item}})]:"modify_field"===e.item.wayInfo.key||"modify_first_state_field"===e.item.wayInfo.key?[t("modify-field",{attrs:{"field-schema":e.item.wayInfo.field_schema}})]:[e._l(e.item.wayInfo.field_schema,(function(e,i){return["SUBCOMPONENT"===e.type?[t("send-message",{key:i,attrs:{"item-info":e}})]:[t("bk-form-item",{key:i,attrs:{"ext-cls":e.required?"bk-field-schema mb20":"bk-field-schema no-require-item mb20",label:e.name,required:e.required,desc:e.tips}},[t("change-conductor",{attrs:{"item-info":e}})],1)]]}))],e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.trigger['执行方式']"),required:!0,"ext-cls":"bk-field-schema mb20"}},[t("bk-radio-group",{model:{value:e.item.performData.runMode,callback:function(t){e.$set(e.item.performData,"runMode",t)},expression:"item.performData.runMode"}},[t("bk-radio",{attrs:{value:"BACKEND","ext-cls":"mr50 pr10"}},[e._v(e._s(e.$t("m.trigger['后台自动执行']")))]),e._v(" "),e.isShowFrontendTrigger?t("bk-radio",{attrs:{value:"MANUAL"}},[e._v(e._s(e.$t("m.trigger['按钮触发']")))]):e._e()],1)],1),e._v(" "),"MANUAL"===e.item.performData.runMode?[t("bk-form-item",{attrs:{required:!0,label:e.$t("m.trigger['按钮名称']"),"ext-cls":"bk-field-schema mb20"}},[t("bk-input",{staticStyle:{width:"260px"},attrs:{clearable:!0},model:{value:e.item.performData.displayName,callback:function(t){e.$set(e.item.performData,"displayName",t)},expression:"item.performData.displayName"}})],1)]:e._e(),e._v(" "),t("bk-form-item",{attrs:{required:!0,label:e.$t("m.trigger['触发次数']"),"ext-cls":"bk-field-schema"}},[t("bk-radio-group",{model:{value:e.item.performData.repeat,callback:function(t){e.$set(e.item.performData,"repeat",t)},expression:"item.performData.repeat"}},[t("bk-radio",{attrs:{value:"one",disabled:e.disableRepeat,"ext-cls":"mr50 pr10"}},[e._v(e._s(e.$t("m.trigger['一次']")))]),e._v(" "),t("bk-radio",{attrs:{value:"more"}},[e._v(e._s(e.$t("m.trigger['不限']")))])],1)],1)],2),e._v(" "),e.item.contentStatus?t("p",{staticClass:"bk-error-info"},[e._v(e._s(e.$t("m.trigger['您还有内容未填写，请确认。']")))]):e._e()],1)])},a=[];n._withStripped=!0},Q3ZP:function(e,t,i){"use strict";i.r(t);var n=i("g2DR"),a=i("ymPp");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},R5iJ:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMDI0IDEwMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojNzM3OTg3O30KPC9zdHlsZT4KPGc+Cgk8cmVjdCB4PSI1MTIiIHk9IjIyNCIgY2xhc3M9InN0MCIgd2lkdGg9Ijk2IiBoZWlnaHQ9IjY0Ii8+Cgk8cmVjdCB4PSI0MTYiIHk9IjI4OCIgY2xhc3M9InN0MCIgd2lkdGg9Ijk2IiBoZWlnaHQ9IjY0Ii8+Cgk8cmVjdCB4PSI1MTIiIHk9IjM1MiIgY2xhc3M9InN0MCIgd2lkdGg9Ijk2IiBoZWlnaHQ9IjY0Ii8+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNDE2LDY0MGgxOTJWNDgwaC05NnYtNjRoLTk2VjY0MHogTTQ2NCw1MjhoOTZ2NjRoLTk2VjUyOHoiLz4KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik05Niw5NnY4MzJoODMyVjk2SDk2eiBNODY0LDg2NEgxNjBWMTYwaDI1NnY2NGg5NnYtNjRoMzUyVjg2NHoiLz4KPC9nPgo8L3N2Zz4K"},"RRc/":function(e,t,i){var n=i("oioR");e.exports=function(e,t){var i=[];return n(e,!1,i.push,i,t),i}},RnPO:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("2eEL"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"exportTree",components:{collapseTransition:r.default},props:{treeDataList:{type:Array,default:[]},treeIndex:{type:Number,default:0}},data:function(){return{pLeft:"padding-left:"+15*(this.treeIndex+1)+"px; padding-right: 10px;"}},methods:{toggleChildren:function(e){this.$emit("toggleChildren",e)},toggle:function(e){this.$emit("toggle",e)},selectItem:function(e){this.$emit("selectItem",e)}}}},SJYp:function(e,t,i){},SLTv:function(e,t,i){"use strict";i("1TTJ")},SO4U:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"CUSTOMTABLE",props:{item:{type:Object,required:!0,default:function(){}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{multiSelect:!0}},watch:{"item.val":function(){if(""===this.item.val){this.item.val=[];for(var e={},t=0;t<this.item.meta.columns.length;t++){e[this.item.meta.columns[t].key]=""}this.item.val.push(e)}"function"==typeof this.$parent.refresh&&this.$parent.refresh()}},created:function(){var e=this;if(""===this.item.val||Array.isArray(this.item.val)&&!this.item.val.length){this.item.val=[];for(var t={},i=0;i<this.item.meta.columns.length;i++){t[this.item.meta.columns[i].key]=""}this.item.val.push(t)}this.item.val.forEach((function(t){e.item.meta.columns.forEach((function(e){if(("multiselect"===e.display||"select"===e.display)&&!("string"==typeof t[e.key]?[t[e.key]]:t[e.key]).every((function(t){return e.choice.find((function(e){return e.key===t}))}))){var i=e.choice.find((function(i){return i.name===t[e.key]}));t[e.key]=i?i.key:""}}))}))},methods:{addOne:function(){for(var e={},t=0;t<this.item.meta.columns.length;t++){e[this.item.meta.columns[t].key]=""}this.item.val.push(e)},deleteOne:function(e){var t=this;1===this.item.val.length?this.$bkMessage({message:"默认行不能删除",theme:"warning"}):this.$bkInfo({title:"确认要删除此条数据？",confirmFn:function(){t.item.val.splice(e.$index,1)}})}}}},SUIt:function(e,t,i){"use strict";i.r(t);var n=i("MHZE"),a=i("gr+U");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("DtGf");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"3c746b04",null);t.default=o.exports},SioU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i("14Xm")),a=h(i("gDS+")),r=h(i("m1cH")),s=h(i("D3Ub")),o=h(i("2Vgw")),l=h(i("NGZu")),c=h(i("c6Q5")),u=h(i("hA3y")),f=h(i("FGMr")),d=h(i("VflG")),m=i("CeR/"),p=i("ygAv");function h(e){return e&&e.__esModule?e:{default:e}}t.default={name:"dataContent",components:{getParam:l.default,postParam:c.default,responseData:u.default,getRpcParam:f.default},mixins:[d.default],props:{formInfo:{type:Object,default:function(){return{}}},changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){return{}}},workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},apiInfo:{type:Object,default:function(){return{remote_system_id:"",remote_api_id:"",req_params:{},req_body:{},rsp_data:""}}},fieldInfo:{type:Object,default:function(){return{}}},kvRelation:{type:Object,default:function(){return{}}},prcTable:{type:Array,default:function(){return[]}}},data:function(){return{stateList:[],trueStatus:!0,falseStatus:!1,initDataContent:{}}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.getRelatedFields(),this.initDataContent=(0,p.deepClone)(this.apiDetail)},methods:{addDataLine:function(e,t){if(!this.changeInfo.meta||"APPROVE_RESULT"!==this.changeInfo.meta.code){this.fieldInfo.list.splice(t+1,0,{name:"",key:"",required:!1,nameCheck:!1,keyCheck:!1})}},deleteDataLine:function(e,t){1===this.fieldInfo.list.length||this.changeInfo.meta&&"APPROVE_RESULT"===this.changeInfo.meta.code||this.fieldInfo.list.splice(t,1)},closeError:function(){this.fieldInfo.list.forEach((function(e){e.nameCheck=!1,e.keyCheck=!1}))},getRelatedFields:function(){var e=this;if(this.state){var t={workflow:this.workflow,state:this.state,field:""};this.$store.dispatch("apiRemote/get_related_fields",t).then((function(t){e.stateList=t.data})).catch((function(t){(0,m.errorHandler)(t,e)})).finally((function(){}))}},countArrayAncestors:function(e){var t=[];return function e(i){"array"===i.parentInfo.type&&(t.push(i),e(i.parentInfo)),"object"===i.parentInfo.type&&e(i.parentInfo)}(e),t},listTojson:function(e){var t={};return e.length&&e.forEach((function(e){t[e.name]="CUSTOM"===e.source_type?e.value:"${params_"+e.value_key+"}"})),t},apiFz:function(){var e=this;return(0,s.default)(n.default.mark((function t(){var i,s,o,l,c,u,f,d,m,p,h,v,b;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$refs.getParam){t.next=4;break}t.t0={},t.next=7;break;case 4:return t.next=6,e.listTojson(e.$refs.getParam.paramTableData);case 6:t.t0=t.sent;case 7:if(e.apiInfo.req_params=t.t0,e.$refs.postParam){t.next=12;break}t.t1={},t.next=15;break;case 12:return t.next=14,e.treeToJson(e.$refs.postParam.bodyTableData.filter((function(e){return!e.level})));case 14:t.t1=t.sent;case 15:if(e.apiInfo.req_body=t.t1,i=!1,!e.$refs.getParam){t.next=25;break}if((s=e.$refs.getParam.paramTableData.filter((function(e){return e.is_necessary}))).forEach((function(e){e.isCheck=!0,e.isSatisfied="CUSTOM"===e.source_type?!!e.value:!!e.value_key})),!(o=s.filter((function(e){return!e.isSatisfied}))[0])){t.next=25;break}return e.$bkMessage({message:e.$t('m.treeinfo["请输入GET参数！"]'),theme:"error"}),i||(o.el.scrollIntoView(!0),i=!0),t.abrupt("return",!1);case 25:if(!e.$refs.postParam){t.next=34;break}if((l=e.$refs.postParam.bodyTableData.filter((function(e){return e.is_necessary&&"object"!==e.type&&"array"!==e.type}))).forEach((function(e){e.isCheck=!0,e.isSatisfied="CUSTOM"===e.source_type?e.value.toString():!!e.value_key})),!(c=l.filter((function(e){return!e.isSatisfied}))[0])){t.next=34;break}return e.$refs.postParam.bodyTableData.forEach((function(e){e.showChildren=!0,e.isShow=!0})),e.$bkMessage({message:e.$t('m.treeinfo["请输入POST参数！"]'),theme:"error"}),i||(c.el.scrollIntoView(!0),i=!0),t.abrupt("return",!1);case 34:if(e.$refs.responseData){t.next=37;break}return e.$bkMessage({message:e.$t('m.treeinfo["数据为空，请联系管理员"]'),theme:"error"}),t.abrupt("return",!1);case 37:if(u=e.$refs.responseData.responseTableData.filter((function(e){return e.isSelectedKey}))[0],f=e.$refs.responseData.responseTableData.filter((function(e){return e.isSelectedValue}))[0],u&&f){t.next=43;break}return e.$bkMessage({message:e.$t('m.treeinfo["请选择返回数据"]'),theme:"error"}),e.$refs.responseData.isCheck=!0,t.abrupt("return",!1);case 43:return d=[].concat((0,r.default)(JSON.parse((0,a.default)(u.ancestorsList))),[u.primaryKey]),m=[].concat((0,r.default)(JSON.parse((0,a.default)(f.ancestorsList))),[f.primaryKey]),t.next=47,e.countArrayAncestors(u);case 47:return p=t.sent,t.next=50,e.countArrayAncestors(f);case 50:if(h=t.sent,v=d.indexOf(p[0].primaryKey),b=m.indexOf(h[0].primaryKey),1===p.length&&1===h.length){t.next=55;break}return t.abrupt("return",!1);case 55:return e.apiInfo.rsp_data=d.slice(0,v).map((function(e){return e=e.replace(/^\d+\_/,"")})).join("."),e.kvRelation.key=d.slice(v+1).map((function(e){return e=e.replace(/^\d+\_/,"")})).join("."),e.kvRelation.name=m.slice(b+1).map((function(e){return e=e.replace(/^\d+\_/,"")})).join("."),t.abrupt("return",!0);case 59:case"end":return t.stop()}}),t,e)})))()},putChar:function(e,t){var i=this;e.key||(this.fieldInfo.list[t].key="",(0,o.default)(this.fieldInfo.list[t].name,{style:o.default.STYLE_NORMAL,heteronym:!1}).forEach((function(e){i.fieldInfo.list[t].key=""+i.fieldInfo.list[t].key+e})),this.fieldInfo.list[t].key=this.fieldInfo.list[t].key.toUpperCase(),this.fieldInfo.list[t].key=this.fieldInfo.list[t].key.replace(/\ /g,"_"),this.fieldInfo.list[t].key.length>=32&&(this.fieldInfo.list[t].key=this.fieldInfo.list[t].key.substr(0,32)))}}}},SqHb:function(e,t,i){},T2YI:function(e,t,i){"use strict";i.r(t);var n=i("o1/R"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},T3vI:function(e,t,i){"use strict";i.r(t);var n=i("VwbA"),a=i("VhbG");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("IcrL");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"2993b5be",null);t.default=o.exports},T6OW:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(i("14Xm")),a=u(i("D3Ub")),r=u(i("12KD")),s=u(i("u8Ap")),o=u(i("0hVY")),l=i("CeR/"),c=u(i("hztf"));function u(e){return e&&e.__esModule?e:{default:e}}t.default={name:"taskTemplate",components:{commonStep:r.default,memberSelect:s.default,Empty:c.default},mixins:[o.default],data:function(){return{infoStatus:!0,listError:!1,addStatus:!1,searchKey:"",stepList:[{id:1,name:this.$t("m.taskTemplate['创建任务配置']"),type:"primary",show:!0,is_draft:!1,stage:"CREATE",signal:""},{id:2,name:this.$t("m.taskTemplate['处理任务配置']"),type:"normal",show:!1,is_draft:!1,stage:"OPERATE",signal:""},{id:3,name:this.$t("m.taskTemplate['总结任务配置']"),type:"normal",show:!1,is_draft:!1,stage:"CONFIRM",signal:""}],templateInfo:{itemInfo:{},newNode:!1},templateList:[],listLoading:!1,addDialogInfo:{isShow:!1,title:this.$t("m.taskTemplate['新增任务模板']"),width:500},firstStepInfo:{name:"",ownersInputValue:[],desc:""},formRule:{name:[{required:!0,message:this.$t("m.taskTemplate['请输入任务名称']"),trigger:"blur"}]}}},computed:{sliderStatus:function(){return this.$store.state.common.slideStatus},globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){var e=this;return(0,a.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;return(0,a.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.stepList[0].signal="CREATE_TASK,DELETE_TASK",e.stepList[1].signal="BEFORE_START_TASK,AFTER_FINISH_TASK",e.stepList[2].signal="AFTER_CONFIRM_TASK",t.next=5,e.getTemplateList();case 5:case"end":return t.stop()}}),t,e)})))()},getTemplateList:function(){var e=this;return(0,a.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={name__icontains:e.searchKey},e.listLoading=!0,e.listError=!1,t.next=5,e.$store.dispatch("taskTemplate/getTemplateList",i).then((function(t){e.templateList=t.data})).catch((function(t){e.listError=!0,(0,l.errorHandler)(t,e)})).finally((function(){e.listLoading=!1}));case 5:case"end":return t.stop()}}),t,e)})))()},cloneTemplate:function(e){var t=this;if(this.hasPermission(["task_template_manage"],e.auth_actions))"SOPS"!==e.component_type&&this.$bkInfo({title:this.$t('m.taskTemplate["确定克隆该模板？"]'),confirmFn:function(){t.$store.dispatch("taskTemplate/cloneTemplate",e.id).then((function(){t.$bkMessage({message:t.$t("m.taskTemplate['克隆成功']"),theme:"success"})})).catch((function(e){(0,l.errorHandler)(e,t)})).finally((function(){t.getTemplateList()}))}});else{var i={task_template:[{id:e.id,name:e.name}]};this.applyForPermission(["task_template_manage"],e.auth_actions,i)}},deleteTemplate:function(e){var t=this;if(this.hasPermission(["task_template_manage"],e.auth_actions))e.is_builtin||this.$bkInfo({type:"warning",title:"确认删除数据？",subTitle:"数据如果被删除，此数据在流程中不可用。",confirmFn:function(){t.$store.dispatch("taskTemplate/deleteTemplate",e.id).then((function(){t.$bkMessage({message:t.$t("m.systemConfig['删除成功']"),theme:"success"})})).catch((function(e){(0,l.errorHandler)(e,t)})).finally((function(){t.getTemplateList()}))}});else{var i={task_template:[{id:e.id,name:e.name}]};this.applyForPermission(["task_template_manage"],e.auth_actions,i)}},editTemplate:function(e){if(this.hasPermission(["task_template_view"],e.auth_actions))this.changeStep(e);else{var t={task_template:[{id:e.id,name:e.name}]};this.applyForPermission(["task_template_view"],e.auth_actions,t)}},addTemplate:function(){this.hasPermission(["task_template_create"])?(this.firstStepInfo.desc="",this.firstStepInfo.name=this.firstStepInfo.desc,this.firstStepInfo.ownersInputValue=[],this.addDialogInfo.isShow=!0):this.applyForPermission(["task_template_create"],[],{})},clearSearch:function(){this.searchKey="",this.getTemplateList()},changeStep:function(e){this.templateInfo.itemInfo=e.id?e:{},this.addStatus=!this.addStatus;for(var t=0;t<this.stepList.length;t++)this.stepList[t].show=!1,this.stepList[t].is_draft=e.is_draft,this.stepList[t].type=e.is_draft?"normal":"success";this.stepList[0].show=!0,this.stepList[0].type="primary",this.changeTree(this.stepList[0],0)},changeTree:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"step";if("normal"!==e.type&&("primary"!==e.type||this.templateInfo.itemInfo.id)){for(var n="step"===i?t:this.stepList.length-1,a=0;a<=n;a++)this.stepList[a].show=!1,this.stepList[a].is_draft=e.is_draft,this.stepList[a].type="success";this.stepList[t].show=!0,this.stepList[t].type="primary"}},changeTemplateInfo:function(e){this.templateInfo.itemInfo=e},backTab:function(){this.changeStep({id:"",is_draft:!0}),this.getTemplateList()},saveTemplate:function(){var e=this;return(0,a.default)(n.default.mark((function t(){var i,a;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=!1,t.next=3,e.$refs.taskInfoForm.validate().then((function(){i=!0}),(function(){}));case 3:if(i){t.next=5;break}return t.abrupt("return");case 5:return a={name:e.firstStepInfo.name,component_type:"NORMAL",owners:e.firstStepInfo.ownersInputValue.join(","),is_draft:!0,desc:e.firstStepInfo.desc},t.next=8,e.$store.dispatch("taskTemplate/createNewTemplate",a).then((function(t){e.$bkMessage({message:e.$t("m.taskTemplate['保存成功']"),theme:"success"}),e.changeTemplateInfo(t.data),e.changeStep(e.templateInfo.itemInfo)})).catch((function(t){(0,l.errorHandler)(t,e)})).finally((function(){e.addDialogInfo.isShow=!1}));case 8:case"end":return t.stop()}}),t,e)})))()}}}},TDZ0:function(e,t,i){"use strict";i("zi6X")},TNjk:function(e,t,i){"use strict";i.r(t);var n=i("dm0o"),a=i("Gz9R");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},TOmV:function(e,t,i){"use strict";i.r(t);var n=i("Vj9y"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},TQwK:function(e,t,i){"use strict";i.r(t);var n=i("PSjz"),a=i("P0kt");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("Udb1");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"37bd3d27",null);t.default=o.exports},TlPd:function(e,t,i){},UA1S:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"child-node"},e._l(e.treeDataList,(function(i,n){return t("li",{key:n,staticClass:"vue-tree-item"},[t("div",{class:["tree-node",{down:i.showChildren,"set-frist-pLeft":e.treeIndex+1===1,active:i.checkInfo}],style:e.pLeft,on:{click:function(t){return e.toggle(i)}}},[i.showChildren?t("i",{staticClass:"bk-icon icon-down-shape",class:{"bk-padding":!i.has_children},on:{click:function(t){return t.stopPropagation(),e.toggleChildren(i)}}}):t("i",{staticClass:"bk-icon icon-right-shape",class:{"bk-padding":!i.has_children},on:{click:function(t){return t.stopPropagation(),e.toggleChildren(i)}}}),e._v(" "),t("i",{staticClass:"bk-icon icon-folder-open-shape"}),e._v(" "),t("span",{staticClass:"name-text",attrs:{title:i.name}},[e._v(e._s(i.name))]),e._v(" "),i.checkInfo?t("i",{staticClass:"bk-icon icon-check-1",staticStyle:{float:"right","margin-top":"11px"}}):e._e()]),e._v(" "),t("collapse-transition",[i.showChildren&&i.children?[t("Tree",{attrs:{"tree-data-list":i.children,"tree-index":e.treeIndex+1},on:{toggle:e.toggle,toggleChildren:e.toggleChildren}})]:e._e()],2)],1)})),0)},a=[];n._withStripped=!0},"UL6+":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{staticStyle:{"font-size":"0"},attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("rich-text-editor",{attrs:{"full-title":e.item.name,id:e.item.key,"is-preview":e.disabled},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},Udb1:function(e,t,i){"use strict";i("Bi2R")},UftK:function(e,t,i){},UljE:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"member-content"},[t("bk-select",{class:{"member-select":!0,"half-member-select":e.recipientItem.key},attrs:{searchable:""},on:{selected:e.getSecondLevelList},model:{value:e.recipientItem.key,callback:function(t){e.$set(e.recipientItem,"key",t)},expression:"recipientItem.key"}},e._l(e.recipientKeyList,(function(e){return t("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),"ORGANIZATION"!==e.recipientItem.key?["VARIABLE"===e.recipientItem.key?[t("bk-select",{staticStyle:{float:"left",width:"50%","margin-right":"6px"},attrs:{searchable:""},model:{value:e.recipientItem.value,callback:function(t){e.$set(e.recipientItem,"value",t)},expression:"recipientItem.value"}},e._l(e.variableList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:"PERSON"===e.recipientItem.key&&Array.isArray(e.recipientItem.value)?[t("member-select",{staticStyle:{float:"left",width:"50%","margin-right":"6px"},model:{value:e.recipientItem.value,callback:function(t){e.$set(e.recipientItem,"value",t)},expression:"recipientItem.value"}})]:"GENERAL"!==e.recipientItem.key&&"CMDB"!==e.recipientItem.key&&"IAM"!==e.recipientItem.key||!Array.isArray(e.recipientItem.value)?e._e():[t("bk-select",{staticStyle:{float:"left",width:"50%","margin-right":"6px"},attrs:{loading:e.recipientItem.isLoading,"show-select-all":"",multiple:"",searchable:""},model:{value:e.recipientItem.value,callback:function(t){e.$set(e.recipientItem,"value",t)},expression:"recipientItem.value"}},e._l(e.recipientItem.secondLevelList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]]:e._e(),e._v(" "),"ORGANIZATION"===e.recipientItem.key?[t("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeTree,expression:"closeTree"}],staticClass:"bk-search-tree",staticStyle:{float:"left",width:"50%","margin-right":"6px"}},[t("div",{staticClass:"bk-search-tree-wrapper",on:{click:function(t){return t.stopPropagation(),e.showTree("view")}}},[t("span",{class:{"bk-color-tree":e.roles.viewtree.name}},[e._v("\n          "+e._s(e.roles.viewtree.showName||e.$t('m.serviceConfig["请选择"]'))+"\n        ")]),e._v(" "),t("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]),e._v(" "),t("transition",{attrs:{name:"common-fade"}},[e.roles.viewTreeOpen?t("div",{staticClass:"bk-search-tree-content"},[t("export-tree",{attrs:{"tree-data-list":e.roles.viewTreeDataList},on:{toggle:e.toggleInfo,toggleChildren:function(t){return e.toggleChildren(...arguments,"view")}}})],1):e._e()])],1)]:e._e(),e._v(" "),"MULTI_MEMBERS"===e.itemInfo.type?t("div",{staticClass:"bk-between-operat"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:e.addRecipient}}),e._v(" "),t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.itemInfo.value.length},on:{click:e.deleteRecipient}})]):e._e()],2)},a=[];n._withStripped=!0},UsFA:function(e,t,i){"use strict";i.r(t);var n=i("XClk"),a=i("nVin");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("mOxC");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"27b534c8",null);t.default=o.exports},UyQ2:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-itsm-box"},[t("div",{staticClass:"is-title",class:{"bk-title-left":!e.sliderStatus}},[e.addStatus?[t("p",{staticClass:"bk-come-back",on:{click:e.backTab}},[t("arrows-left-icon"),e._v(" "),[e._v(e._s(e.templateInfo.itemInfo.name))]],2)]:[t("p",{staticClass:"bk-come-back"},[e._v("\n        "+e._s(e.$t("m['任务模板']"))+"\n      ")])]],2),e._v(" "),t("div",{staticClass:"itsm-page-content"},[e.addStatus?t("div",{staticClass:"step-wrap-content"},[t("div",{staticClass:"bk-itsm-tree"},[t("div",{staticClass:"bk-tree-content"},e._l(e.stepList,(function(i,n){return t("div",{key:i.id,staticClass:"bk-tree-first"},[t("div",{staticClass:"bk-tree-shadow",on:{click:function(t){return e.changeTree(i,n,"tree")}}},[t("span",{staticClass:"bk-tree-step",class:{"bk-tree-primary":"primary"===i.type,"bk-tree-success":"success"===i.type,"bk-tree-error":"error"===i.type}},["success"===i.type?t("i",{staticClass:"bk-icon icon-check-1"}):e._e(),e._v(" "),"error"===i.type?t("i",{staticClass:"bk-icon icon-close",staticStyle:{"font-size":"18px"}}):e._e(),e._v(" "),"success"!==i.type&&"error"!==i.type?t("span",[e._v(e._s(i.id))]):e._e()]),e._v(" "),t("span",{staticClass:"bk-tree-normal bk-tree-cursor",class:{"bk-tree-info":i.show||"normal"!==i.type}},[e._v(e._s(i.name))])]),e._v(" "),i.id!==e.stepList.length?t("span",{staticClass:"bk-tree-line"}):e._e()])})),0)]),e._v(" "),t("div",{staticClass:"bk-design-step"},[t("common-step",{attrs:{"template-info":e.templateInfo,step:e.stepList.findIndex(e=>e.show),"step-list":e.stepList}})],1)]):t("div",{staticClass:"add-status"},[t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.listLoading},expression:"{ isLoading: listLoading }"}],staticClass:"bk-itsm-service"},[e.infoStatus?t("div",{staticClass:"bk-itsm-version"},[t("i",{staticClass:"bk-icon icon-info-circle"}),e._v(" "),t("span",[e._v(e._s(e.$t("m.taskTemplate['任务模版：管理使用不同任务场景下的任务模板。当流程中开启任务模块时，可以设置适用的任务模板。任务处理人只需要按照任务模板进行任务处理即可。']"))+"\n          ")]),e._v(" "),t("i",{staticClass:"bk-icon icon-close",on:{click:function(t){e.infoStatus=!1}}})]):e._e(),e._v(" "),t("div",{staticClass:"bk-normal-search"},[t("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["task_template_create"])},expression:"{ active: !hasPermission(['task_template_create']) }"}],class:["mr10","plus-cus",{"btn-permission-disable":!e.hasPermission(["task_template_create"])}],attrs:{"data-test-id":"taskTemplate-button-create",theme:"primary",title:e.$t("m.systemConfig['新增']"),icon:"plus"},on:{click:e.addTemplate}},[e._v("\n            "+e._s(e.$t("m.systemConfig['新增']"))+"\n          ")]),e._v(" "),t("div",{staticClass:"bk-search-key"},[t("bk-input",{attrs:{"data-test-id":"taskTemplate-input-search",clearable:!0,"right-icon":"bk-icon icon-search"},on:{enter:e.getTemplateList,clear:e.clearSearch},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}})],1)],1),e._v(" "),t("div",{staticClass:"bk-task-content"},[0===e.templateList.length?t("p",{staticClass:"bk-none-content"},[t("Empty",{attrs:{"is-search":Boolean(e.searchKey),"is-error":e.listError},on:{onClearSearch:e.clearSearch}},[e.searchKey?e._e():t("template",{slot:"create"},[t("i",{staticClass:"bk-icon icon-info-circle"}),e._v(" "),t("span",[e._v(e._s(e.$t("m.taskTemplate['尚未创建任一任务模板，']")))]),e._v(" "),t("span",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!e.hasPermission(["task_template_create"])},expression:"{ active: !hasPermission(['task_template_create']) }"}],class:["bk-primary",{"text-permission-disable":!e.hasPermission(["task_template_create"])}],on:{click:e.addTemplate}},[e._v("\n                  "+e._s(e.$t("m.taskTemplate['立即创建']"))+"\n                ")])])],2)],1):t("ul",e._l(e.templateList,(function(i,n){return t("li",{key:n,on:{click:function(t){return e.editTemplate(i)}}},[t("span",{staticClass:"bk-task-icon"},[t("i",{staticClass:"bk-itsm-icon",class:"NORMAL"===i.component_type?"icon-itsm-icon-task":"icon-task-node"})]),e._v(" "),t("span",{staticClass:"bk-task-name",attrs:{title:i.name}},[t("span",{style:{maxWidth:i.is_draft?"calc(100% - 50px)":"100%"}},[e._v(e._s(i.name||"--"))]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:i.is_draft,expression:"item.is_draft"}]},[e._v(e._s(e.$t("m.taskTemplate['(草稿)']")))]),e._v(" "),t("span",[e._v(e._s(i.update_at||"--"))])]),e._v(" "),t("span",{staticClass:"bk-task-operate"},[t("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:"SOPS"===i.component_type?e.$t("m.taskTemplate['标准运维模板不可克隆']"):e.$t("m.taskTemplate['克隆模板']"),expression:"item.component_type === 'SOPS' ? $t(`m.taskTemplate['标准运维模板不可克隆']`) : $t(`m.taskTemplate['克隆模板']`)"}],staticClass:"bk-itsm-icon icon-itsm-icon-copy",class:{"icon-disable":"SOPS"===i.component_type},attrs:{"data-test-id":"taskTemplate-i-cloneTemplate"+n},on:{click:function(t){return t.stopPropagation(),e.cloneTemplate(i)}}}),e._v(" "),t("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:i.is_builtin?e.$t("m.taskTemplate['内置模板不可删除']"):e.$t("m.taskTemplate['删除模板']"),expression:"item.is_builtin ? $t(`m.taskTemplate['内置模板不可删除']`) : $t(`m.taskTemplate['删除模板']`)"}],staticClass:"bk-icon icon-delete",class:{"icon-disable":i.is_builtin},attrs:{"data-test-id":"taskTemplate-i-deleteTemplate"+n},on:{click:function(t){return t.stopPropagation(),e.deleteTemplate(i)}}})])])})),0)])])])]),e._v(" "),t("bk-dialog",{attrs:{"data-test-id":"taskTemplate-dialog-taskCreate",title:e.addDialogInfo.title,"auto-close":!1,"mask-close":!1,"render-directive":"if","header-position":"left",width:e.addDialogInfo.width,"ok-text":e.$t("m.taskTemplate['进入配置']")},on:{confirm:e.saveTemplate},model:{value:e.addDialogInfo.isShow,callback:function(t){e.$set(e.addDialogInfo,"isShow",t)},expression:"addDialogInfo.isShow"}},[t("bk-form",{ref:"taskInfoForm",attrs:{"label-width":150,model:e.firstStepInfo,rules:e.formRule,"form-type":"vertical"}},[t("bk-form-item",{attrs:{"data-test-id":"taskTemplate-dialog-taskTemplateName",label:e.$t("m.taskTemplate['任务模板名称']"),required:!0,property:"name","ext-cls":"bk-form-width"}},[t("bk-input",{attrs:{maxlength:"120"},model:{value:e.firstStepInfo.name,callback:function(t){e.$set(e.firstStepInfo,"name",t)},expression:"firstStepInfo.name"}})],1),e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.user['负责人：']")}},[t("member-select",{model:{value:e.firstStepInfo.ownersInputValue,callback:function(t){e.$set(e.firstStepInfo,"ownersInputValue",t)},expression:"firstStepInfo.ownersInputValue"}})],1),e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.taskTemplate['任务描述']"),"ext-cls":"bk-form-width"}},[t("bk-input",{attrs:{placeholder:e.$t("m.taskTemplate['请输入任务描述']"),type:"textarea",rows:3,maxlength:100},model:{value:e.firstStepInfo.desc,callback:function(t){e.$set(e.firstStepInfo,"desc",t)},expression:"firstStepInfo.desc"}})],1)],1)],1)],1)},a=[];n._withStripped=!0},"V+O7":function(e,t,i){i("aPfg")("Set")},V7Et:function(e,t,i){var n=i("2GTP"),a=i("M1xp"),r=i("JB68"),s=i("tEej"),o=i("v6xn");e.exports=function(e,t){var i=1==e,l=2==e,c=3==e,u=4==e,f=6==e,d=5==e||f,m=t||o;return function(t,o,p){for(var h,v,b=r(t),g=a(b),k=n(o,p,3),_=s(g.length),y=0,I=i?m(t,_):l?m(t,0):void 0;_>y;y++)if((d||y in g)&&(v=k(h=g[y],y,b),e))if(i)I[y]=v;else if(v)switch(e){case 3:return!0;case 5:return h;case 6:return y;case 2:I.push(h)}else if(u)return!1;return f?-1:c||u?u:I}}},VflG:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("m1cH")),a=l(i("P2sY")),r=l(i("GQeE")),s=i("Zw8t"),o=i("ygAv");function l(e){return e&&e.__esModule?e:{default:e}}t.default={props:{},data:function(){},created:function(){},watch:{},methods:{jsonschemaToList:function(e){var t=[],i=function e(t,i,n,a,s){var o={showChildren:!0,checkInfo:!1,key:i,type:n.type||"",desc:n.description.toString(),default:void 0!==n.default&&n.default.toString()?n.default:"",is_necessary:!a||!!s&&!!s.length&&-1!==s.indexOf(i),children:[],value:void 0!==n.default?n.default:""};if("object"===o.type&&(o.has_children=!(!n.properties||!(0,r.default)(n.properties).length)),"array"===o.type&&(o.has_children=n.items,o.showChildren=!0),t.push(o),"object"===o.type)for(var l in n.properties)e(o.children,l,n.properties[l],1,n.required||[]);"array"===o.type&&n.items&&e(o.children,"items",n.items,1,n.required||[])};for(var n in e)i(t,n,e[n],0,["root"]);return t},listToJsonschema:function(e,t){var i={},n=function e(i,n,r,s){if(n.key&&n.type){var o={};if(o[n.key]={type:n.type,description:n.desc.toString(),required:n.children&&n.children.length?n.children.filter((function(e){return e.is_necessary})).map((function(e){return e.key})):[]},o[n.key].required.length||delete o[n.key].required,r||(o[n.key].$schema="http://json-schema.org/draft-04/schema#"),"array"===n.type){if(n.children.length&&(o[n.key].items={}),"array"===s)for(var l in(0,a.default)(i,o[n.key]),n.children)e(i.items,n.children[l],1,"array");if("object"===s)for(var c in(0,a.default)(i,o),n.children)e(i[n.key].items,n.children[c],1,"array")}else if("object"===n.type){if(o[n.key].properties={},"array"===s)for(var u in(0,a.default)(i,o[n.key]),n.children)e(i.properties,n.children[u],1,"object");if("object"===s)for(var f in(0,a.default)(i,o),n.children)e(i[n.key].properties,n.children[f],1,"object")}else void 0!==n.default&&n.default.toString()&&("number"===n.type&&(n.default=Number(n.default)),"boolean"===n.type&&(n.default=!!n.default),"string"===n.type&&(n.default=n.default.toString())),o[n.key].default=n.default.toString()?n.default:"",void 0!==n.default_temp&&n.default_temp.toString()&&("number"===n.type&&(n.default_temp=Number(n.default_temp)),"boolean"===n.type&&(n.default_temp=!!n.default_temp),"string"===n.type&&(n.default_temp=n.default_temp.toString())),"update"===t&&(o[n.key].default=n.default_temp.toString()?n.default_temp:""),"array"===s&&(0,a.default)(i,o[n.key]),"object"===s&&(0,a.default)(i,o)}};for(var r in e)n(i,e[r],0,"object");return i},jsonschemaToJson:function(e){var t={},i=function e(t,i,n,r,s){var o={};if("object"===n.type){if(o[i]={},"object"===s)for(var l in(0,a.default)(t,o),n.properties)e(t[i],l,n.properties[l],1,"object");else if("array"===s)for(var c in t.push(o[i]),n.properties)e(t[0],c,n.properties[c],1,"object")}else if("array"===n.type)o[i]=[],"object"===s?((0,a.default)(t,o),n.children&&n.children.length&&e(t[i],"items",n.items,1,"array")):"array"===s&&(t.push(o[i]),n.children&&n.children.length&&e(t[0],i,n.items,1,"array"));else{switch(n.type){case"boolean":o[i]=!!n.default;break;case"number":o[i]=Number(n.default);break;case"string":o[i]=n.default.toString()||""}"object"===s?(0,a.default)(t,o):"array"===s&&t.push(o[i])}};for(var n in e)i(t,n,e[n],0,"object");return t},jsonToJsonschema:function(e){var t={root:{$schema:"http://json-schema.org/draft-04/schema#",type:"object",description:this.$t('m.systemConfig["初始化数据"]'),required:[],properties:{}}},i=function e(t,i,n,s,o){if(n&&null!=s){"array"!==t.type&&t.required.push(n);var l={};if(l[n]={type:s.constructor.name.toLowerCase(),description:"",required:[]},"array"===s.constructor.name.toLowerCase()){if(s.length&&(l[n].items={}),"array"===o)for(var c in(0,a.default)(i,l[n]),s)e(i,i.items,"items",s[c],"array");if("object"===o)for(var u in(0,a.default)(i,l),s)e(i[n],i[n].items,"items",s[u],"array")}else if("object"===s.constructor.name.toLowerCase()){if(l[n].properties={},"array"===o)for(var f in(0,a.default)(i,l[n]),s)e(i,i.properties,f,s[f],"object");if("object"===o&&((0,a.default)(i,l),(0,r.default)(s).length))for(var d in s)e(i[n],i[n].properties,d,s[d],"object")}else void 0!==s&&s.toString()&&("number"===s.constructor.name.toLowerCase()&&(s=Number(s)),"boolean"===s.constructor.name.toLowerCase()&&(s=!!s),"string"===s.constructor.name.toLowerCase()&&(s=s.toString())),l[n].default=s,"array"===o&&(0,a.default)(i,l[n]),"object"===o&&(0,a.default)(i,l)}};for(var n in e)i(t.root,t.root.properties,n,e[n],"object");return t},treeToTableList:function(e,t,i,a,r){var s=[];return function e(t,i,a,r,s,o){for(var l=0;l<i.length;l++){i[l].lastType=s,i[l].level=a,i[l].isShow=!0,i[l].showChildren=!0,i[l].primaryKey=a+"_"+i[l].key,"array"===s&&(i[l].primaryKey+="_"+l),i[l].parentPrimaryKey=r,i[l].ancestorsList=o;var c=[].concat((0,n.default)(o),[i[l].primaryKey]);i[l].ancestorsList_str=c.toString(),t.push(i[l]),i[l].children&&i[l].children.length&&e(t,i[l].children,a+1,i[l].primaryKey,i[l].type,c)}}(s,e,t||0,i||"",a||"object",r&&r.length?r:[]),s},treeToJson:function(e){var t={},i=function e(t,i,n,r){if(i.key)if("array"===i.type){if("array"===r)for(var s in t.push([]),i.children)e(t[t.length-1],i.children[s],1,"array");if("object"===r){var o={};for(var l in o[i.key]=[],(0,a.default)(t,o),i.children)e(t[i.key],i.children[l],1,"array")}}else if("object"===i.type){var c={};if("array"===r)for(var u in t.push(c),i.children)e(t[t.length-1],i.children[u],1,"object");if("object"===r)for(var f in c[i.key]={},(0,a.default)(t,c),i.children)e(t[i.key],i.children[f],1,"object")}else{if("number"===i.type&&(i.value=Number(i.value)),"array"===r){var d="CUSTOM"===i.source_type?i.value:"${params_"+i.value_key+"}";t.push(d)}if("object"===r){var m={};m[i.key]="CUSTOM"===i.source_type?i.value:"${params_"+i.value_key+"}",(0,a.default)(t,m)}}};for(var n in e)i(t,e[n],0,"object");return t},jsonValueToTree:function(e,t){var i=(0,o.deepClone)(t),n=function e(t,i,n,r){var l=(0,s.checkDataType)(n);if("object"===r){var c=t.find((function(e){return e.key===i}));if(!c)return;if("Array"===l){if(!c.children||!c.children.length)return;for(var u=(0,a.default)({parentInfo:""},c.children[0]),f=1;f<n.length;f++)c.children.push((0,o.deepClone)(u));for(var d in n)e(c.children[d],"items",n[d],"array")}else if("Object"===l)for(var m in n)e(c.children,m,n[m],"object");else/^\$\{params_.*\}$/.test(n)?(c.source_type="FIELDS",c.value_key=n?(0,o.deepClone)(n).replace(/^\$\{params_/,"").replace(/\}$/,""):"",c.value=void 0!==n&&n.toString()?(0,o.deepClone)(n):""):(c.source_type="CUSTOM",c.value=void 0!==n&&n.toString()?(0,o.deepClone)(n):"",c.value_key="",c.default_temp=c.value)}else if("array"===r)if("Array"===l){var p=t.find((function(e){return e.key===i}));if(!p)return;if(!p.children||!p.children.length)return;for(var h=t.children[0],v=1;v<n.length;v++)t.children.push((0,o.deepClone)(h));for(var b in n)e(t.children[b],"items",n[b],"array")}else if("Object"===l)for(var g in n)e(t.children,g,n[g],"object");else/^\$\{params_.*\}$/.test(n)?(t.source_type="FIELDS",t.value_key=n?(0,o.deepClone)(n).replace(/^\$\{params_/,"").replace(/\}$/,""):""):(t.source_type="CUSTOM",t.value=void 0!==n&&n.toString()?(0,o.deepClone)(n):"",t.default_temp=t.value)};for(var r in e)n(i[0].children,r,e[r],"object");return i}}}},VhbG:function(e,t,i){"use strict";i.r(t);var n=i("/9eO"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},Vj9y:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("m1cH")),a=d(i("P2sY")),r=d(i("14Xm")),s=d(i("gDS+")),o=d(i("D3Ub")),l=d(i("QbLZ")),c=d(i("VflG")),u=i("ygAv"),f=i("L2JU");function d(e){return e&&e.__esModule?e:{default:e}}t.default={name:"inputParams",mixins:[c.default],props:{itemInfo:{type:Object,default:function(){return{}}}},data:function(){return{sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],variableList:[]}},computed:(0,l.default)({paramTableData:function(){return this.itemInfo.apiContent.bodyTableData.filter((function(e){return e.isShow}))},globalChoise:function(){return this.$store.state.common.configurInfo}},(0,f.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.variableList=e}},created:function(){this.initData()},mounted:function(){this.variableList=this.triggerVariables},methods:{initData:function(){var e=this;return(0,o.default)(r.default.mark((function t(){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$set(e.itemInfo.apiContent,"treeDataList",{}),t.next=3,e.jsonschemaToList({root:JSON.parse((0,s.default)(e.itemInfo.apiContent.req_body))});case 3:return e.itemInfo.apiContent.treeDataList=t.sent,e.itemInfo.value&&(e.itemInfo.apiContent.treeDataList=e.jsonValueTreeList(e.itemInfo.value,JSON.parse((0,s.default)(e.itemInfo.apiContent.treeDataList)))),t.next=7,e.treeToTableList(JSON.parse((0,s.default)(e.itemInfo.apiContent.treeDataList[0].children)));case 7:return e.itemInfo.apiContent.bodyTableData=t.sent,(i=JSON.parse((0,s.default)(e.itemInfo.apiContent.bodyTableData))).forEach((function(e){e.name=e.key||"",e.children=[],e.source_type=e.source_type||"CUSTOM",e.value=void 0!==e.value?e.value:"",e.value_key=void 0!==e.value_key&&e.value_key.toString()?e.value_key:""})),e.recordChildren(i),t.next=13,i;case 13:e.itemInfo.apiContent.bodyTableData=t.sent;case 14:case"end":return t.stop()}}),t,e)})))()},jsonValueTreeList:function(e,t){var i=function e(t,i,n,r,o){if("object"===o){var l=i.filter((function(e){return e.key===n}));if(!l.length)return;if("array"===r.constructor.name.toLowerCase()){if(!l[0].children||!l[0].children.length)return;for(var c=JSON.parse((0,s.default)((0,a.default)({parentInfo:""},l[0].children[0]))),f=1;f<r.length;f++)l[0].children.push((0,u.deepClone)(c));for(var d in r)e(l[0].children,l[0].children[d],"items",r[d],"array")}else if("object"===r.constructor.name.toLowerCase())if(r.ref_type)"reference"===r.ref_type?(l[0].source_type="FIELDS",l[0].value_key=r.value,l[0].value=r.value):(l[0].source_type="CUSTOM",l[0].value=r.value,l[0].value_key="",l[0].default_temp=l[0].value);else for(var m in r)e(l[0],l[0].children,m,r[m],"object");else"reference"===r.ref_type?(l[0].source_type="FIELDS",l[0].value_key=r.value,l[0].value=r.value):(l[0].source_type="CUSTOM",l[0].value=r.value,l[0].value_key="",l[0].default_temp=l[0].value)}else if("array"===o)if("array"===r.constructor.name.toLowerCase()){var p=i.filter((function(e){return e.key===n}));if(!p.length)return;if(!p[0].children||!p[0].children.length)return;for(var h=JSON.parse((0,s.default)(i.children[0])),v=1;v<r.length;v++)i.children.push(h);for(var b in r)e(i.children,i.children[b],"items",r[b],"array")}else if("object"===r.constructor.name.toLowerCase())if(r.ref_type)"reference"===r.ref_type?(i.source_type="FIELDS",i.value_key=r.value):(i.source_type="CUSTOM",i.value=r.value,i.default_temp=i.value);else for(var g in r)e(i,i.children,g,r[g],"object");else"reference"===r.ref_type?(i.source_type="FIELDS",i.value_key=r.value):(i.source_type="CUSTOM",i.value=r.value,i.default_temp=i.value)};for(var n in e)i(t[0],t[0].children,n,e[n],"object");return t},recordChildren:function(e,t){for(var i=e.map((function(e){return e.level})),a=Math.max.apply(Math,(0,n.default)(i)),r=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0].children.push(t)}(e,t)}))},s=a;s>(t||0);s--)r(s)},changeState:function(e){e.showChildren=!e.showChildren,e.children.forEach((function(t){t.isShow=e.showChildren})),e.showChildren||this.closeChildren(e)},closeChildren:function(e){var t=this;e.children.forEach((function(e){e.isShow=!1,e.has_children&&(e.showChildren=!1,t.closeChildren(e))}))},countSon:function(e){return 1===this.itemInfo.apiContent.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey&&t.ancestorsList.toString()===e.ancestorsList.slice(0,-1).toString()}))[0].children.length},countChildren:function(e){var t=this;return(0,o.default)(r.default.mark((function i(){var n,a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,a=function e(t){if(t.children&&t.children.length)for(var i=0;i<t.children.length;i++)n+=1,e(t.children[i])},t.next=4,a(e);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),i,t)})))()},cleanValue:function(e){var t=this;return(0,o.default)(r.default.mark((function i(){var n,a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse((0,s.default)(e)),a=function e(t){if(t.value="",t.source_type="CUSTOM",t.children&&t.children.length)for(var i=0;i<t.children.length;i++)e(t.children[i])},t.next=4,a(n);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),i,t)})))()},addChildren:function(e){var t=this;return(0,o.default)(r.default.mark((function i(){var a,o,l,c,u,f;return r.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=t.itemInfo.apiContent.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey&&t.ancestorsList.toString()===e.ancestorsList.slice(0,-1).toString()}))[0],l=t.itemInfo.apiContent.bodyTableData.indexOf(o)+1,i.next=4,t.countChildren(o);case 4:return c=i.sent,i.next=7,t.cleanValue(o.children[0]);case 7:return u=i.sent,i.next=10,t.treeToTableList(JSON.parse((0,s.default)([].concat((0,n.default)(o.children),[u]))),o.level+1,o.primaryKey,"array",o.ancestorsList);case 10:return f=i.sent,i.next=13,f.forEach((function(e){e.children=[]}));case 13:return o.children=f.filter((function(e){return e.level===o.level+1})),i.next=16,t.recordChildren(f,o.level+1);case 16:(a=t.itemInfo.apiContent.bodyTableData).splice.apply(a,[l,c].concat((0,n.default)(f)));case 17:case"end":return i.stop()}}),i,t)})))()},deletChildren:function(e){var t=this;return(0,o.default)(r.default.mark((function i(){var n,a,s;return r.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.countSon(e)){i.next=2;break}return i.abrupt("return");case 2:if(!((n=t.itemInfo.apiContent.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey&&t.ancestorsList.toString()===e.ancestorsList.slice(0,-1).toString()}))[0].children).length<=1)){i.next=5;break}return i.abrupt("return");case 5:return n.splice(n.indexOf(e),1),a=t.itemInfo.apiContent.bodyTableData.indexOf(e),i.next=9,t.countChildren(e);case 9:s=i.sent,t.itemInfo.apiContent.bodyTableData.splice(a,s+1);case 11:case"end":return i.stop()}}),i,t)})))()}}}},VrAx:function(e,t,i){"use strict";i.r(t);var n=i("sHh5"),a=i("3jvg");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("XEYe");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"5ecc5a94",null);t.default=o.exports},VtRw:function(e,t,i){"use strict";i.r(t);var n=i("MI7q"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"Vv2+":function(e,t,i){"use strict";i.r(t);var n=i("fOTe"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},VwbA:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-api-call"},[e._l(e.item.wayInfo.field_schema,(function(i,n){return[t("bk-form-item",{key:n,attrs:{"ext-cls":"bk-field-schema mb20",label:i.name,required:i.required,desc:i.tips}},["api_source"===i.key?[t("bk-select",{attrs:{"ext-cls":"bk-form-display",clearable:!1,placeholder:e.$t("m.treeinfo['请选择接入系统']"),searchable:""},on:{selected:function(t){return e.changeCode(...arguments,i)}},model:{value:i.systemId,callback:function(t){e.$set(i,"systemId",t)},expression:"itemInfo.systemId"}},e._l(e.apiSysList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),i.systemId?[t("bk-select",{attrs:{"ext-cls":"bk-form-display",clearable:!1,searchable:""},on:{selected:function(t){return e.changeApi(...arguments,i)}},model:{value:i.apiId,callback:function(t){e.$set(i,"apiId",t)},expression:"itemInfo.apiId"}},e._l(e.apiList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]:e._e()]:e._e(),e._v(" "),"API_INFO"===i.type&&e.apiId?[t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],staticStyle:{"min-height":"100px"}},[e.isLoading?e._e():t("input-params",{attrs:{"item-info":i}})],1)]:e._e()],2)]}))],2)},a=[];n._withStripped=!0},"W3y+":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8yIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMDI0IDEwMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojYzNjZGQ3O30KPC9zdHlsZT4KPGcgaWQ9IuS4iuS8oCI+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNODk3LDQyMi45Yy0yOC40LTI4LjQtNjMuMy00Ny44LTEwMS4zLTU3Yy0xMC4xLTU3LjktMzcuNi0xMTEuMi04MC0xNTMuNkM2NjEuMywxNTgsNTg4LjksMTI4LDUxMiwxMjgKCQlzLTE0OS4zLDMwLTIwMy42LDg0LjRjLTQyLjQsNDIuNC02OS45LDk1LjctODAsMTUzLjZjLTM4LjEsOS4yLTczLDI4LjYtMTAxLjMsNTdjLTQwLjYsNDAuNi02Myw5NC42LTYzLDE1MnYxMAoJCWMwLDU3LjQsMjIuNCwxMTEuNCw2MywxNTJzOTQuNiw2MywxNTIsNjNoNDF2LTY0aC00MWMtODMuMywwLTE1MS02Ny43LTE1MS0xNTF2LTEwYzAtODMuMyw2Ny43LTE1MSwxNTEtMTUxaDkuMgoJCWMtMC4xLTIuNi0wLjItNS4zLTAuMi03LjlsMCwwbDAsMGMwLTEuNywwLTMuMywwLjEtNC45YzAtMC40LDAtMC44LDAtMS4zYzAtMS42LDAuMS0zLjIsMC4yLTQuN2MwLTAuNCwwLTAuNywwLjEtMS4xCgkJYzAuMS0xLjIsMC4xLTIuNSwwLjItMy43YzAtMC42LDAuMS0xLjIsMC4xLTEuOGMwLjEtMS40LDAuMi0yLjcsMC4zLTQuMWMwLjEtMC44LDAuMi0xLjYsMC4zLTIuNWMwLjEtMC42LDAuMS0xLjIsMC4yLTEuOQoJCWMxLjItMTAuMywzLjEtMjAuNCw1LjYtMzAuMmwwLDBjOS44LTM4LjQsMjkuOC03My42LDU4LjYtMTAyLjNDMzk1LjksMjE1LjMsNDUyLjIsMTkyLDUxMiwxOTJzMTE2LjEsMjMuMywxNTguNCw2NS42CgkJYzI4LjcsMjguNyw0OC43LDYzLjksNTguNiwxMDIuM2wwLDBjMi41LDkuOCw0LjQsMTkuOSw1LjYsMzAuMmMwLjEsMC42LDAuMSwxLjIsMC4yLDEuOWMwLjEsMC44LDAuMiwxLjYsMC4zLDIuNQoJCWMwLjEsMS40LDAuMiwyLjcsMC4zLDQuMWMwLDAuNiwwLjEsMS4yLDAuMSwxLjhjMC4xLDEuMiwwLjIsMi41LDAuMiwzLjdjMCwwLjQsMCwwLjcsMC4xLDEuMWMwLjEsMS42LDAuMSwzLjIsMC4yLDQuNwoJCWMwLDAuNCwwLDAuOCwwLDEuM2MwLDEuNiwwLjEsMy4zLDAuMSw0LjlsMCwwbDAsMGMwLDIuNy0wLjEsNS4zLTAuMiw3LjloOS4yYzgzLjMsMCwxNTEsNjcuNywxNTEsMTUxdjEwYzAsODMuMy02Ny43LDE1MS0xNTEsMTUxCgkJaC00MXY2NGg0MWM1Ny40LDAsMTExLjQtMjIuNCwxNTItNjNzNjMtOTQuNiw2My0xNTJ2LTEwQzk2MCw1MTcuNSw5MzcuNiw0NjMuNSw4OTcsNDIyLjl6Ii8+Cgk8cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjM3Ni4yLDYwMi45IDQyMS41LDY0OC4xIDQ4MCw1ODkuNiA0ODAsODk2IDU0NCw4OTYgNTQ0LDU4OS42IDYwMi41LDY0OC4xIDY0Ny44LDYwMi45IDUxMiw0NjcuMSAJIi8+CjwvZz4KPC9zdmc+Cgo="},WOBF:function(e,t,i){"use strict";i("utoA")},WP3n:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("CeR/"),r=i("BWJp"),s=(n=r)&&n.__esModule?n:{default:n};t.default={name:"hiddenConditions",mixins:[s.default],props:{workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},formInfo:{type:Object,default:function(){return{}}},templateStage:{type:String,default:""},templateInfo:{type:Object,default:function(){return{}}},addOrigin:{type:Object,default:function(){return{isOther:!1,addOriginInfo:{}}}}},data:function(){return{isLoading:!1,listInfo:[],conditionType:"and",fieldList:[],checkStatus:!1}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.getFrontNodesList()},methods:{getFrontNodesList:function(){var e=this;if(this.state||this.templateInfo.id){var t="",i={};this.state&&(t="apiRemote/get_related_fields",i.workflow=this.workflow,i.state=this.state),this.templateInfo.id&&(t="taskTemplate/getFrontFieldsList",i.id=this.templateInfo.id,i.stage=this.templateStage),this.isLoading=!0,this.$store.dispatch(t,i).then((function(t){e.frontNodesList=t.data,e.initData()})).catch((function(t){(0,a.errorHandler)(t,e)})).finally((function(){e.isLoading=!1}))}},initData:function(){var e=this;this.listInfo=[],this.formInfo.show_conditions.expressions&&this.formInfo.show_conditions.expressions.length?(this.formInfo.show_conditions.expressions.forEach((function(t){e.frontNodesList.forEach((function(i){if(i.key===t.key){var n="MULTISELECT"===i.type||"CHECKBOX"===i.type||"MEMBERS"===i.type||"TREESELECT"===i.type,a=e.checkBetweenList(i.type);e.listInfo.push({condition:t.condition,key:t.key,value:n?t.value.split(","):t.value,choiceList:i.choice,type:t.type,multiSelect:n,betweenList:a})}}))})),this.conditionType=this.formInfo.show_conditions.type):(this.listInfo=[{condition:"",key:"",value:"",choiceList:"",type:"STRING",multiSelect:!1,betweenList:this.checkBetweenList("STRING")}],this.conditionType="and"),this.fieldList=[],this.frontNodesList.forEach((function(t){t.key===e.formInfo.key||["CUSTOMTABLE","FILE","RICHTEXT","TABLE","DATETIMERANGE","MEMBERS"].some((function(e){return e===t.type}))||e.fieldList.push(t)})),this.fieldList.forEach((function(t){"RPC"===t.source_type&&e.getRpcData(t)})),this.isNecessaryToWatch({fields:this.fieldList},"workflow")},getRpcData:function(e){var t=this;this.$store.dispatch("apiRemote/getRpcData",e).then((function(t){e.choice=t.data})).catch((function(e){(0,a.errorHandler)(e,t)}))},checkBetweenList:function(e){return["MULTISELECT","CHECKBOX","MEMBERS","TREESELECT"].some((function(t){return t===e}))?this.globalChoise.methods.filter((function(e){return"issuperset"===e.typeName||"notissuperset"===e.typeName})):["DATE","DATETIME","DATETIMERANGE","INT"].some((function(t){return t===e}))?this.globalChoise.methods.filter((function(e){return"issuperset"!==e.typeName&&"notissuperset"!==e.typeName})):this.globalChoise.methods.filter((function(e){return"=="===e.typeName||"!="===e.typeName}))},clearCondition:function(){this.listInfo=[{condition:"",key:"",value:"",choiceList:"",type:"STRING",multiSelect:!1,betweenList:this.checkBetweenList("STRING")}]},changeName:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=this.fieldList.filter((function(e){return e.key===t[0]}))[0],a="MULTISELECT"===n.type||"CHECKBOX"===n.type||"MEMBERS"===n.type||"TREESELECT"===n.type,r=this.checkBetweenList(n.type);t[2].type=n.type,t[2].value=a?[]:"",t[2].betweenList=r,t[2].condition="","SELECT"===n.type||"MULTISELECT"===n.type||"RADIO"===n.type||"CHECKBOX"===n.type||"MEMBERS"===n.type||"TREESELECT"===n.type?(t[2].choiceList=[],n.choice.forEach((function(e){t[2].choiceList.push({key:e.key,name:e.name})})),t[2].multiSelect=a):t[2].choiceList=""},addNode:function(e,t){var i={condition:"",key:"",value:"",choiceList:"",type:"STRING",multiSelect:!1,betweenList:this.checkBetweenList("STRING")};this.listInfo.splice(t+1,0,i)},deleteNode:function(e,t){1!==this.listInfo.length&&this.listInfo.splice(t,1)},checkList:function(){return this.checkStatus=this.listInfo.some((function(e){return!(e.key&&e.condition&&(Array.isArray(e.value)?e.value.length:e.value))})),this.checkStatus}}}},WSG0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("oCYn")),a=r(i("C65D"));function r(e){return e&&e.__esModule?e:{default:e}}var s=n.default.extend(a.default);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:"title",formData:[],context:{schemes:{}}},t=new s({el:document.createElement("div"),propsData:{isShow:!1,title:e.title,formData:e.formData,context:e.context},data:{isShow:!1}});t.viewmodel=t.$mount();var i=document.body;return i.appendChild(t.viewmodel.$el),t.isShow=!0,t.$on("update:isShow",(function(e){e||(t.isShow=!1)})),t.viewmodel}},WenH:function(e,t,i){},Wew5:function(e,t,i){},WgRI:function(e,t,i){"use strict";i.r(t);var n=i("UA1S"),a=i("5R1Y");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("h4G3");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"85db1284",null);t.default=o.exports},Wl5c:function(e,t,i){"use strict";i.r(t);var n=i("lpJK"),a=i("b0Dy");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},Wu5q:function(e,t,i){"use strict";var n=i("2faE").f,a=i("oVml"),r=i("XJU/"),s=i("2GTP"),o=i("EXMj"),l=i("oioR"),c=i("MPFp"),u=i("UO39"),f=i("TJWN"),d=i("jmDH"),m=i("6/1s").fastKey,p=i("n3ko"),h=d?"_s":"size",v=function(e,t){var i,n=m(t);if("F"!==n)return e._i[n];for(i=e._f;i;i=i.n)if(i.k==t)return i};e.exports={getConstructor:function(e,t,i,c){var u=e((function(e,n){o(e,u,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[h]=0,null!=n&&l(n,i,e[c],e)}));return r(u.prototype,{clear:function(){for(var e=p(this,t),i=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var i=p(this,t),n=v(i,e);if(n){var a=n.n,r=n.p;delete i._i[n.i],n.r=!0,r&&(r.n=a),a&&(a.p=r),i._f==n&&(i._f=a),i._l==n&&(i._l=r),i[h]--}return!!n},forEach:function(e){p(this,t);for(var i,n=s(e,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(n(i.v,i.k,this);i&&i.r;)i=i.p},has:function(e){return!!v(p(this,t),e)}}),d&&n(u.prototype,"size",{get:function(){return p(this,t)[h]}}),u},def:function(e,t,i){var n,a,r=v(e,t);return r?r.v=i:(e._l=r={i:a=m(t,!0),k:t,v:i,p:n=e._l,n:void 0,r:!1},e._f||(e._f=r),n&&(n.n=r),e[h]++,"F"!==a&&(e._i[a]=r)),e},getEntry:v,setStrong:function(e,t,i){c(e,t,(function(e,i){this._t=p(e,t),this._k=i,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),i?"entries":"values",!i,!0),f(t)}}},WzOL:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("QbLZ")),a=o(i("u8Ap")),r=i("L2JU"),s=i("CeR/");function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"triggerFields",components:{memberSelect:a.default},props:{item:{type:Object,default:function(){return{}}}},data:function(){return{keyList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,r.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.keyList=e}},created:function(){this.item.value&&(this.keyList=this.triggerVariables,this.getConditionList())},methods:{getConditionList:function(){var e=this,t=this.keyList.filter((function(t){return t.key===e.item.key}))[0];["SELECT","RADIO","MULTISELECT","CHECKBOX"].some((function(e){return e===t.type}))&&(this.$set(this.item,"loading",!0),this.$set(this.item,"options",[]),"DATADICT"===t.source_type?this.$store.dispatch("datadict/get_data_by_key",{key:t.source_uri,field_key:t.key}).then((function(t){e.item.options=t.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.item.loading=!1})):"API"===t.source_type?this.$store.dispatch("apiRemote/get_data_workflow",{kv_relation:t.kv_relation,api_instance_id:t.api_instance_id}).then((function(t){e.item.options=t.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.item.loading=!1})):"RPC"===t.source_type?this.$store.dispatch("apiRemote/getRpcData",{meta:t.meta,source_uri:t.source_uri}).then((function(t){e.item.options=t.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.item.loading=!1})):(this.item.options=t.choice.map((function(e){return{key:e.key,name:e.name}})),this.item.loading=!1))}}}},XClk:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"view-item"},[e.crumbsList.length>1?t("div",{staticClass:"bread-crumbs"},e._l(e.crumbsList,(function(i,n){return t("span",{key:n,staticClass:"crumbs-item",on:{click:function(t){return t.stopPropagation(),e.onCrumbsClick(n)}}},[e._v("\n      "+e._s(i.label)+"\n    ")])})),0):e._e(),e._v(" "),e.crumbsList.length<=1?t(e.componentType,e._b({tag:"component",attrs:{form:e.form}},"component",e.getAttrs(e.form),!1)):t("render-view",{ref:"childrenView",attrs:{"hidden-label":!0,"form-data":e.childrenViewConfig.form_data,context:e.getContext()}})],1)},a=[];n._withStripped=!0},XDfz:function(e,t,i){"use strict";i.r(t);var n=i("LexG"),a=i("c6BP");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("L2Eo");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"7a97f3de",null);t.default=o.exports},XEYe:function(e,t,i){"use strict";i("alFg")},XUL0:function(e,t,i){"use strict";i.r(t);var n=i("kSST"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},XiH4:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-date-picker",{class:{"bk-border-error":e.item.checkValue},attrs:{type:"datetime",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.$t("m.newCommon['选择日期时间']")},on:{"open-change":function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},"Y6/M":function(e,t,i){"use strict";i.r(t);var n=i("vlfB"),a=i("CjxG");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("3Xpq");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"23a8f17e",null);t.default=o.exports},Y9oG:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i("gDS+")),a=c(i("14Xm")),r=c(i("D3Ub")),s=c(i("OE89")),o=c(i("efIh")),l=i("CeR/");function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"TREESELECT",components:{exportTree:s.default},mixins:[o.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,required:!0,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{options:[],treeSlectInfo:{show:!1,treeDataList:[],info:{}}}},computed:{},watch:{"item.val":function(){var e=this;this.treeSlectInfo.treeDataList.forEach((function(t){e.treeData(t)})),this.conditionField(this.item,this.fields)}},mounted:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$nextTick((function(){e.getTreeInfo(),e.conditionField(e.item,e.fields)}));case 1:case"end":return t.stop()}}),t,e)})))()},methods:{getTreeInfo:function(){var e=this,t={},i="";"RPC"===this.item.source_type?(i="apiRemote/getRpcData",t={source_uri:this.item.source_uri}):"DATADICT"===this.item.source_type&&(i="dictdata/getTreeInfo",t={key:this.item.source_uri,view_type:"tree"}),this.$store.dispatch(i,t).then((function(t){e.treeSlectInfo.treeDataList=t.data,e.item.choice=t.data,e.treeSlectInfo.treeDataList.forEach((function(t){e.treeData(t)}))})).catch((function(t){(0,l.errorHandler)(t,e)}))},showTree:function(){var e=this;if(!this.disabled){this.item.checkValue=!1,this.treeSlectInfo.show=!this.treeSlectInfo.show;var t="";this.fields.forEach((function(i,n){i.id===e.item.id&&(t=n)})),t===this.fields.length-1&&document.getElementById("bkPreview")&&setTimeout((function(){document.getElementById("bkPreview").scrollTop+=100}),100)}},closeTree:function(){this.treeSlectInfo.show=!1},toggleInfo:function(e){var t=this;this.treeSlectInfo.treeDataList.forEach((function(e){t.recordCheckFn(e)})),e.checkInfo=!0,this.treeSlectInfo.treeDataList=JSON.parse((0,n.default)(this.treeSlectInfo.treeDataList)),this.treeSlectInfo.info=e,this.item.val=this.treeSlectInfo.info.id,this.closeTree()},treeData:function(e){var t=this;if(e.showChildren=!1,e.checkInfo=!1,e.has_children=!!e.children.length,String(this.item.val)===String(e.id)){e.checkInfo=!0,this.treeSlectInfo.info=e;var i=[];this.treeSlectInfo.info.route&&this.treeSlectInfo.info.route.length&&this.treeSlectInfo.info.route.forEach((function(e){i.push(e.name)})),i.push(this.treeSlectInfo.info.name),this.treeSlectInfo.info.showName=i.join(" / ")}e.has_children&&e.children.length&&e.children.forEach((function(i){i.parent_id===e.id&&(e.showChildren=!0),t.treeData(i)}))},recordCheckFn:function(e){var t=this;e.checkInfo=!1,e.children&&e.children.length&&e.children.forEach((function(e){t.recordCheckFn(e)}))},toggleChildren:function(e){e.showChildren=!e.showChildren,this.treeSlectInfo.treeDataList=JSON.parse((0,n.default)(this.treeSlectInfo.treeDataList))}}}},YWQd:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{staticClass:"bk-form-int",attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-input",{class:{"bk-border-error":e.item.checkValue},attrs:{clearable:!0,type:"number",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled},on:{focus:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",e._n(t))},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):e.isErrMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["已超出最大值!"]')))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},"Z/e7":function(e,t,i){},"Za/z":function(e,t,i){"use strict";i.r(t);var n=i("YWQd"),a=i("34/K");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},Zicn:function(e,t,i){},ZsJz:function(e,t,i){"use strict";i.r(t);var n=i("H2GU"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},aDD8:function(e,t,i){"use strict";i.r(t);var n=i("PAo4"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},aNPh:function(e,t,i){"use strict";i.r(t);var n=i("x9y/"),a=i("BFl6");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("lVyC");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"85bababe",null);t.default=o.exports},aPfg:function(e,t,i){"use strict";var n=i("Y7ZC"),a=i("eaoh"),r=i("2GTP"),s=i("oioR");e.exports=function(e){n(n.S,e,{from:function(e){var t,i,n,o,l=arguments[1];return a(this),(t=void 0!==l)&&a(l),null==e?new this:(i=[],t?(n=0,o=r(l,arguments[2],2),s(e,!1,(function(e){i.push(o(e,n++))}))):s(e,!1,i.push,i),new this(i))}})}},aRCN:function(e,t,i){},aYIO:function(e,t,i){"use strict";i.r(t);var n=i("LVBE"),a=i("sshH");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("WOBF");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"aad0502a",null);t.default=o.exports},afA4:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-get-param"},[t("bk-table",{attrs:{data:e.prcTable,size:"small"}},[t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),prop:"name"}}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['必选']")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n      ")]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{attrs:{title:i.row.desc}},[e._v(e._s(i.row.desc||"--"))])]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",left:"15px"}},[t("bk-select",{attrs:{clearable:!1,searchable:""},model:{value:i.row.source_type,callback:function(t){e.$set(i.row,"source_type",t)},expression:"props.row.source_type"}},e._l(e.sourceTypeList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),"CUSTOM"===i.row.source_type?t("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[t("bk-input",{attrs:{clearable:!0,placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:i.row.value,callback:function(t){e.$set(i.row,"value",t)},expression:"props.row.value"}})],1):t("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[t("bk-select",{attrs:{clearable:!1,searchable:""},model:{value:i.row.value_key,callback:function(t){e.$set(i.row,"value_key",t)},expression:"props.row.value_key"}},e._l(e.stateList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1)]}}])})],1)],1)},a=[];n._withStripped=!0},alFg:function(e,t,i){},b0Dy:function(e,t,i){"use strict";i.r(t);var n=i("SO4U"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"b1K/":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i,n,a){var r=sessionStorage.getItem("cursorIndex"),s=r&&JSON.parse(r);if(!e||!e.selectionStart&&0!==e.selectionStart||s.name!==t)return i+n;var o=s.start,l=s.end,c=e.scrollTop;return a.$nextTick((function(){e.selectionStart=o+n.length,e.selectionEnd=o+n.length,e.scrollTop=c,e.focus()})),i.substr(0,o)+n+i.substr(l)}},bcjM:function(e,t,i){"use strict";i.r(t);var n=i("11RT"),a=i("ZsJz");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("r/L1");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"00c1c6e8",null);t.default=o.exports},c6BP:function(e,t,i){"use strict";i.r(t);var n=i("WP3n"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},c6Q5:function(e,t,i){"use strict";i.r(t);var n=i("wA6F"),a=i("qCK4");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("7LjQ");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"725441f0",null);t.default=o.exports},cHUd:function(e,t,i){"use strict";var n=i("Y7ZC");e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},dD0k:function(e,t,i){"use strict";i("hF++")},dGg1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CUSTOM_FORM_TEMPLATE={config:{mode:"sideslider"},schemes:{base_text_scheme:{type:"text",attrs:{styles:{label:["border"],value:["highlight","border"]},desc:"通用描述文字"}},table_text_scheme:{type:"text",attrs:{styles:{label:["border"],value:["highlight","border"]}}},base_table_scheme:{type:"table",attrs:{column:[{name:"操作",type:"text",key:"column1"},{name:"关联相关内容",key:"column2",scheme:"table_text_scheme",attrs:{}},{name:"申请期限",type:"text",key:"column3",attrs:{sort:!0}}]}},sub_table_scheme:{type:"table",attrs:{column:[{name:"关联内容-类型",key:"column1",scheme:"base_text_scheme"},{name:"类型值",key:"column2",scheme:"table_text_scheme"}]}},sub2_table_scheme:{type:"table",attrs:{column:[{name:"主机",key:"column1",scheme:"base_text_scheme"}]}}},form_data:[{label:"业务：",scheme:"base_text_scheme",value:"蓝鲸",desc:"覆盖 scheme 中通用描述文字",children:[{label:"子业务1：",scheme:"base_text_scheme",value:"test1"},{label:"子业务2：",scheme:"base_text_scheme",value:"test2"}]},{label:"提单人：",scheme:"base_text_scheme",value:""},{label:"提单时间：",scheme:"base_text_scheme",value:""}]}},dL40:function(e,t,i){var n=i("Y7ZC");n(n.P+n.R,"Set",{toJSON:i("8iia")("Set")})},dU2m:function(e,t,i){"use strict";i.r(t);var n=i("0vGa"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},db1v:function(e,t,i){"use strict";i.r(t);var n=i("30Fg"),a=i("hv+2");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("45Gy");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"7b188e93",null);t.default=o.exports},dbV7:function(e,t,i){var n=i("Y7ZC");n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},dm0o:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"ext-cls":"bk-line-height","desc-type":"icon"}},[t("bk-radio-group",{on:{change:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}},[e._l(e.item.choice,(function(i){return[t("bk-radio",{key:i.key,attrs:{disabled:e.disabled,value:i.key,"ext-cls":"mr20"}},[e._v(e._s(i.name))])]}))],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},dwEX:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-default-value"},["STRING"===e.formInfo.type?[t("bk-input",{attrs:{"ext-cls":"bk-half",clearable:!0,placeholder:e.$t("m.treeinfo['请输入']")},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})]:e._e(),e._v(" "),"TEXT"===e.formInfo.type?[t("div",{staticStyle:{height:"30px"}},[t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.formInfo.default_value,expression:"formInfo.default_value",modifiers:{trim:!0}}],staticClass:"bk-form-textarea bk-textarea-tanble",staticStyle:{width:"49%"},attrs:{rows:"8",placeholder:e.$t("m.treeinfo['请输入']")},domProps:{value:e.formInfo.default_value},on:{input:function(t){t.target.composing||e.$set(e.formInfo,"default_value",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]:e._e(),e._v(" "),"RICHTEXT"===e.formInfo.type?[t("div",[t("rich-text-editor",{attrs:{id:"default-rich-text-editor","full-title":e.label},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"MULTISELECT"===e.formInfo.type||"CHECKBOX"===e.formInfo.type||"SELECT"===e.formInfo.type||"RADIO"===e.formInfo.type||"INPUTSELECT"===e.formInfo.type?["API"===e.formInfo.source_type||"RPC"===e.formInfo.source_type?[t("bk-input",{attrs:{"ext-cls":"bk-half",clearable:!0,placeholder:e.$t("m.treeinfo['请输入']")},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})]:[t("bk-select",{attrs:{"ext-cls":"bk-half",multiple:"MULTISELECT"===e.formInfo.type||"CHECKBOX"===e.formInfo.type,searchable:""},on:{toggle:e.getSelectList},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}},e._l(e.selectList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]]:e._e(),e._v(" "),"INT"===e.formInfo.type?[t("div",{staticClass:"bk-half"},[t("bk-input",{attrs:{clearable:!0,type:"number",precision:e.precision},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"DATE"===e.formInfo.type?[t("div",{staticClass:"bk-half"},[t("bk-date-picker",{attrs:{placeholder:e.$t("m.newCommon['选择日期']")},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"DATETIME"===e.formInfo.type?[t("div",{staticClass:"bk-half"},[t("bk-date-picker",{attrs:{type:"datetime",placeholder:e.$t("m.newCommon['选择日期时间']")},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"MEMBER"===e.formInfo.type?[t("div",{staticStyle:{width:"49%"}},[t("member-select",{attrs:{multiple:!1},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"MEMBERS"===e.formInfo.type?[t("div",{staticStyle:{width:"49%"}},[t("member-select",{model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"CUSTOM-FORM"===e.formInfo.type?[t("div",{staticClass:"editor-wrap"},[t("div",{staticClass:"editor-btn-group"},[t("router-link",{staticClass:"opt-item",attrs:{target:"_blank",to:{name:"CustomFormTest"}}},[e._v(e._s(e.$t("m.common['查看模板']")))]),e._v(" "),t("span",{staticClass:"opt-item",on:{click:e.downCustomFormTempalte}},[e._v("\n          "+e._s(e.$t("m.common['下载模板']")))])],1),e._v(" "),t("code-editor",{attrs:{options:{language:"json"}},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1),e._v(" "),e.checkStatus.customFormStatus?t("p",{staticClass:"bk-field-error"},[e._v("\n      "+e._s(e.$t("m.treeinfo['格式错误！（JSON 语法错误或者根元素缺少 schemes 和 form_data 属性）']"))+"\n    ")]):e._e()]:e._e()],2)},a=[];n._withStripped=!0},dwwr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("CeR/");t.default={name:"inheritState",props:{workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},showTabList:{type:Array,default:function(){return[]}},configur:{type:Object,default:function(){return{}}}},data:function(){return{isDataLoading:!1,trueStatus:!0,falseStatus:!1,dataList:[],checkList:[]}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.getTicketTables()},methods:{getTicketTables:function(){var e=this,t=this.workflow;this.isDataLoading=!0,this.$store.dispatch("basicModule/get_ticket_tables",{params:{},id:t}).then((function(t){e.dataList=t.data.fields,e.dataList.forEach((function(t){e.globalChoise.field_type.forEach((function(i){t.type===i.typeName&&e.$set(t,"typeName",i.name)})),e.$set(t,"is_readonly",!1),e.$set(t,"is_disabled",!1),e.showTabList.forEach((function(e){t.key===e.key&&(t.is_readonly=e.is_readonly,t.is_disabled=!0)})),"priority"===t.key&&(t.is_readonly=!0)})),e.configur.is_first_state&&(e.dataList=e.dataList.filter((function(e){return"current_status"!==e.key}))),e.$nextTick((function(){e.dataList.forEach((function(t){t.is_disabled&&e.$refs.table.toggleRowSelection(t,!0)}))}))})).catch((function(t){(0,n.errorHandler)(t,e)})).finally((function(){e.isDataLoading=!1}))},handleSelectAll:function(e){this.checkList=e},handleSelect:function(e){this.checkList=e},disabledFn:function(e){return!this.showTabList.some((function(t){return t.key===e.key}))}}}},"e+8O":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"child-node"},[e.treeDataList.length?e._l(e.treeDataList,(function(i,n){return t("li",{key:n,staticClass:"vue-tree-item"},[!e.isKeyValue&&i.children&&i.children.length||e.isKeyValue?t("div",{class:["tree-node",{down:i.showChildren,"set-frist-pLeft":e.treeIndex+1===1,active:i.checkInfo}],style:e.pLeft,on:{click:function(t){return t.stopPropagation(),e.toggle(i)}}},[i.showChildren||"object"!==i.type?e._e():t("i",{staticClass:"bk-icon icon-right-shape",class:{"bk-padding":!i.has_children},on:{click:function(t){return t.stopPropagation(),e.toggleChildren(i)}}}),e._v(" "),i.showChildren&&"object"===i.type?t("i",{staticClass:"bk-icon icon-down-shape",class:{"bk-padding":!i.has_children},on:{click:function(t){return t.stopPropagation(),e.toggleChildren(i)}}}):e._e(),e._v(" "),t("i",{staticClass:"bk-icon icon-folder-open-shape"}),e._v(" "),t("span",{staticClass:"name-text",attrs:{title:i.name}},[e._v(e._s(i.name))]),e._v(" "),i.checkInfo?t("i",{staticClass:"bk-icon icon-check-1",staticStyle:{float:"right","margin-top":"11px"}}):e._e()]):e._e(),e._v(" "),t("collapse-transition",["object"===i.type&&i.showChildren&&i.children?[t("exportTree",{attrs:{"tree-data-list":i.children,"tree-index":e.treeIndex+1,"is-key-value":e.isKeyValue},on:{selectItem:e.selectItem,toggle:e.toggle,toggleChildren:e.toggleChildren}})]:e._e()],2)],1)})):[e.isKeyValue?e._e():t("li",{staticClass:"vue-tree-item"},[t("div",{staticClass:"tree-node set-frist-pLeft"},[t("span",{staticClass:"name-text"},[e._v(e._s(e.$t('m.deployPage["暂无数据"]')))])])])]],2)},a=[];n._withStripped=!0},e07s:function(e,t,i){"use strict";i("gHwO")},e42N:function(e,t,i){},"eM+a":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-upload"},[t("div",{staticClass:"file-wrapper",class:{isdrag:e.isdrag}},[t("img",{staticClass:"upload-icon",attrs:{src:e.uploadIcon}}),e._v(" "),t("span",{staticClass:"drop-upload"},[e._v(e._s(e.dragText))]),e._v(" "),t("span",{staticClass:"click-upload"},[e._v(e._s(e.clickText))]),e._v(" "),t("input",{ref:"uploadel",attrs:{accept:e.accept,multiple:e.multiple,disabled:e.disabled,type:"file",accept:".txt,.log,.pdf,.doc,.ppt,.xls,.docx,.pptx,.xlsx,.zip,.jpg,.png"},on:{change:e.selectFile}})]),e._v(" "),e.tip?t("p",{staticClass:"tip"},[e._v(e._s(e.tip))]):e._e(),e._v(" "),e.fileList.length?t("div",{staticClass:"all-file"},e._l(e.fileList,(function(i,n){return t("div",{key:n},[t("div",{staticClass:"file-item"},[t("div",{staticClass:"file-icon"},[t("img",{attrs:{src:e.getIcon(i)}})]),e._v(" "),i.done?e._e():t("i",{staticClass:"bk-icon icon-close close-upload",on:{click:function(t){return e.deleteFile(n,i)}}}),e._v(" "),t("div",{staticClass:"file-info"},[t("div",{staticClass:"file-name"},[t("span",[e._v(e._s(i.name))])]),e._v(" "),t("div",{staticClass:"file-message"},[t("span",{directives:[{name:"show",rawName:"v-show",value:!i.done&&"running"===i.status,expression:"!file.done && file.status === 'running'"}],staticClass:"upload-speed"},[e._v(e._s(e.speed)+e._s(e.unit))]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:!i.done,expression:"!file.done"}],staticClass:"file-size"},[e._v(e._s(e.filesize(i.size)))]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:i.done,expression:"file.done"}],staticClass:"file-size done"},[e._v(e._s("上传完成"))])]),e._v(" "),t("div",{staticClass:"progress-bar-wrapper"},[t("div",{staticClass:"progress-bar",class:{fail:i.errorMsg},style:{width:i.progress}})])])]),e._v(" "),i.errorMsg?t("p",{staticClass:"error-msg"},[e._v(e._s(i.errorMsg))]):e._e()])})),0):e._e()])},a=[];n._withStripped=!0},eOfU:function(e,t,i){"use strict";i.r(t);var n=i("XiH4"),a=i("f3v2");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},eQfd:function(e,t,i){"use strict";i.r(t);var n=i("8O5U"),a=i("gt7i");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("TDZ0");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"0be47cb7",null);t.default=o.exports},eYYl:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",e._l(e.responseList,(function(i,n){return t("div",{key:n,staticClass:"bk-trigger-condition"},[t("div",{staticClass:"bk-condition-name"},[t("p",[e._v(e._s(e.$t("m.trigger['响应动作']")))]),e._v(" "),t("div",{staticClass:"bk-between-operat"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(t){return e.addResponse(i,n)}}}),e._v(" "),t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.responseList.length},on:{click:function(t){return e.deleteResponse(i,n)}}})])]),e._v(" "),t("div",{staticClass:"bk-condition-content"},[t("div",{staticClass:"bk-response-way"},[t("p",{staticClass:"bk-response-name"},[e._v(e._s(e.$t("m.trigger['动作名称']"))),t("span",{staticClass:"bk-span-square"},[e._v("*")])]),e._v(" "),t("bk-select",{attrs:{"ext-cls":"bk-way-input",clearable:!1,searchable:""},on:{selected:function(t){return e.selectedWay(...arguments,i)}},model:{value:i.way,callback:function(t){e.$set(i,"way",t)},expression:"item.way"}},e._l(e.responseWayList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),i.wayStatus?t("p",{staticClass:"bk-error-info"},[e._v(e._s(e.$t("m.trigger['动作名称为必填项']")))]):e._e()],1),e._v(" "),i.wayInfo.field_schema&&i.wayInfo.field_schema.length?t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:i.isLoading},expression:"{ isLoading: item.isLoading }"}],staticStyle:{"min-height":"100px"}},[!i.isLoading&&i.wayInfo.field_schema&&i.wayInfo.field_schema.length?t("response-content",{attrs:{item:i,signal:e.signal}}):e._e()],1):e._e()])])})),0)},a=[];n._withStripped=!0},efIh:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),a=s(i("D3Ub")),r=i("CeR/");function s(e){return e&&e.__esModule?e:{default:e}}t.default={methods:{getFieldOptions:function(e){var t=this;return(0,a.default)(n.default.mark((function i(){var a;return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:a=[],i.t0=e.source_type,i.next="CUSTOM"===i.t0?4:"API"===i.t0?6:"DATADICT"===i.t0?9:"RPC"===i.t0?17:24;break;case 4:return a=e.choice,i.abrupt("break",24);case 6:return a=[],e.choice.forEach((function(e){a.push({key:String(e.id||e.key),name:e.name,can_delete:Boolean(e.can_delete)})})),i.abrupt("break",24);case 9:if(a=[],!e.choice.some((function(e){return e.can_delete}))){i.next=13;break}return a=e.choice,i.abrupt("break",24);case 13:if("TREESELECT"===e.type){i.next=16;break}return i.next=16,t.$store.dispatch("datadict/get_data_by_key",{key:e.source_uri,field_key:e.key,service:e.service,current_status:e.ticket_status}).then((function(i){a=i.data.map((function(i){var n={key:i.key,name:i.name};return"current_status"===e.key&&t.$set(n,"isOver",i.is_over),n}))})).catch((function(e){(0,r.errorHandler)(e,t)}));case 16:return i.abrupt("break",24);case 17:if(a=[],!e.choice.some((function(e){return e.can_delete}))){i.next=21;break}return a=e.choice,i.abrupt("break",24);case 21:return i.next=23,t.$store.dispatch("apiRemote/getRpcData",e).then((function(e){a=e.data})).catch((function(e){(0,r.errorHandler)(e,t)}));case 23:return i.abrupt("break",24);case 24:return i.abrupt("return",a);case 25:case"end":return i.stop()}}),i,t)})))()},judgeValue:function(e,t){if(e)return t.some((function(t){return-1!==e.toString().indexOf(t.key)}))},conditionField:function(e,t){for(var i=0;i<t.length;i++)if(!t[i].show_type&&(t[i].hasOwnProperty("show_conditions")||t[i].hasOwnProperty("show_result")&&!t[i].show_result)){if(t[i].show_conditions.expressions&&t[i].show_conditions.expressions.length)for(var n=0;n<t[i].show_conditions.expressions.length;n++)if(e.key===t[i].show_conditions.expressions[n].key&&e.key===t[i].key&&null===t[i].value)t[i].showFeild=!0;else if(e.key===t[i].show_conditions.expressions[n].key){if(1===t[i].show_conditions.expressions.length)t[i].showFeild=this.conditionSwitch(e,t[i].show_conditions.expressions[n]);else if("and"===t[i].show_conditions.type){for(var a=[],r=0;r<t[i].show_conditions.expressions.length;r++)for(var s=0;s<t.length;s++)if(t[i].show_conditions.expressions[r].key===t[s].key){var o=this.conditionSwitch(t[s],t[i].show_conditions.expressions[r]);a.push(o)}t[i].showFeild=a.every((function(e){return!!e}))}else{for(var l=[],c=0;c<t[i].show_conditions.expressions.length;c++)for(var u=0;u<t.length;u++)if(t[i].show_conditions.expressions[c].key===t[u].key){var f=this.conditionSwitch(t[u],t[i].show_conditions.expressions[c]);l.push(f)}t[i].showFeild=l.some((function(e){return!!e}))}t[i].showFeild=!t[i].showFeild}}else t[i].showFeild=!0},conditionSwitch:function(e,t){var i=!1,n=["CHECKBOX","MEMBERS","MULTISELECT","TREESELECT"];switch(t.condition){case"==":if(n.some((function(t){return t===e.type})))i=t.value.split(",").map((function(t){return-1===e.val.indexOf(t)})).every((function(e){return!e}))&&e.val.length===t.value.length;else i=e.val===t.value||Number(e.val)===Number(t.value);break;case"!=":if(n.some((function(t){return t===e.type}))){var a=t.value.split(",").map((function(t){return-1===e.val.indexOf(t)}));i=a.some((function(e){return!!e}))?a.some((function(e){return!!e})):e.val.length!==t.value.length}else i=e.val!==t.value&&Number(e.val)!==Number(t.value);break;case">":i="DATE"===e.type||"DATETIME"===e.type?this.timeStamp(e.val)>this.timeStamp(t.value):Number(e.val)>Number(t.value);break;case"<":i="DATE"===e.type||"DATETIME"===e.type?this.timeStamp(e.val)<this.timeStamp(t.value):Number(e.val)<Number(t.value);break;case">=":i="DATE"===e.type||"DATETIME"===e.type?this.timeStamp(e.val)>=this.timeStamp(t.value):Number(e.val)>=Number(t.value);break;case"<=":i="DATE"===e.type||"DATETIME"===e.type?this.timeStamp(e.val)<=this.timeStamp(t.value):Number(e.val)<=Number(t.value);break;case"issuperset":i=t.value.split(",").map((function(t){return-1===e.val.indexOf(t)})).every((function(e){return!e}));break;case"notissuperset":i=!t.value.split(",").map((function(t){return-1===e.val.indexOf(t)})).every((function(e){return!e}));break;default:i=!0}return i},timeStamp:function(e){var t=e.replace(/-/g,"/");return new Date(t).getTime()}}}},eofb:function(e,t,i){"use strict";i.r(t);var n=i("dwwr"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},eqfU:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-select",{class:{"bk-form-two":e.firstShow},attrs:{searchable:"","font-size":"medium",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.choice[0]?e.item.choice[0].desc:e.firstPlace},on:{selected:e.itemSelect},model:{value:e.firstInfo,callback:function(t){e.firstInfo=t},expression:"firstInfo"}},e._l(e.item.choice,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),e.firstShow?[t("bk-select",{class:{"bk-form-two-other":e.firstShow},attrs:{searchable:"",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,"font-size":"medium",placeholder:e.firstList[0]?e.firstList[0].desc:e.secondPlace},on:{selected:e.changeFrist},model:{value:e.secondInfo,callback:function(t){e.secondInfo=t},expression:"secondInfo"}},e._l(e.firstList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e()],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},a=[];n._withStripped=!0},ew6e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(i("QbLZ")),a=m(i("14Xm")),r=m(i("P2sY")),s=m(i("gDS+")),o=m(i("D3Ub")),l=m(i("PaSM")),c=m(i("uz2X")),u=m(i("8zq1")),f=i("CeR/"),d=i("ygAv");function m(e){return e&&e.__esModule?e:{default:e}}t.default={name:"addTrigger",components:{triggerCondition:c.default,responseCondition:u.default},mixins:[l.default],props:{projectId:String,triggerInfo:{type:Object,default:function(){return{}}},originInfoToTrigger:{type:Object,default:function(){return{}}}},data:function(){return{contentLoading:!1,formData:{name:"",is_enabled:!0,desc:"",signal:"",moduleTypeDisabled:!1,variableLoading:!1},triggerEventList:[],iconList:[{key:"icon-icon-notice-new",name:"",typeName:"message"},{key:"icon-icon-user-new",name:"",typeName:"user"},{key:"icon-icon-status-new",name:"",typeName:"status"},{key:"icon-icon-api-new",name:"",typeName:"api"}],iconInfo:{status:!1,key:"icon-icon-notice-new",name:"",typeName:""},responseWayList:[],rulesList:[],ruleItem:{name:"",historyName:"",nameChange:!1,triggerStatus:!1,showContent:!0,triggerRules:{type:"all",list:[{type:"all",itemList:[{key:"",condition:"",value:"",conditionList:[],type:"STRING"}]}]},responseList:[{way:"",wayInfo:{},performData:{runMode:"BACKEND",displayName:"",repeat:"one"},isLoading:!1}]},backInfo:{responseList:[],triggerInfo:{}},btnLoading:!1,triggerAllRules:[],rules:{},moduleTypes:[],initFormData:{}}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.initData(),this.rules.name=this.checkCommonRules("name").name,this.rules.signal=this.checkCommonRules("select").select},methods:{initData:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var i,n,o,l,c,u,f;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n in i=JSON.parse((0,s.default)(e.ruleItem)),e.rulesList.push(i),e.iconList.forEach((function(t){switch(t.key){case"icon-icon-notice-new":t.name=e.globalChoise.trigger_icon.find((function(e){return"message"===e.typeName})).name;break;case"icon-icon-user-new":t.name=e.globalChoise.trigger_icon.find((function(e){return"user"===e.typeName})).name;break;case"icon-icon-status-new":t.name=e.globalChoise.trigger_icon.find((function(e){return"status"===e.typeName})).name;break;case"icon-icon-api-new":t.name=e.globalChoise.trigger_icon.find((function(e){return"api"===e.typeName})).name}})),e.iconInfo.key=e.iconList[0].key,e.iconInfo.name=e.iconList[0].name,e.iconInfo.typeName=e.iconList[0].typeName,e.triggerEventList=[],e.globalChoise.trigger_signals){for(l in o={key:n,name:e.globalChoise.trigger_categories[n],children:[]},e.globalChoise.trigger_signals[n])o.children.push({key:l,name:e.globalChoise.trigger_signals[n][l]});e.triggerEventList.push(o)}if(!e.originInfoToTrigger.id){t.next=21;break}return c=e.originInfoToTrigger.sender,u=e.originInfoToTrigger.type,f={workflow:e.originInfoToTrigger.id},"task_schemas"===u&&(f.stage=e.originInfoToTrigger.stage,delete f.workflow),"states"===u&&(f.state=e.originInfoToTrigger.sender),t.next=16,e.$store.dispatch("trigger/getTriggerVariables",{id:c,type:u,params:f}).then((function(t){e.$store.commit("trigger/changeTriggerVariables",t.data)}));case 16:e.triggerEventList=e.triggerEventList.filter((function(t){return t.key===e.originInfoToTrigger.filter})),e.triggerEventList[0].children=e.triggerEventList[0].children.filter((function(t){return-1!==e.originInfoToTrigger.signal.indexOf(t.key)})),1===e.triggerEventList.length&&1===e.triggerEventList[0].children.length&&(e.formData.signal=e.triggerEventList[0].children[0].key),t.next=22;break;case 21:e.$store.commit("trigger/changeTriggerVariables",e.globalChoise.ticket_variables);case 22:return e.getModuleTypes(),t.next=25,e.getResponseList();case 25:e.triggerInfo.id?(e.contentLoading=!0,e.getData()):e.initFormData=(0,d.deepClone)((0,r.default)({},{formData:e.formData}));case 26:case"end":return t.stop()}}),t,e)})))()},getModuleTypes:function(){var e=this;this.$store.dispatch("basicModule/get_tables",{all:!0}).then((function(t){e.moduleTypes=t.data})).catch((function(t){(0,f.errorHandler)(t,e)}))},getData:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var i,n,o,l;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.iconList.find((function(t){return t.typeName===e.triggerInfo.icon})),e.iconInfo.key=i.key,e.iconInfo.name=i.name,e.iconInfo.typeName=i.typeName,e.formData.name=e.triggerInfo.name,e.formData.is_enabled=e.triggerInfo.is_enabled,e.formData.desc=e.triggerInfo.desc,e.formData.signal=e.triggerInfo.signal,e.triggerInfo.source_table_id&&(e.formData.moduleTypeDisabled=!0,e.giveTableVariables(e.triggerInfo.source_table_id)),t.next=11,e.getTriggerRules();case 11:n=e.triggerAllRules.filter((function(t){return t.trigger_id===e.triggerInfo.id})),e.rulesList=[],o=0;case 14:if(!(o<n.length)){t.next=24;break}return(l=JSON.parse((0,s.default)(e.ruleItem))).triggerStatus=n[o].by_condition||!!n[o].condition,l.triggerStatus&&(l.triggerRules=e.conditionValue(n[o].condition)),l.triggerRules.id=n[o].id,t.next=21,e.responseValue(n[o].action_schemas,l);case 21:o++,t.next=14;break;case 24:e.contentLoading=!1,e.initFormData=(0,d.deepClone)((0,r.default)({},{formData:e.formData},{ruleItem:e.ruleItem},{rulesList:e.rulesList}));case 26:case"end":return t.stop()}}),t,e)})))()},conditionValue:function(e){var t=this,i={type:"",list:[]};for(var n in e)i.type=n,e[n].forEach((function(e){var n={};for(var a in e)n.type=a,n.itemList=[],e[a].forEach((function(e){var i={key:e.key,condition:e.operator,meta:e.meta,value:["CHECKBOX","MULTISELECT","MEMBERS","MULTI_MEMBERS","MEMBER"].some((function(t){return t===e.field_type}))?e.value.split(","):e.value,conditionList:[],type:e.field_type};i.conditionList=t.globalChoise.trigger_methods[e.field_type.toLowerCase()],n.itemList.push(i)}));i.list.push(n)}));return i},responseValue:function(e,t){var i=this;return(0,o.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={id__in:e.join(",")},n.next=3,i.$store.dispatch("trigger/getResponseListById",r).then((function(e){var n,r=e.data;t.responseList=[],t.name=r[0].name,r.forEach((n=(0,o.default)(a.default.mark((function e(n){var r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r={id:n.id,way:"",wayInfo:{},performData:{runMode:"BACKEND",displayName:"",repeat:"one"},isLoading:!1}).way=n.component_type,r.wayInfo=JSON.parse((0,s.default)(i.responseWayList.find((function(e){return e.key===n.component_type})))),"api"===r.way?r.wayInfo.field_schema.forEach((function(e){n.params.forEach((function(t){e.key===t.key&&i.$set(e,"value",t.value)}))})):r.wayInfo.field_schema.forEach((function(e){"SUBCOMPONENT"===e.type?n.params.forEach((function(t){t.key===e.key&&e.sub_components.forEach((function(e){t.sub_components.forEach((function(t){t.key===e.key&&(e.checked=!0,e.field_schema.forEach((function(e){t.params.forEach((function(t){e.key===t.key&&(e.referenceType=t.ref_type,e.value=t.value)}))})))}))}))})):n.params.forEach((function(t){e.key===t.key&&(i.$set(e,"value",t.value),i.$set(e,"ref_type",t.ref_type))}))})),r.performData.runMode=n.operate_type,r.performData.displayName=n.display_name,r.performData.repeat=n.can_repeat?"more":"one",t.responseList.push(r);case 8:case"end":return e.stop()}}),e,i)}))),function(e){return n.apply(this,arguments)})),i.rulesList.push(t)})).catch((function(e){(0,f.errorHandler)(e,i)}));case 3:case"end":return n.stop()}}),n,i)})))()},getResponseFields:function(e){var t=this;return(0,o.default)(a.default.mark((function i(){var r;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r={source_uri:e.source_uri,trigger_source_id:t.originInfoToTrigger.id,trigger_source_type:"workflow"},i.next=3,t.$store.dispatch("apiRemote/getRpcData",r).then((function(t){e.choice=t.data.map((function(e){return(0,n.default)({},e,{showFeild:!0,value:""})}))})).catch((function(e){(0,f.errorHandler)(e,t)}));case 3:case"end":return i.stop()}}),i,t)})))()},handleClick:function(){this.iconInfo.status=!0},handleClickOutSide:function(){this.iconInfo.status=!1},changeIcon:function(e){this.iconInfo.key=e.key,this.iconInfo.name=e.name,this.iconInfo.typeName=e.typeName,this.iconInfo.status=!1},addRule:function(){var e=JSON.parse((0,s.default)(this.ruleItem));this.rulesList.push(e),this.$emit("change")},deleteRule:function(e){1!==this.rulesList.length&&(this.rulesList.splice(e,1),this.$emit("change"))},changeName:function(e){e.historyName=e.name,e.nameChange=!0,this.$emit("change")},handleClickName:function(e,t){e.nameChange=!1,"close"===t&&(e.name=e.historyName)},showContent:function(e){e.showContent=!e.showContent},submitTrigger:function(e){var t=this;this.$refs.triggerBasic.validate().then((function(){t.$refs.triggerMade.validate().then((function(){if(!t.checkInfo()){var i={name:t.formData.name,source_type:"basic",source_id:0,signal:t.formData.signal,sender:0,is_draft:e,is_enabled:t.formData.is_enabled,icon:t.iconInfo.typeName,desc:t.formData.desc,project_key:t.$store.state.project.id};t.originInfoToTrigger.id&&(i.source_type=t.originInfoToTrigger.source,i.sender=t.originInfoToTrigger.id,i.source_id=t.originInfoToTrigger.id,i.sender=t.originInfoToTrigger.sender),t.projectId&&(i.project_key=t.projectId),t.triggerInfo.id?t.putTrigger(i):t.creatTrigger(i)}}))}))},checkInfo:function(){var e=this,t=!1;return this.rulesList.forEach((function(i){i.triggerStatus&&i.triggerRules.list.forEach((function(e){e.itemList.forEach((function(e){"non_empty"===e.condition?i.triggerRules.checkStatus=""===e.key:i.triggerRules.checkStatus=""===e.key||""===e.condition||""===e.value}))})),i.responseList.forEach((function(t){e.$set(t,"wayStatus",!t.way),t.wayInfo.field_schema&&("api"===t.wayInfo.key?t.wayInfo.field_schema.forEach((function(e){"api_source"===e.key?t.contentStatus=t.contentStatus?t.contentStatus:!e.apiId:e.apiContent.bodyTableData.forEach((function(e){"array"!==e.type&&"object"!==e.type&&e.is_necessary&&(t.contentStatus=t.contentStatus?t.contentStatus:"CUSTOM"===e.source_type?""===e.value:""===e.value_key)}))})):t.wayInfo.field_schema.forEach((function(e){if("SUBCOMPONENT"===e.type&&e.sub_components&&e.sub_components.length)t.contentStatus=!e.sub_components.some((function(e){return e.checked})),t.contentStatus||e.sub_components.forEach((function(e){e.checked&&e.field_schema.forEach((function(e){e.required&&("MEMBERS"===e.type||"MULTI_MEMBERS"===e.type?t.contentStatus=t.contentStatus?t.contentStatus:e.value.some((function(e){return Array.isArray(e.value)?!e.value.length:!e.value})):t.contentStatus=t.contentStatus?t.contentStatus:!e.value)}))}));else if(e.required){var i=["STARTER_LEADER","ASSIGN_LEADER"];"MEMBERS"===e.type||"MULTI_MEMBERS"===e.type?t.contentStatus=t.contentStatus?t.contentStatus:e.value.some((function(e){return Array.isArray(e.value)?i.includes(e.key)?e.value.length:!e.value.length:!e.value})):t.contentStatus=t.contentStatus?t.contentStatus:"field_value"===e.key?!(e.itemInfo[0].value||e.itemInfo[0].val):!e.value}})),"MANUAL"!==t.performData.runMode||t.contentStatus||(t.contentStatus=!t.performData.displayName))})),t=i.triggerRules.checkStatus||i.responseList.some((function(e){return e.contentStatus||e.wayStatus}))})),t},closeTrigger:function(){this.$emit("closeTrigger")},creatTrigger:function(e){var t=this;this.btnLoading=!0,this.$store.dispatch("trigger/createTriggerRule",e).then((function(e){t.backInfo.triggerInfo=e.data;var i=t.responseParams();t.createRespond(i)})).catch((function(e){(0,f.errorHandler)(e,t),t.btnLoading=!1})).finally((function(){}))},putTrigger:function(e){var t=this;this.btnLoading=!0;var i=this.triggerInfo.id;this.$store.dispatch("trigger/putTriggerRule",{params:e,id:i}).then((function(e){t.backInfo.triggerInfo=e.data;var i=t.responseParams();t.createRespond(i)})).catch((function(e){(0,f.errorHandler)(e,t),t.btnLoading=!1})).finally((function(){}))},createRespond:function(e){var t=this,i=e,n=this.originInfoToTrigger.id;this.$store.dispatch("trigger/createRespond",{id:n,params:i}).then((function(e){t.backInfo.responseList=e.data,t.createTriggerCondition()})).catch((function(e){(0,f.errorHandler)(e,t),t.btnLoading=!1})).finally((function(){}))},responseParams:function(){var e=this,t=[];return this.rulesList.forEach((function(i){i.responseList.forEach((function(n){var a={};n.id&&(a.id=n.id),a.name=i.name,a.display_name=n.performData.displayName,a.operate_type=n.performData.runMode,a.can_repeat="more"===n.performData.repeat,a.component_type=n.wayInfo.key,a.params=[],"api"===n.wayInfo.key?a.params=e.responseApiInfo(n):n.wayInfo.field_schema.forEach((function(t){if("SUBCOMPONENT"===t.type){var i={key:t.key,sub_components:[]};t.sub_components.forEach((function(t){if(t.checked){var n={key:t.key,params:[]};t.field_schema.forEach((function(t){var i={key:t.key,value:e.formattingValue(t),ref_type:t.referenceType};n.params.push(i)})),i.sub_components.push(n)}})),a.params.push(i)}else{var n={key:t.key,value:e.formattingValue(t),ref_type:t.referenceType};a.params.push(n)}})),t.push(a)}))})),t},responseApiInfo:function(e){var t=this,i=[];return e.wayInfo.field_schema.forEach((function(e){if("api_source"===e.key)i.push({key:e.key,value:e.apiId});else{var n={key:e.key,value:{}};n.value=t.treeToJson(e.apiContent.bodyTableData.filter((function(e){return!e.level}))),i.push(n)}})),i},treeToJson:function(e){var t={},i=function e(t,i,n,a){if(i.key)if("array"===i.type){if("array"===a)for(var s in t.push([]),i.children)e(t[t.length-1],i.children[s],1,"array");if("object"===a){var o={};for(var l in o[i.key]=[],(0,r.default)(t,o),i.children)e(t[i.key],i.children[l],1,"array")}}else if("object"===i.type){var c={};if("array"===a)for(var u in t.push(c),i.children)e(t[t.length-1],i.children[u],1,"object");if("object"===a)for(var f in c[i.key]={},(0,r.default)(t,c),i.children)e(t[i.key],i.children[f],1,"object")}else{if("number"===i.type&&(i.value=Number(i.value)),"array"===a){var d={is_leaf:"object"!==i.type&&"array"!==i.type,ref_type:"CUSTOM"===i.source_type?"custom":"reference",value:"CUSTOM"===i.source_type?i.value:i.value_key};t.push(d)}if("object"===a){var m={};m[i.key]={is_leaf:"object"!==i.type&&"array"!==i.type,ref_type:"CUSTOM"===i.source_type?"custom":"reference",value:"CUSTOM"===i.source_type?i.value:i.value_key},(0,r.default)(t,m)}}};for(var n in e)i(t,e[n],0,"object");return t},formattingValue:function(e){var t="";return"receivers"===e.key||"MEMBERS"===e.type||"MEMBER"===e.type?(t=[],e.value.forEach((function(e){var i={ref_type:"VARIABLE"===e.key?"reference":"custom",value:{member_type:e.key,members:Array.isArray(e.value)?e.value.join(","):e.value}};t.push(i)}))):t="VARIABLE"===e.value?Array.isArray(e.insertValue)?e.insertValue.join(","):e.insertValue:e.itemInfo&&e.itemInfo[0].id?e.itemInfo[0].value||e.itemInfo[0].val:e.value,t},createTriggerCondition:function(){var e=this,t=this.conditionParams(),i=this.backInfo.triggerInfo.id;this.$store.dispatch("trigger/batchTriggerCondition",{params:t,id:i}).then((function(){e.$bkMessage({message:e.triggerInfo.id?e.$t("m.common['保存成功']"):e.$t("m.trigger['创建成功']"),theme:"success"}),e.closeTrigger(),e.$emit("getList")})).catch((function(t){(0,f.errorHandler)(t,e)})).finally((function(){e.btnLoading=!1}))},conditionParams:function(){var e=this,t=[],i=0;return this.rulesList.forEach((function(n){var a={condition:{},name:n.name,by_condition:n.triggerStatus,action_schemas:[]};n.triggerRules.id&&(a.id=n.triggerRules.id),n.triggerStatus?(a.condition[n.triggerRules.type]=[],n.triggerRules.list.forEach((function(e){var t={};t[e.type]=[],e.itemList.forEach((function(i){var n={key:i.key,value:Array.isArray(i.value)?i.value.join(","):i.value,field_type:i.type,operator:i.condition,type:"custom"};t[e.type].push(n)})),a.condition[n.triggerRules.type].push(t)}))):a.condition="",n.responseList.forEach((function(t,n){a.action_schemas.push(e.backInfo.responseList[i+n])})),i+=n.responseList.length,t.push(a)})),t},getTriggerRules:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={trigger_id:e.triggerInfo.id},t.next=3,e.$store.dispatch("trigger/getTriggerRules",i).then((function(t){e.triggerAllRules=t.data})).catch((function(t){(0,f.errorHandler)(t,e)})).finally((function(){}));case 3:case"end":return t.stop()}}),t,e)})))()},getResponseList:function(){var e=this;return(0,o.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("trigger/getResponseList").then(function(){var t=(0,o.default)(a.default.mark((function t(i){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.responseWayList=i.data,e.originInfoToTrigger.id&&"task"!==e.originInfoToTrigger.source?e.responseWayList.forEach((function(t){var i;t.field_schema.forEach((i=(0,o.default)(a.default.mark((function t(i){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("RPC"!==i.source_type){t.next=3;break}return t.next=3,e.getResponseFields(i);case 3:case"end":return t.stop()}}),t,e)}))),function(e){return i.apply(this,arguments)}))})):e.responseWayList=e.responseWayList.filter((function(e){return"modify_field"!==e.key&&"modify_specified_state_processor"!==e.key}));case 2:case"end":return t.stop()}}),t,e)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){(0,f.errorHandler)(t,e)}));case 2:case"end":return t.stop()}}),t,e)})))()},giveTableVariables:function(e){var t=this;this.formData.variableLoading=!0,this.$store.dispatch("basicModule/get_trigger_tables",e).then((function(e){var i=e.data.fields;i.forEach((function(e){e.name+=t.$t("m.trigger['（基础模型）']")})),t.$store.commit("trigger/changeTriggerVariables",t.globalChoise.ticket_variables.concat(i))})).catch((function(e){(0,f.errorHandler)(e,t)})).finally((function(){t.formData.variableLoading=!1}))}}}},f1Q0:function(e,t,i){"use strict";i.r(t);var n=i("Lbk4"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},f3v2:function(e,t,i){"use strict";i.r(t);var n=i("NesJ"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},f5Dy:function(e,t,i){"use strict";i.r(t);var n=i("WzOL"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"f5y/":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"render-view",staticStyle:{"margin-left":"10px"}},e._l(e.formData,(function(i,n){return t("div",{key:n+new Date,staticClass:"view-item-wrap"},[t("ViewItem",{attrs:{"top-index":n,"is-top":!0,scheme:e.getScheme(i),form:i}})],1)})),0)},a=[];n._withStripped=!0},f7Ks:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-input",{class:{"bk-border-error":e.item.checkValue},attrs:{maxlength:120,disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.desc},on:{focus:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},f9M4:function(e,t,i){},fOTe:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"Sideslider",components:{RenderView:function(){return Promise.resolve().then(i.bind(null,"FCVG"))}},props:{title:{type:String,default:""},formData:{type:Array,default:function(){return[]}},context:{type:Object,default:function(){return{schemes:{}}}},width:{type:[String,Number],default:800}},data:function(){return{isShow:!0}}}},fX4K:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("div",{staticClass:"bk-form-width"},[t("bk-select",{attrs:{clearable:!1,disabled:e.disabled,searchable:""},on:{selected:e.getSecondLevelList},model:{value:e.formData.levelOne,callback:function(t){e.$set(e.formData,"levelOne",t)},expression:"formData.levelOne"}},e._l(e.firstLevelList,(function(e){return t("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1)],1),e._v(" "),"ORGANIZATION"!==e.formData.levelOne?["VARIABLE"===e.formData.levelOne?t("div",{staticClass:"bk-form-width"},[t("bk-select",{attrs:{loading:e.isLoading,disabled:e.disabled,"show-select-all":"",multiple:"",searchable:""},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}},e._l(e.frontMemberField,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.key,name:e.name}})})),1)],1):"PERSON"===e.formData.levelOne?t("div",{staticClass:"bk-form-width"},[t("member-select",{attrs:{disabled:e.disabled},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}})],1):"CMDB"===e.formData.levelOne?t("div",{staticClass:"bk-form-width"},[t("bk-select",{attrs:{loading:e.isLoading,"show-select-all":"",multiple:"",searchable:""},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}},e._l(e.secondLevelList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1):"GENERAL"===e.formData.levelOne?t("div",{staticClass:"bk-form-width"},[t("bk-select",{attrs:{loading:e.isLoading,disabled:e.disabled,searchable:""},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}},e._l(e.secondLevelList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1):e._e()]:e._e(),e._v(" "),"ORGANIZATION"===e.formData.levelOne?t("div",{staticClass:"bk-form-width"},[t("select-tree",{attrs:{list:e.organizationList},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}})],1):e._e()],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},a=[];n._withStripped=!0},fkix:function(e,t,i){"use strict";i.r(t);var n=i("NXOa"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},g2DR:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-table",{attrs:{data:e.item.val,size:"small"}},[e._l(e.item.choice,(function(i){return[t("bk-table-column",{key:i.key,attrs:{label:i.name},scopedSlots:e._u([{key:"default",fn:function(n){return[t("bk-input",{attrs:{clearable:!0,disabled:e.disabled},model:{value:n.row[i.key],callback:function(t){e.$set(n.row,i.key,t)},expression:"props.row[title.key]"}})]}}],null,!0)})]})),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.user['操作']"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("bk-button",{attrs:{theme:"primary",disabled:e.disabled,text:""},on:{click:e.addOne}},[e._v("\n            "+e._s(e.$t('m.newCommon["添加"]'))+"\n          ")]),e._v(" "),t("bk-button",{attrs:{theme:"primary",disabled:e.disabled,text:""},on:{click:function(t){return e.deleteOne(i)}}},[e._v("\n            "+e._s(e.$t('m.newCommon["删除"]'))+"\n          ")])]}}],null,!1,1830905243)})],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},"g9b+":function(e,t,i){"use strict";i.r(t);var n=i("fX4K"),a=i("x+JR");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("1u4o");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"8c164c82",null);t.default=o.exports},gEzK:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeTree,expression:"closeTree"}],staticClass:"bk-search-tree bk-form-width",class:{"bk-border-error":e.item.checkValue}},[t("div",{staticClass:"bk-search-tree-wrapper",class:{bkdisabled:e.disabled},on:{click:function(t){return t.stopPropagation(),e.showTree.apply(null,arguments)}}},[t("span",{class:{"bk-color-tree":e.treeSlectInfo.info.name}},[e._v("\n          "+e._s(e.treeSlectInfo.info.showName||e.$t('m.newCommon["请选择"]'))+"\n        ")]),e._v(" "),t("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]),e._v(" "),t("transition",{attrs:{name:"common-fade"}},[e.treeSlectInfo.show?[e.treeSlectInfo.treeDataList.length?t("div",{staticClass:"bk-search-tree-content"},[t("export-tree",{attrs:{"tree-data-list":e.treeSlectInfo.treeDataList},on:{toggle:e.toggleInfo,toggleChildren:e.toggleChildren}})],1):t("div",{staticClass:"bk-search-tree-content"},[t("p",{staticClass:"bk-search-tree-nodata"},[e._v(e._s(e.$t('m.treeinfo["暂无数据"]')))])])]:e._e()],2)],1)]),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},a=[];n._withStripped=!0},gHwO:function(e,t,i){},gMgb:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tag-table"},[e.hiddenLabel?e._e():t("label",{staticClass:"table-label"},[e._v(e._s(e.label))]),e._v(" "),t("bk-table",{ref:"tagTable",attrs:{data:e.form.value,border:!0}},e._l(e.column,(function(i){return t("bk-table-column",{key:i.key,attrs:{label:i.name,prop:i.key},scopedSlots:e._u([{key:"default",fn:function(n){return[t("ViewItem",{attrs:{scheme:e.getScheme(i,n.row[i.key]),form:n.row[i.key]}})]}}],null,!0)})})),1)],1)},a=[];n._withStripped=!0},gdLX:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-dialog-form"},[t("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isDataLoading},expression:"{ isLoading: isDataLoading }"}],ref:"table",attrs:{data:e.dataList,size:"small"},on:{"select-all":e.handleSelectAll,select:e.handleSelect}},[t("bk-table-column",{attrs:{type:"selection",width:"60",align:"center",selectable:e.disabledFn}}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['字段名称']"),prop:"name"}}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['唯一标识']"),prop:"key"}}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['字段类型']"),prop:"typeName"}}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['是否只读']")},scopedSlots:e._u([{key:"default",fn:function(i){return[t("bk-radio-group",{model:{value:i.row.is_readonly,callback:function(t){e.$set(i.row,"is_readonly",t)},expression:"props.row.is_readonly"}},[t("bk-radio",{staticClass:"mr20",attrs:{value:e.trueStatus,disabled:"priority"===i.row.key||i.row.is_disabled}},[e._v("\n            "+e._s(e.$t('m.treeinfo["是"]'))+"\n          ")]),e._v(" "),t("bk-radio",{attrs:{value:e.falseStatus,disabled:"priority"===i.row.key||i.row.is_disabled}},[e._v("\n            "+e._s(e.$t('m.treeinfo["否"]'))+"\n          ")])],1)]}}])})],1)],1)},a=[];n._withStripped=!0},"gr+U":function(e,t,i){"use strict";i.r(t);var n=i("vXIu"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},gt7i:function(e,t,i){"use strict";i.r(t);var n=i("JXR1"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},gy7N:function(e,t,i){"use strict";i.r(t);var n=i("eqfU"),a=i("t9cD");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("tPsg");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"588a75c2",null);t.default=o.exports},h1eg:function(e,t,i){"use strict";i.r(t);var n=i("Y9oG"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},h4G3:function(e,t,i){"use strict";i("nTEs")},hA3y:function(e,t,i){"use strict";i.r(t);var n=i("tl4E"),a=i("jvs4");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("CQIX");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"7add65fd",null);t.default=o.exports},hAcJ:function(e,t,i){"use strict";i.r(t);var n=i("zfNu"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"hF++":function(e,t,i){},hHxK:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("QbLZ")),a=o(i("q9fp")),r=i("L2JU"),s=o(i("b1K/"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"changeConductor",components:{memberInfo:a.default},props:{itemInfo:{type:Object,default:function(){return{}}},origin:{type:String,default:"normal"},index:{type:Number},isShowVar:{type:Boolean,default:function(){return!0}}},data:function(){return{precision:0,insertValue:"",variableList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,r.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.variableList=e}},created:function(){if(("SELECT"===this.itemInfo.type||"MULTISELECT"===this.itemInfo.type)&&this.itemInfo.use_variable&&!this.itemInfo.choice.some((function(e){return"VARIABLE"===e.key}))){this.itemInfo.choice.push({key:"VARIABLE",name:"引用变量"});var e="MULTISELECT"===this.itemInfo.type?[]:"";this.$set(this.itemInfo,"insertValue",e)}this.$set(this.itemInfo,"referenceType",this.itemInfo.referenceType||"custom"),this.itemInfo.ref_type?(this.itemInfo.referenceType=this.itemInfo.ref_type,"reference"===this.itemInfo.ref_type?"SELECT"!==this.itemInfo.type&&"MULTISELECT"!==this.itemInfo.type||(this.itemInfo.insertValue="MULTISELECT"===this.itemInfo.type?this.itemInfo.value.split(","):this.itemInfo.value,this.itemInfo.value="VARIABLE"):"MULTISELECT"===this.itemInfo.type&&(this.itemInfo.value=this.itemInfo.value?this.itemInfo.value.split(","):[])):"MULTISELECT"===this.itemInfo.type&&(this.itemInfo.value=this.itemInfo.value?this.itemInfo.value.split(","):[])},mounted:function(){this.variableList=this.triggerVariables},methods:{changeInsert:function(e){this.itemInfo.value=(0,s.default)(this.$el.querySelector(".bk-form-textarea, .bk-form-input"),"conductorId"+this.index,this.itemInfo.value,"${"+e+"}",this),this.itemInfo.referenceType="import",this.insertValue=""},changeImport:function(){this.itemInfo.referenceType="reference"},changeMessagePanel:function(e){e&&"message"===this.origin&&this.$emit("change-panel-status")}}}},hftF:function(e,t,i){"use strict";i.r(t);var n=i("gMgb"),a=i("sRDs");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("6jts"),i("dD0k");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"75b3441b",null);t.default=o.exports},hj6f:function(e,t,i){"use strict";i("Zicn")},"hk/f":function(e,t,i){"use strict";i.r(t);var n=i("x6yq"),a=i("C6tm");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("lI7c");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"0bbd7fbd",null);t.default=o.exports},hmS1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i("m1cH")),a=c(i("gDS+")),r=c(i("GQeE")),s=c(i("14Xm")),o=c(i("D3Ub")),l=c(i("VflG"));function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"postParam",mixins:[l.default],props:{changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){}},stateList:{type:Array,default:function(){return[]}},isStatic:{type:Boolean,default:function(){return!1}},isCustom:{type:Boolean,default:!1},bodyValue:{type:Object,default:function(){}},entry:{type:String,default:function(){return""}},formInfo:{type:Object,default:function(){return{}}}},data:function(){return{trueSatatus:!0,falseSatatus:!1,lala:{value:"111",offsetTop:""},bodyTableData:[],paramTableData:[],checkInfo:{name:"",road:""},sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],paramTableInfo:{value:"",placeholder:this.$t('m.treeinfo["请选择数据来源"]')}}},computed:{tableList:function(){return this.bodyTableData.filter((function(e){return e.isShow}))}},watch:{apiDetail:function(){this.initData()}},mounted:function(){var e=this;return(0,o.default)(s.default.mark((function t(){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.isStatic;case 2:return t.next=4,e.bodyValue;case 4:return t.next=6,e.initData();case 6:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){this.bodyTableDataChange()},bodyTableDataChange:function(){var e=this;return(0,o.default)(s.default.mark((function t(){var i;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,r.default)(e.apiDetail.req_body).length){t.next=5;break}e.apiDetail.treeDataList=[{has_children:!1,showChildren:!0,checkInfo:!1,key:"root",is_necessary:!0,type:"object",desc:e.$t('m.treeinfo["初始化数据"]'),parentInfo:"",children:[]}],e.apiDetail.bodyTableData=[],t.next=12;break;case 5:return t.next=7,e.jsonschemaToList({root:JSON.parse((0,a.default)(e.apiDetail.req_body))});case 7:return e.apiDetail.treeDataList=t.sent,e.isStatic||e.isCustom?e.apiDetail.treeDataList=e.jsonValueToTree(e.bodyValue,JSON.parse((0,a.default)(e.apiDetail.treeDataList))):e.changeInfo.api_info&&e.changeInfo.api_info.remote_api_id===e.apiDetail.id&&(e.apiDetail.treeDataList=e.jsonValueToTree(e.changeInfo.api_info.req_body,JSON.parse((0,a.default)(e.apiDetail.treeDataList)))),t.next=11,e.treeToTableList(JSON.parse((0,a.default)(e.apiDetail.treeDataList[0].children)));case 11:e.apiDetail.bodyTableData=t.sent;case 12:return t.next=14,JSON.parse((0,a.default)(e.apiDetail.bodyTableData));case 14:return i=t.sent,t.next=17,i.forEach((function(e){e.isCheck=!1,e.isSatisfied=!1,e.el=null,e.customValue=e.value||"",e.name=e.key||"",e.children=[],e.source_type=e.source_type||"CUSTOM",e.value=void 0!==e.value?e.value:"",e.value_key=void 0!==e.value_key&&e.value_key.toString()?e.value_key:""}));case 17:return t.next=19,e.recordChildren(i);case 19:return t.next=21,i;case 21:e.bodyTableData=t.sent;case 22:case"end":return t.stop()}}),t,e)})))()},recordChildren:function(e,t){for(var i=e.map((function(e){return e.level})),a=Math.max.apply(Math,(0,n.default)(i)),r=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0].children.push(t)}(e,t)}))},s=a;s>(t||0);s--)r(s)},changeState:function(e){e.showChildren=!e.showChildren,e.children.forEach((function(t){t.isShow=e.showChildren})),e.showChildren||this.closeChildren(e)},closeChildren:function(e){var t=this;e.children.forEach((function(e){e.isShow=!1,e.has_children&&(e.showChildren=!1,t.closeChildren(e))}))},changeType:function(){},countChildren:function(e){var t=this;return(0,o.default)(s.default.mark((function i(){var n,a;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,a=function e(t){if(t.children&&t.children.length)for(var i=0;i<t.children.length;i++)n+=1,e(t.children[i])},t.next=4,a(e);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),i,t)})))()},cleanValue:function(e){var t=this;return(0,o.default)(s.default.mark((function i(){var n,r;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse((0,a.default)(e)),r=function e(t){if(t.value="",t.source_type="CUSTOM",t.children&&t.children.length)for(var i=0;i<t.children.length;i++)e(t.children[i])},t.next=4,r(n);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),i,t)})))()},countSon:function(e){return 1===this.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey}))[0].children.length},addChildren:function(e){var t=this;return(0,o.default)(s.default.mark((function i(){var r,o,l,c,u,f;return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=t.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey}))[0],l=t.bodyTableData.indexOf(o)+1,i.next=4,t.countChildren(o);case 4:return c=i.sent,i.next=7,t.cleanValue(o.children[0]);case 7:return u=i.sent,i.next=10,t.treeToTableList(JSON.parse((0,a.default)([].concat((0,n.default)(o.children),[u]))),o.level+1,o.primaryKey,"array",o.ancestorsList);case 10:return f=i.sent,i.next=13,f.forEach((function(e){e.children=[]}));case 13:return o.children=f.filter((function(e){return e.level===o.level+1})),i.next=16,t.recordChildren(f,o.level+1);case 16:(r=t.bodyTableData).splice.apply(r,[l,c].concat((0,n.default)(f)));case 17:case"end":return i.stop()}}),i,t)})))()},deletChildren:function(e){var t=this;return(0,o.default)(s.default.mark((function i(){var n,a,r;return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.countSon(e)){i.next=2;break}return i.abrupt("return");case 2:if(!((n=t.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey}))[0].children).length<=1)){i.next=5;break}return i.abrupt("return");case 5:return n.splice(n.indexOf(e),1),a=t.bodyTableData.indexOf(e),i.next=9,t.countChildren(e);case 9:r=i.sent,t.bodyTableData.splice(a,r+1);case 11:case"end":return i.stop()}}),i,t)})))()},changeField:function(e,t){var i=this;return(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e,i)})))()},addNewItem:function(e){this.$emit("addNewItem",e)}}}},"hv+2":function(e,t,i){"use strict";i.r(t);var n=i("OjZH"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},iGEm:function(e,t,i){"use strict";i("6z7N")},iYOz:function(e,t,i){},ibAw:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("4d7F"));t.default=function(e,t){return new n.default((function(i){window.app.$bkInfo({title:e||a.default.$t('m["确定离开当前页？"]'),subTitle:t||a.default.$t('m["离开将会导致未保存信息丢失"]'),okText:a.default.$t('m["离开"]'),confirmFn:function(){return i(!0)},cancelFn:function(){return i(!1)}})}))};var a=r(i("EstQ"));function r(e){return e&&e.__esModule?e:{default:e}}},in5P:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild&&!e.loading?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"ext-cls":"bk-line-height","desc-type":"icon"}},[t("bk-checkbox-group",{ref:e.item.key,attrs:{value:e.selects},on:{change:e.selected}},e._l(e.item.choice,(function(i){return t("bk-checkbox",{key:i.key,attrs:{value:i.key,disabled:e.disabled,"ext-cls":"mr20"}},[e._v(e._s(i.name)+"\n      ")])})),1),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},ioCs:function(e,t,i){"use strict";i.r(t);var n=i("11QV"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},j7Oh:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("QbLZ")),a=l(i("14Xm")),r=l(i("D3Ub")),s=l(i("efIh")),o=l(i("2Vgw"));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"INPUTSELECT",mixins:[s.default],props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{options:[],addStatus:!1,tempChoice:{name:"",key:""}}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)},"item.choice":function(e,t){"API"!==this.item.source_type&&"DATADICT"!==this.item.source_type&&"RPC"!==this.item.source_type||t.length===e.length||this.getOption()}},mounted:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!e.item.val&&e.item.value&&(e.item.val=e.item.value),t.next=3,e.getOption();case 3:i=e.judgeValue(e.item.val,e.item.choice),e.item.val=i?e.item.val:"",e.conditionField(e.item,e.fields);case 6:case"end":return t.stop()}}),t,e)})))()},methods:{getOption:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldOptions(e.item);case 2:e.item.choice=t.sent,e.options=e.item.choice;case 4:case"end":return t.stop()}}),t,e)})))()},selected:function(){var e=this;this.item.related_fields&&this.item.related_fields.be_relied&&this.item.related_fields.be_relied.forEach((function(t){e.fields.forEach((function(e){t===e.key&&(e.value="",e.val=e.value)}))}))},giveDefaultKey:function(){var e=this;this.tempChoice.name&&!this.tempChoice.key&&(this.tempChoice.key="",(0,o.default)(this.tempChoice.name,{style:o.default.STYLE_NORMAL,heteronym:!1}).forEach((function(t){e.tempChoice.key+=""+t})),this.tempChoice.key=this.tempChoice.key.toUpperCase().replace(/\ /g,"_"),this.tempChoice.key.length>=32&&(this.tempChoice.key=this.tempChoice.key.substr(0,32)))},confirmAdd:function(){this.tempChoice.name&&(this.addStatus=!1,this.options.push((0,n.default)({},this.tempChoice,{can_delete:!0})),this.item.val=this.tempChoice.key,this.tempChoice.key="",this.tempChoice.name=this.tempChoice.key)},cancelAdd:function(){this.addStatus=!1,this.tempChoice.key="",this.tempChoice.name=this.tempChoice.key},handleDeleteOption:function(e){e===this.item.val&&(this.item.val=""),this.options=this.options.filter((function(t){return t.key!==e}))}}}},"jD+q":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-customtable-data"},e._l(e.customTableInfo.list,(function(i,n){return t("div",{key:n,staticClass:"bk-custom-line",class:{mb10:n!==e.customTableInfo.list.length-1}},[t("bk-input",{attrs:{"ext-cls":"bk-custom-input",clearable:!0,placeholder:e.$t("m.treeinfo['请输入名称']")},model:{value:i.name,callback:function(t){e.$set(i,"name",t)},expression:"item.name"}}),e._v(" "),t("bk-checkbox",{staticStyle:{float:"left","margin-right":"10px","line-height":"32px"},attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus},model:{value:i.required,callback:function(t){e.$set(i,"required",t)},expression:"item.required"}},[e._v("\n      "+e._s(e.$t("m.treeinfo['必填']"))+"\n    ")]),e._v(" "),t("bk-select",{attrs:{"ext-cls":"bk-custom-small",clearable:!1,searchable:""},model:{value:i.display,callback:function(t){e.$set(i,"display",t)},expression:"item.display"}},e._l(e.typeList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:i.choice,expression:"item.choice",modifiers:{trim:!0}}],staticClass:"bk-form-textarea bk-textarea-tanble",staticStyle:{width:"180px","min-height":"32px"},attrs:{placeholder:e.$t("m.treeinfo['请输入，Enter分隔']"),disabled:"select"!==i.display&&"multiselect"!==i.display},domProps:{value:i.choice},on:{input:function(t){t.target.composing||e.$set(i,"choice",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),t("div",{staticClass:"bk-custom-icon"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(t){return e.addTableData(i,n)}}}),e._v(" "),t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.customTableInfo.list.length},on:{click:function(t){return e.reduceTableData(i,n)}}})])],1)})),0)},a=[];n._withStripped=!0},jFOa:function(e,t,i){"use strict";i.r(t);var n=i("gdLX"),a=i("eofb");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},jK1o:function(e,t,i){},jUNn:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modify-fields"},[t("bk-form-item",{attrs:{"ext-cls":"bk-field-schema",label:e.fieldKeyItem.name,required:e.fieldKeyItem.required,desc:e.fieldKeyItem.tips}},[t("bk-select",{staticStyle:{width:"270px"},attrs:{"ext-cls":"bk-insert-info",searchable:""},on:{selected:e.selectedFieldKey},model:{value:e.fieldKeyItem.value,callback:function(t){e.$set(e.fieldKeyItem,"value",t)},expression:"fieldKeyItem.value"}},e._l(e.fieldKeyItem.choice,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),e.fieldKeyItem.value?[t("bk-form-item",{attrs:{"ext-cls":"bk-field-schema",label:e.fieldValueItem.name,required:e.fieldValueItem.required,desc:e.fieldValueItem.tips}},[t("div",{staticStyle:{float:"left",width:"268px"}},[t("bk-select",{attrs:{clearable:!1,searchable:""},on:{selected:e.selectedReference},model:{value:e.fieldValueItem.referenceType,callback:function(t){e.$set(e.fieldValueItem,"referenceType",t)},expression:"fieldValueItem.referenceType"}},e._l(e.sourceTypeList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),"custom"===e.fieldValueItem.referenceType?t("div",{staticStyle:{float:"left",width:"268px","margin-left":"10px"}},[e.show?t("field-info",{attrs:{fields:e.fieldValueItem.itemInfo,origin:"trigger"}}):e._e()],1):e._e(),e._v(" "),"reference"===e.fieldValueItem.referenceType?t("div",{staticStyle:{float:"left",width:"268px","margin-left":"10px"}},[t("bk-select",{staticStyle:{width:"270px"},attrs:{"ext-cls":"bk-insert-info",searchable:""},model:{value:e.fieldValueItem.itemInfo[0].value,callback:function(t){e.$set(e.fieldValueItem.itemInfo[0],"value",t)},expression:"fieldValueItem.itemInfo[0].value"}},e._l(e.variableList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1):e._e()])]:e._e()],2)},a=[];n._withStripped=!0},jWXv:function(e,t,i){e.exports={default:i("+iuc"),__esModule:!0}},jeD0:function(e,t,i){"use strict";i("qmm4")},jfEP:function(e,t,i){},jub7:function(e,t,i){"use strict";i.r(t);var n=i("f7Ks"),a=i("0rd9");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},jvs4:function(e,t,i){"use strict";i.r(t);var n=i("4lVZ"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},k85c:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("UsFA"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"RenderView",components:{ViewItem:r.default},props:{formData:{type:Array,default:function(){return[]}},context:{type:Object,default:function(){return{}}}},provide:function(){var e=this;return{getContext:function(){return e.context}}},data:function(){return{isRootRenderView:null,value:{}}},created:function(){this.initRenderView()},methods:{getScheme:function(e){return this.context.schemes[e.scheme]?this.context.schemes[e.scheme]:{}},initRenderView:function(){for(var e=this,t=!1;!t&&e.$parent;)"render-view"===e.$parent.$options._componentTag?t=!0:e=e.$parent;this.isRootRenderView=!t}}}},kQq5:function(e,t,i){"use strict";i.r(t);var n=i("mE3A"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},kSST:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),a=s(i("D3Ub")),r=s(i("efIh"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"SELECT",mixins:[r.default],props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{options:[]}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)},"item.choice":function(e,t){"API"!==this.item.source_type&&"DATADICT"!==this.item.source_type&&"RPC"!==this.item.source_type||t.length===e.length||this.getOption()}},mounted:function(){var e=this;return(0,a.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!e.item.val&&e.item.value&&(e.item.val=e.item.value),t.next=3,e.getOption();case 3:i=e.judgeValue(e.item.val,e.item.choice),e.item.val=i?e.item.val:"",e.conditionField(e.item,e.fields);case 6:case"end":return t.stop()}}),t,e)})))()},methods:{getOption:function(){var e=this;return(0,a.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldOptions(e.item);case 2:e.item.choice=t.sent,e.options=e.item.choice;case 4:case"end":return t.stop()}}),t,e)})))()},selected:function(){var e=this;this.item.related_fields&&this.item.related_fields.be_relied&&this.item.related_fields.be_relied.forEach((function(t){e.fields.forEach((function(e){t===e.key&&(e.value="",e.val=e.value)}))}))}}}},kvWR:function(e,t,i){"use strict";i("+LW1")},l3JT:function(e,t,i){"use strict";i("PLXv")},lAAG:function(e,t,i){"use strict";i.r(t);var n=i("jD+q"),a=i("9psX");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("SLTv");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"96b3fa0c",null);t.default=o.exports},lI7c:function(e,t,i){"use strict";i("vT7S")},lNfD:function(e,t,i){},lR6s:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("2eEL"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"Tree",components:{collapseTransition:r.default},props:{treeDataList:{type:Array,default:[]},treeIndex:{type:Number,default:0}},data:function(){return{pLeft:"padding-left:"+15*(this.treeIndex+1)+"px; padding-right: 10px;"}},methods:{toggleChildren:function(e){this.$emit("toggleChildren",e)},toggle:function(e){this.$emit("toggle",e)}}}},lSBQ:function(e,t,i){"use strict";i("WenH")},lVyC:function(e,t,i){"use strict";i("MX/Q")},lWSq:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("14Xm")),a=l(i("D3Ub")),r=l(i("efIh")),s=l(i("u8Ap")),o=l(i("EP+X"));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"MEMBERS",components:{memberSelect:s.default,businessCard:o.default},mixins:[r.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{selectedItems:[]}},watch:{"item.val":function(e){this.selectedItems=e?e.split(","):[]}},mounted:function(){var e=this;return(0,a.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.selectedItems=e.item.val?e.item.val.split(","):[],e.conditionField(e.item,e.fields);case 2:case"end":return t.stop()}}),t,e)})))()},methods:{onMemberSelectChange:function(e){this.item.val=e.join(",")}}}},lpJK:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-table",{attrs:{data:e.item.val,size:"small"}},[e._l(e.item.meta.columns,(function(i){return[t("bk-table-column",{key:i.key,attrs:{label:i.name},scopedSlots:e._u([{key:"default",fn:function(n){return["input"===i.display?[t("bk-input",{attrs:{clearable:!0,disabled:e.disabled},model:{value:n.row[i.key],callback:function(t){e.$set(n.row,i.key,t)},expression:"props.row[columnItem.key]"}})]:e._e(),e._v(" "),"select"===i.display?[t("bk-select",{attrs:{searchable:"","font-size":"medium","popover-min-width":180,disabled:e.disabled},model:{value:n.row[i.key],callback:function(t){e.$set(n.row,i.key,t)},expression:"props.row[columnItem.key]"}},e._l(i.choice,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"multiselect"===i.display?[t("bk-select",{attrs:{searchable:"",multiple:"","popover-min-width":180,"font-size":"medium",disabled:e.disabled,"show-select-all":""},model:{value:n.row[i.key],callback:function(t){e.$set(n.row,i.key,t)},expression:"props.row[columnItem.key]"}},e._l(i.choice,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"date"===i.display?[t("bk-date-picker",{attrs:{transfer:!0,disabled:e.disabled},model:{value:n.row[i.key],callback:function(t){e.$set(n.row,i.key,t)},expression:"props.row[columnItem.key]"}})]:e._e(),e._v(" "),"datetime"===i.display?[t("bk-date-picker",{attrs:{transfer:!0,disabled:e.disabled,type:"datetime"},model:{value:n.row[i.key],callback:function(t){e.$set(n.row,i.key,t)},expression:"props.row[columnItem.key]"}})]:e._e()]}}],null,!0)})]})),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.user['操作']"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("bk-button",{attrs:{theme:"primary",text:"",disabled:e.disabled},on:{click:e.addOne}},[e._v("\n            "+e._s(e.$t('m.newCommon["添加"]'))+"\n          ")]),e._v(" "),t("bk-button",{attrs:{theme:"primary",text:"",disabled:e.disabled},on:{click:function(t){return e.deleteOne(i)}}},[e._v("\n            "+e._s(e.$t('m.newCommon["删除"]'))+"\n          ")])]}}],null,!1,3418295963)})],2)],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},a=[];n._withStripped=!0},m4Da:function(e,t,i){},mE3A:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("rfXi")),a=o(i("R5iJ")),r=o(i("CXV/")),s=o(i("W3y+"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"bk-upload",props:{name:{type:String,default:"upload_file"},multiple:{type:Boolean,default:!0},accept:{type:String,default:"*"},delayTime:{type:Number,default:0},url:{required:!0,type:String},size:{type:[Number,Object],default:function(){return{maxFileSize:5,maxImgSize:1}}},handleResCode:{type:Function,default:function(e){return 0===e.code}},header:[Array,Object],tip:{type:String,default:""},validateName:{type:RegExp},withCredentials:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{dragText:"支持的附件格式：txt，log，pdf，doc，ppt，xls，docx，pptx，xlsx，zip，jpg，png，每个文件不超过200Mb",clickText:"点击上传",showDialog:!0,fileList:[],width:0,barEl:null,fileIndex:null,speed:0,total:0,unit:"kb/s",isdrag:!1,progress:0,uploadIcon:s.default}},watch:{fileIndex:function(e){null!==e&&e<this.fileList.length&&this.uploadFile(this.fileList[e],e)}},methods:{filesize:function(e){var t=e/1e3;if(t<1)return e.toFixed(3)+" KB";var i=t.toString().indexOf(".");return t.toString().slice(0,i+2)+" MB"},selectFile:function(e){var t=this,i=(0,n.default)(e.target.files);if(i.length){i.forEach((function(e,i){var n={name:e.name,originSize:e.size,size:e.size/1e3,maxFileSize:null,maxImgSize:null,type:e.type,fileHeader:"",origin:e,base64:"",status:"",done:!1,responseData:"",speed:null,errorMsg:"",progress:""},a=n.type.indexOf("/"),r=n.type.slice(0,a),s=n.type.indexOf("application/x-photoshop")>-1;n.fileHeader=r,"number"==typeof t.size?(n.maxFileSize=t.size,n.maxImgSize=t.size):(n.maxFileSize=t.size.maxFileSize,n.maxImgSize=t.size.maxImgSize),("image"===r||s)&&t.handleImage(n,e),("image"!==r||!s)&&n.size>1e3*n.maxFileSize&&(n.errorMsg="文件不能超过"+n.maxFileSize+"MB"),t.validateName&&(t.validateName.test(n.name)||(n.errorMsg="文件名不合法")),t.fileList.push(n)}));var a=this.fileList.length,r=this.fileIndex;a-1===r?this.uploadFile(this.fileList[r],r):this.fileIndex=0,e.target.value=""}},hideFileList:function(){var e=this;this.delayTime&&setTimeout((function(){e.fileList=[]}),this.delayTime)},uploadFile:function(e){var t=this;if(e.errorMsg)return this.fileIndex+=1,void(e.progress="100%");var i=new FormData,n=new XMLHttpRequest;i.append(this.name,e.origin),this.isdrag=!1,e.xhr=n,n.onreadystatechange=function(){if(4===n.readyState){try{var i=JSON.parse(n.responseText);200===n.status&&t.handleResCode(i)?(e.done=!0,e.responseData=i,t.$emit("on-success",t.fileList)):(e.errorMsg=i.message,t.$emit("on-error",e,t.fileList))}catch(t){e.progress="100%",e.errorMsg=error.message}t.fileIndex+=1,t.unit="kb/s",t.total=0,e.status="done",t.fileIndex===t.fileList.length&&(t.$emit("on-done",t.fileList),t.hideFileList())}};if(n.upload.addEventListener("progress",(function(i){if(i.lengthComputable){var n=Math.round(100*i.loaded/i.total),a=Math.round(i.loaded/1e3);e.progress=n+"%",t.speed=a-t.total,t.total=a,t.unit="kb/s",t.speed>1e3&&(t.speed=Math.round(t.speed/1e3),t.unit="mb/s"),t.$emit("on-progress",i,e,t.fileList)}e.status="running"}),!1),n.withCredentials=this.withCredentials,n.open("POST",this.url,!0),this.header)if(Array.isArray(this.header))this.header.forEach((function(e){var i=t.header.name,a=t.header.value;n.setRequestHeader(i,a)}));else{var a=this.header.name,r=this.header.value;n.setRequestHeader(a,r)}n.send(i)},handleImage:function(e,t){var i=this;if(!/image\/(jpg|png|jpeg)$/.test(e.type))return e.errorMsg="只允许上传JPG|PNG|JPEG格式的图片",!1;if(e.size>1e3*e.maxImgSize)return e.errorMsg="图片大小不能超过"+e.maxImgSize+"MB",!1;var n=new FileReader;return n.onload=function(t){i.smallImage(n.result,e)},n.readAsDataURL(t),!0},smallImage:function(e,t){var i=new Image,n=document.createElement("canvas"),a=n.getContext("2d");i.onload=function(){var e=i.width,r=i.height,s=e,o=r;(e>42||r>42)&&(e/r>1?(s=42,o=Math.round(r/e*42)):(s=42,o=42)),n.width=s,n.height=o,a.clearRect(0,0,s,o),a.drawImage(i,0,0,s,o),t.base64=n.toDataURL()},i.src=e},getIcon:function(e){if(e.base64)return e.base64;for(var t=!1,i=["zip","rar","tar","gz"],n=0;n<i.length;n++)if(e.type.indexOf(i[n])>-1){t=!0;break}return t?a.default:r.default},deleteFile:function(e,t){t.xhr&&t.xhr.abort(),this.fileList.splice(e,1);var i=this.fileList.length;i||(this.fileIndex=null),0===e&&i&&(this.fileIndex=0,this.uploadFile(this.fileList[0]))}},mounted:function(){var e=this,t=this.$refs.uploadel;t.addEventListener("dragenter",(function(t){e.isdrag=!0})),t.addEventListener("dragleave",(function(t){e.isdrag=!1})),t.addEventListener("dragend",(function(t){e.isdrag=!1}))}}},mOxC:function(e,t,i){"use strict";i("aRCN")},mVIP:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},["CUSTOM-FORM"===e.item.type?t("p",{staticClass:"mt5 mb0 f12",staticStyle:{color:"#c4c6cc"},attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t('m["当前字段为自定义表单"]')))]):e._e(),e._v(" "),t("render-view",{attrs:{"form-data":e.formData,context:e.context}})],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},a=[];n._withStripped=!0},mW7z:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i("P2sY"),r=(n=a)&&n.__esModule?n:{default:n},s=i("CeR/");t.default={name:"dataSource",components:{},mixins:[],props:{formInfo:{type:Object,default:function(){return{}}},prcData:{type:Object,default:function(){return{}}},dictionaryData:{type:Object,default:function(){return{}}},apiInfo:{type:Object,default:function(){return{}}},changeInfo:{type:Object,default:function(){return{}}}},data:function(){return{typeClass:"",isApiLoading:!1,isSystemLoading:!1,sourceList:[],apiSysList:[],apiPortList:[]}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo},dataSourceDisable:function(){return(this.changeInfo.is_builtin||"TABLE"===this.changeInfo.source||this.changeInfo.meta&&"APPROVE_RESULT"===this.changeInfo.meta.code)&&"bk_biz_id"!==this.formInfo.key}},watch:{"formInfo.type":function(){this.initData(),this.getSourceList()}},mounted:function(){this.initData(),this.getSourceList()},methods:{initData:function(){this.typeClass="API"===this.formInfo.source_type?"bk-threeline-item bk-halfline-margin":"bk-halfline-item bk-halfline-margin",this.getApiSystemList(),"API"===this.formInfo.source_type&&this.apiInfo.remote_system_id&&this.getApiPortList(this.apiInfo.remote_system_id)},getSourceList:function(){var e=this.globalChoise.source_type.filter((function(e){return"CUSTOM_API"!==e.typeName}));"TABLE"===this.formInfo.type?this.sourceList=e.filter((function(e){return"CUSTOM"===e.typeName})):"TREESELECT"===this.formInfo.type?this.sourceList=e.filter((function(e){return"DATADICT"===e.typeName||"RPC"===e.typeName})):this.sourceList=e},getApiSystemList:function(){var e=this,t={project_key:this.$store.state.project.id||"public"};this.isSystemLoading=!0,this.$store.dispatch("apiRemote/get_all_remote_system",t).then((function(t){e.apiSysList=t.data.filter((function(e){return e.is_activated}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.isSystemLoading=!1}))},getApiPortList:function(e){var t=this,i={remote_system:e||""};this.isApiLoading=!0,this.$store.dispatch("apiRemote/get_remote_api",i).then((function(e){t.apiPortList=e.data.filter((function(e){return e.is_activated}));var i=t.apiPortList.filter((function(e){return String(e.id)===String(t.apiInfo.remote_api_id)}))[0],n=(0,r.default)({},i);t.$emit("changeApiInfo",n)})).catch((function(e){(0,s.errorHandler)(e,t)})).finally((function(){t.isApiLoading=!1}))},changeApiPort:function(e){this.apiInfo.rsp_data="",this.apiInfo.req_params={},this.apiInfo.req_body={};var t=this.apiPortList.filter((function(t){return String(t.id)===String(e)}))[0],i=(0,r.default)({},t);this.$emit("changeApiInfo",i)},changeSource:function(){this.typeClass="API"===this.formInfo.source_type?"bk-threeline-item bk-halfline-margin":"bk-halfline-item bk-halfline-margin"},changeApiSystem:function(e){this.apiInfo.remote_api_id="",this.apiInfo.rsp_data="",this.apiInfo.req_params={},this.apiInfo.req_body={},this.getApiPortList(e)},changeRpc:function(e){var t=this.prcData.list.filter((function(t){return t.key===e}))[0].req_params;this.$emit("getRpcData",t)},checkSouce:function(){var e=!1;return"DATADICT"===this.formInfo.source_type?e=!this.dictionaryData.check:"API"===this.formInfo.source_type?e=!this.apiInfo.remote_system_id||!this.apiInfo.remote_api_id:"RPC"===this.formInfo.source_type&&(e=!this.prcData.check),e&&this.$bkMessage({theme:"warning",message:this.$t('m.treeinfo["请选择正确的数据源"]')}),e}}}},ml4i:function(e,t,i){"use strict";i.r(t);var n=i("hHxK"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},n3ko:function(e,t,i){var n=i("93I4");e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},n5mh:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"child-node"},e._l(e.treeDataList,(function(i,n){return t("li",{key:n,staticClass:"vue-tree-item"},[t("div",{class:["tree-node",{down:i.showChildren,"set-frist-pLeft":e.treeIndex+1===1,active:i.checkInfo}],style:e.pLeft,on:{click:function(t){return e.toggle(i)}}},[i.showChildren?t("i",{staticClass:"bk-icon icon-down-shape",class:{"bk-padding":!i.has_children},on:{click:function(t){return t.stopPropagation(),e.toggleChildren(i)}}}):t("i",{staticClass:"bk-icon icon-right-shape",class:{"bk-padding":!i.has_children},on:{click:function(t){return t.stopPropagation(),e.toggleChildren(i)}}}),e._v(" "),t("i",{staticClass:"bk-icon icon-folder-open-shape"}),e._v(" "),t("span",{staticClass:"name-text"},[e._v(e._s(i.name))]),e._v(" "),i.checkInfo?t("i",{staticClass:"bk-icon icon-check-1",staticStyle:{float:"right","margin-top":"11px"}}):e._e()]),e._v(" "),t("collapse-transition",[i.showChildren&&i.children?[t("exportTree",{attrs:{"tree-data-list":i.children,"tree-index":e.treeIndex+1},on:{selectItem:e.selectItem,toggle:e.toggle,toggleChildren:e.toggleChildren}})]:e._e()],2)],1)})),0)},a=[];n._withStripped=!0},n6O2:function(e,t,i){},nCLG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("div",{staticStyle:{position:"relative"}},[t("div",{staticClass:"bk-form-content",staticStyle:{position:"relative"}},[t("custom-upload",{ref:"upload",attrs:{name:"field_file",multiple:!0,"with-credentials":!0,disabled:e.disabled,tip:"",size:200,url:e.url},on:{"on-success":e.uploadSuccess,"on-error":e.uploadErr,"on-progress":e.uploadProgress,"on-done":e.uploadDone}}),e._v(" "),t("ul",e._l(e.datas,(function(i,n){return t("li",{directives:[{name:"show",rawName:"v-show",value:!i.errorMsg,expression:"!file.errorMsg"}],key:n,staticClass:"upload_p",staticStyle:{"word-break":"break-word"}},[t("span",[e._v(e._s(i.name))]),e._v(" "),t("span",{staticClass:"bk-icon icon-delete",staticStyle:{color:"#3c96ff","margin-left":"10px",cursor:"pointer"},on:{click:function(t){return e.deleteFile(i)}}})])})),0)],1)]),e._v(" "),e.tempFileList.length>0?t("div",{staticClass:"bk-form-item"},[t("label",{staticClass:"bk-label"},[e._v(e._s(e.$t('m.newCommon["模板下载"]'))+"：")]),e._v(" "),t("div",{staticClass:"bk-form-content"},e._l(e.tempFileList,(function(i,n){return t("ul",{key:n},[t("li",{staticClass:"bk-icon icon-download bk-tab-cursor fa-file",on:{click:function(t){return e.downloadFile(i)}}},[e._v(" "+e._s(i.name)+"\n          ")])])})),0)]):e._e(),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},nDi6:function(e,t,i){},nOfJ:function(e,t,i){"use strict";i.r(t);var n=i("UyQ2"),a=i("5CRB");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("wqxU");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"54cca265",null);t.default=o.exports},nTEs:function(e,t,i){},nVin:function(e,t,i){"use strict";i.r(t);var n=i("nmi9"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},nmi9:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("QbLZ")),a=o(i("NPk7")),r=o(i("hftF")),s=i("ygAv");function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"ViewItem",components:{TagText:a.default,TagTable:r.default,RenderView:function(){return Promise.resolve().then(i.bind(null,"FCVG"))}},inject:["getContext"],props:{scheme:{type:Object,default:function(){return{}}},form:{type:Object,default:function(){return{}}},isTop:{type:Boolean,default:!1},topIndex:{type:Number}},data:function(){return{crumbsList:[],childrenViewConfig:{form_data:[]}}},computed:{componentType:function(){return"Tag"+this.scheme.type.replace(/^[a-z]/,(function(e){return e.toUpperCase()}))},currentDisplatCrumbs:function(){return this.crumbsList[this.crumbsList.length-1]||{label:"默认",form_data:[]}}},created:function(){this.appendCrumbsItem(this.form.label,this.form)},methods:{getAttrs:function(e){return(0,n.default)({},this.scheme.attrs,e)},appendCrumbsItem:function(e,t){this.crumbsList.push({label:e,form_data:(0,s.deepClone)(t)}),this.updateChildViewConfig()},getScheme:function(e){var t=this.getContext().schemes;return t[e.scheme]?t[e.scheme]:{}},onCrumbsClick:function(e){this.crumbsList=this.crumbsList.filter((function(t,i){return i<=e})),this.updateChildViewConfig()},updateChildViewConfig:function(){this.childrenViewConfig={form_data:(0,s.deepClone)(this.currentDisplatCrumbs.form_data)}}}}},nrD6:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),a=s(i("D3Ub")),r=s(i("efIh"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"RADIO",mixins:[r.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){var e=this;return(0,a.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.item.value&&!e.item.val&&(e.item.val=e.item.value),t.next=3,e.getFieldOptions(e.item);case 3:e.item.choice=t.sent,i=e.judgeValue(e.item.val,e.item.choice),e.item.val=i?e.item.val:"",e.conditionField(e.item,e.fields);case 7:case"end":return t.stop()}}),t,e)})))()},methods:{}}},nxpg:function(e,t,i){"use strict";i.r(t);var n=i("29mx"),a=i("Ha+5");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},"o1/R":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("14Xm")),a=l(i("D3Ub")),r=l(i("efIh")),s=l(i("u8Ap")),o=l(i("EP+X"));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"MEMBER",components:{memberSelect:s.default,businessCard:o.default},mixins:[r.default],props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1}},data:function(){return{selectedItems:[]}},watch:{"item.val":function(){this.item.val&&(this.selectedItems=this.item.val?[this.item.val]:[]),this.conditionField(this.item,this.fields)},selectedItems:{handler:function(){this.item.val=this.selectedItems.join(",")}}},mounted:function(){var e=this;return(0,a.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.selectedItems=e.item.val?[e.item.val]:[],e.conditionField(e.item,e.fields);case 2:case"end":return t.stop()}}),t,e)})))()}}},ohl0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),a=s(i("D3Ub")),r=s(i("efIh"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"CHECKBOX",mixins:[r.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{loading:!1,selects:[]}},watch:{"item.val":function(e){this.selects=""===e?[]:e.split(","),this.conditionField(this.item,this.fields)},"item.choice":{handler:function(){this.resetCheckboxGroupData()},deep:!0}},created:function(){var e=this;return(0,a.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldOptions(e.item,e.isPreview);case 2:e.item.choice=t.sent,i=e.judgeValue(e.item.val,e.item.choice),e.item.val=i?e.item.val:"",e.selects=""===e.item.val?[]:e.item.val.split(","),e.conditionField(e.item,e.fields),e.item.value&&!e.item.val&&(e.item.val=e.item.value);case 8:case"end":return t.stop()}}),t,e)})))()},methods:{selected:function(e){this.item.val=e.join(","),this.item.checkValue=!1},resetCheckboxGroupData:function(){var e=this,t=this.item.key;this.$refs[t]&&(this.$refs[t].checkboxItems=[],this.loading=!0,this.$nextTick((function(){e.loading=!1})))}}}},pLkd:function(e,t,i){"use strict";i("Z/e7")},pRHh:function(e,t,i){"use strict";i.r(t);var n=i("CBo5"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},pnfo:function(e,t,i){"use strict";i.r(t);var n=i("ucVW"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},ptjD:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"customTableData",props:{customTableInfo:{type:Object,default:function(){return{}}}},data:function(){return{typeList:[{id:"input",name:this.$t('m.treeinfo["输入框"]')},{id:"select",name:this.$t('m.treeinfo["单选框"]')},{id:"multiselect",name:this.$t('m.treeinfo["多选框"]')},{id:"datetime",name:this.$t('m.treeinfo["时间"]')},{id:"date",name:this.$t('m.treeinfo["日期"]')}],trueStatus:!0,falseStatus:!1}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){},methods:{addTableData:function(e,t){this.customTableInfo.list.splice(t+1,0,{name:"",display:"input",choice:"",required:!1})},reduceTableData:function(e,t){1!==this.customTableInfo.list.length&&this.customTableInfo.list.splice(t,1)}}}},q4Iw:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{class:["tag-text",{"active-link":e.hasChildren}],on:{click:e.onClick}},[Array.isArray(e.value)?t("div",e._l(e.value,(function(i,n){return t("p",{key:n,staticClass:"text-block"},[i.label?t("label",{staticClass:"label"},[e._v("\n        "+e._s(i.label)+"\n        "),i.desc||e.desc?t("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:i.desc||e.desc,expression:"item.desc || desc"}],staticClass:"bk-itsm-icon icon-itsm-icon-help"}):e._e()]):e._e(),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(i.value))])])})),0):t("p",[e.label?t("label",{staticClass:"label"},[e._v("\n      "+e._s(e.label)+"\n      "),e.desc?t("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.desc,expression:"desc"}],staticClass:"bk-itsm-icon icon-itsm-icon-help"}):e._e()]):e._e(),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.value))])])])},a=[];n._withStripped=!0},q9fp:function(e,t,i){"use strict";i.r(t);var n=i("UljE"),a=i("5Pf/");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("wSaC");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"165fa2cc",null);t.default=o.exports},qCK4:function(e,t,i){"use strict";i.r(t);var n=i("hmS1"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},qJoz:function(e,t,i){"use strict";i.r(t);var n=i("SioU"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},qVGl:function(e,t,i){"use strict";i.r(t);var n=i("dwEX"),a=i("LJsK");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("v4/x");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"7bd4ee96",null);t.default=o.exports},qgII:function(e,t,i){"use strict";i.r(t);var n=i("FbwU"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},qkdU:function(e,t,i){"use strict";i("xBbh")},qmm4:function(e,t,i){},qyUP:function(e,t,i){"use strict";i.r(t);var n=i("7V2o"),a=i("XUL0");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},"r/L1":function(e,t,i){"use strict";i("/7qM")},rMih:function(e,t,i){"use strict";i.r(t);var n=i("Om//"),a=i("ioCs");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("x+Aj");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"0efaed49",null);t.default=o.exports},raTm:function(e,t,i){"use strict";var n=i("5T2Y"),a=i("Y7ZC"),r=i("6/1s"),s=i("KUxP"),o=i("NegM"),l=i("XJU/"),c=i("oioR"),u=i("EXMj"),f=i("93I4"),d=i("RfKB"),m=i("2faE").f,p=i("V7Et")(0),h=i("jmDH");e.exports=function(e,t,i,v,b,g){var k=n[e],_=k,y=b?"set":"add",I=_&&_.prototype,C={};return h&&"function"==typeof _&&(g||I.forEach&&!s((function(){(new _).entries().next()})))?(_=t((function(t,i){u(t,_,e,"_c"),t._c=new k,null!=i&&c(i,b,t[y],t)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;!(e in I)||g&&"clear"==e||o(_.prototype,e,(function(i,n){if(u(this,_,e),!t&&g&&!f(i))return"get"==e&&void 0;var a=this._c[e](0===i?0:i,n);return t?this:a}))})),g||m(_.prototype,"size",{get:function(){return this._c.size}})):(_=v.getConstructor(t,e,b,y),l(_.prototype,i),r.NEED=!0),d(_,e),C[e]=_,a(a.G+a.W+a.F,C),g||v.setStrong(_,e,b),_}},rcsN:function(e,t,i){},sHh5:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return e.item.showFeild?t("div",[t("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[t("bk-select",{class:{"bk-border-error":e.item.checkValue},attrs:{searchable:"","search-with-pinyin":!0,disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.desc,"font-size":"medium"},on:{selected:e.selected,toggle:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}},[e._l(e.options,(function(i){return t("bk-option",{key:i.key,staticClass:"custom-option",attrs:{id:i.key,name:i.name}},[t("span",[e._v(e._s(i.name))]),e._v(" "),i.can_delete?t("i",{staticClass:"bk-icon icon-close",on:{click:function(t){return t.stopPropagation(),e.handleDeleteOption(i.key)}}}):e._e()])})),e._v(" "),t("div",{attrs:{slot:"extension"},slot:"extension"},[t("div",{staticClass:"plus-content",on:{click:function(t){e.addStatus=!e.addStatus}}},[t("i",{staticClass:"bk-icon icon-plus-circle"}),e._v("新增\n        ")]),e._v(" "),e.addStatus?t("div",{staticClass:"add-status"},[t("bk-form-item",{attrs:{label:"name"}},[t("bk-input",{on:{blur:e.giveDefaultKey},model:{value:e.tempChoice.name,callback:function(t){e.$set(e.tempChoice,"name",t)},expression:"tempChoice.name"}})],1),e._v(" "),t("bk-form-item",{attrs:{label:"key"}},[t("bk-input",{model:{value:e.tempChoice.key,callback:function(t){e.$set(e.tempChoice,"key",t)},expression:"tempChoice.key"}})],1),e._v(" "),t("p",{staticClass:"operations"},[t("span",{class:{disabled:!e.tempChoice.name},on:{click:e.confirmAdd}},[e._v(e._s(e.$t("m.task['确认']")))]),e._v(" "),t("span",{on:{click:e.cancelAdd}},[e._v(e._s(e.$t("m.task['取消']")))])])],1):e._e()])],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):t("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},a=[];n._withStripped=!0},sJ3n:function(e,t,i){"use strict";i("lNfD")},sRDs:function(e,t,i){"use strict";i.r(t);var n=i("OkDz"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},si5w:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-basic-node"},[e.step?e._e():t("div",{staticClass:"bk-basic-info"},[t("div",{staticClass:"bk-service-name"},[t("h1",[t("span",{staticClass:"is-outline"}),e._v(e._s(e.$t('m.treeinfo["基本信息"]')))]),e._v(" "),t("div",{staticClass:"task-info"},[t("div",{staticClass:"info-item"},[t("span",[e._v(e._s(e.$t('m.common["模板名称："]')))]),e._v(" "),e.firstStepInfo.changeName?t("div",{staticClass:"dynamic"},[t("bk-form",{ref:"taskInfoForm",attrs:{model:e.firstStepInfo,"label-width":10,rules:e.formRule}},[t("bk-form-item",{attrs:{label:"",required:!0,property:"name"}},[t("bk-input",{staticStyle:{width:"450px"},attrs:{maxlength:"120"},model:{value:e.firstStepInfo.name,callback:function(t){e.$set(e.firstStepInfo,"name",t)},expression:"firstStepInfo.name"}}),e._v(" "),t("div",{staticClass:"operate"},[t("bk-button",{staticClass:"ml10",attrs:{theme:"primary",text:"",title:e.$t("m.systemConfig['保存']")},on:{click:function(t){return e.stepChange("",!1,"changeName")}}},[e._v(e._s(e.$t("m.systemConfig['保存']")))]),e._v(" "),t("span",[e._v("|")]),e._v(" "),t("bk-button",{staticClass:"ml10",attrs:{theme:"primary",text:"",title:e.$t("m.wiki['取消']")},on:{click:function(t){return e.cancelEdit("changeName")}}},[e._v(e._s(e.$t("m.wiki['取消']")))])],1)],1)],1)],1):t("div",{staticClass:"static"},[t("span",[e._v(e._s(e.firstStepInfo.name))]),e._v(" "),t("span",{staticClass:"bk-itsm-icon icon-edit-bold isOn",on:{click:function(t){e.firstStepInfo.changeName=!0}}})])]),e._v(" "),t("div",{staticClass:"info-item"},[t("span",[e._v(e._s(e.$t("m.user['负责人：']")))]),e._v(" "),e.firstStepInfo.changeOwners?t("div",{staticClass:"dynamic"},[t("bk-form",{ref:"taskInfoForm",attrs:{model:e.firstStepInfo,"label-width":10}},[t("bk-form-item",{attrs:{label:"","ext-cls":"flex-form-item"}},[t("div",{staticStyle:{width:"450px",display:"inline-flex"}},[t("member-select",{staticStyle:{width:"100%"},model:{value:e.firstStepInfo.ownersInputValue,callback:function(t){e.$set(e.firstStepInfo,"ownersInputValue",t)},expression:"firstStepInfo.ownersInputValue"}})],1),e._v(" "),t("div",{staticClass:"operate"},[t("bk-button",{staticClass:"ml10",attrs:{theme:"primary",text:"",title:e.$t("m.systemConfig['保存']")},on:{click:function(t){return e.stepChange("",!1,"changeOwners")}}},[e._v(e._s(e.$t("m.systemConfig['保存']")))]),e._v(" "),t("span",[e._v("|")]),e._v(" "),t("bk-button",{staticClass:"ml10",attrs:{theme:"primary",text:"",title:e.$t("m.wiki['取消']")},on:{click:function(t){return e.cancelEdit("changeOwners")}}},[e._v(e._s(e.$t("m.wiki['取消']")))])],1)])],1)],1):t("div",{staticClass:"static"},[t("span",[e._v(e._s(e.changedTemplateInfo.owners||"--"))]),e._v(" "),t("span",{staticClass:"bk-itsm-icon icon-edit-bold isOn",on:{click:function(t){e.firstStepInfo.changeOwners=!0}}})])]),e._v(" "),t("div",{staticClass:"info-item top-item"},[t("span",[e._v(e._s(e.$t('m.common["模板说明："]')))]),e._v(" "),e.firstStepInfo.changeDesc?t("div",{staticClass:"dynamic"},[t("bk-form",{ref:"taskInfoForm",attrs:{model:e.firstStepInfo,"label-width":10}},[t("bk-form-item",[t("bk-input",{staticStyle:{width:"450px"},attrs:{placeholder:e.$t("m.taskTemplate['请输入任务描述']"),type:"textarea",rows:3,maxlength:64},model:{value:e.firstStepInfo.desc,callback:function(t){e.$set(e.firstStepInfo,"desc",t)},expression:"firstStepInfo.desc"}}),e._v(" "),t("div",{staticClass:"operate"},[t("bk-button",{staticClass:"ml10",attrs:{theme:"primary",text:"",title:e.$t("m.systemConfig['保存']")},on:{click:function(t){return e.stepChange("",!1,"changeDesc")}}},[e._v(e._s(e.$t("m.systemConfig['保存']")))]),e._v(" "),t("span",[e._v("|")]),e._v(" "),t("bk-button",{staticClass:"ml10",attrs:{theme:"primary",text:"",title:e.$t("m.wiki['取消']")},on:{click:function(t){return e.cancelEdit("changeDesc")}}},[e._v(e._s(e.$t("m.wiki['取消']")))])],1)],1)],1)],1):t("div",{staticClass:"static"},[t("span",[e._v(e._s(e.firstStepInfo.desc||"--"))]),e._v(" "),t("span",{staticClass:"bk-itsm-icon icon-edit-bold isOn",on:{click:function(t){e.firstStepInfo.changeDesc=!0}}})])])])])]),e._v(" "),t("field-config",{ref:"field",attrs:{"template-info":e.changedTemplateInfo,"template-stage":e.stepList[e.step].stage}}),e._v(" "),t("common-trigger-list",{attrs:{"source-id":e.changedTemplateInfo.id,"step-signal":e.stepList[e.step].signal,"template-stage":e.stepList[e.step].stage}}),e._v(" "),t("div",{staticClass:"bk-common-step"},[e.step?t("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"taskTemplate-button-commonStep-nextStep",loading:e.buttonLoading,title:e.$t("m.taskTemplate['上一步']")},on:{click:function(t){return e.stepChange("previous")}}},[e._v("\n      "+e._s(e.$t("m.taskTemplate['上一步']"))+"\n    ")]):e._e(),e._v(" "),t("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":2===e.step?"taskTemplate-button-commonStep-saveStep":"taskTemplate-button-commonStep-pervStep",loading:e.buttonLoading,title:2===e.step?e.$t("m.taskTemplate['完成']"):e.$t("m.deployPage['下一步']")},on:{click:e.stepChange}},[e._v("\n      "+e._s(2===e.step?e.$t("m.taskTemplate['完成']"):e.$t("m.deployPage['下一步']"))+"\n    ")]),e._v(" "),t("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"taskTemplate-button-commonStep-saveDrafts",loading:e.buttonLoading,title:e.$t("m.trigger['保持草稿']")},on:{click:function(t){return e.stepChange("",!0)}}},[e._v("\n      "+e._s(e.$t("m.trigger['保持草稿']"))+"\n    ")]),e._v(" "),t("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"taskTemplate-button-commonStep-closeTask",loading:e.buttonLoading,title:e.$t("m.taskTemplate['取消']")},on:{click:e.cancelStep}},[e._v("\n      "+e._s(e.$t("m.taskTemplate['取消']"))+"\n    ")])],1)],1)},a=[];n._withStripped=!0},sshH:function(e,t,i){"use strict";i.r(t);var n=i("PGA1"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},t9cD:function(e,t,i){"use strict";i.r(t);var n=i("5/Zn"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},tNV3:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAAA5CAYAAABZClfIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkU1NzFFNzcxRjUzQzExRTdBMkU1QUQxMkE2RTNCRDUwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkU1NzFFNzcyRjUzQzExRTdBMkU1QUQxMkE2RTNCRDUwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTU3MUU3NkZGNTNDMTFFN0EyRTVBRDEyQTZFM0JENTAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTU3MUU3NzBGNTNDMTFFN0EyRTVBRDEyQTZFM0JENTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5558DUAAAHDUlEQVR42uycS2wbVRSGj9/vxInfsRMnsZu6DVBUXhIEVWwQgg1s6AYkBGIBEkVl1RXqigUgFq0qVNHCBpCg6mPBAomKDWyQAInSiDRJEzuOHceJ83BiO3H84Py3TpqWksaJp4md+aWra8+MZ3w/nznnzLkzVpTLZdqufv1z4Ch3x7gd4maixlCG21/cPu07HLpcix0qfvnjn/tuxAfbCPQp7t5raTKR1WIilUrZEKSLpRLNLWRpdn4Rb0899UjP+/faTqPe/HjV27TotwA60O4ij6OFGk1eZytNTM3Szejksd+uDQ4w8M+3s7+7Ya/6FMUmQD/B3Rm33Upo45Mpmpyep9xyvu4hK3j0ep2W3DYrtTlbKLuUB/TTDHyYgf9UK9ibtWgHdxctJr0OVj0wEqOZdIYcLU3kYvAKhaKuYSOOZXLLFI5PUTqTo1CXl5aW86rZdOYCA3+Ggfc/ENgMWsXddxq1qj3U7aNYcoZS7Nf28xeCz24ktTSZaSgSo7HEtBjf34ORZv4RrjDwpxn4VLX7U1ZcR3mdC6H/Wbaqj9lwnwt1eymfL1AkPs3+urXhQN+CbSKfy07RiWmaX8jQATYuNrIgzmoGrt0K7Gqs+lXuPuj0Osls0NON0RiZDDpqd9uoUdXGQbK12UyDkQkqlUt0MOCDm3yWV53bCmzFukbrAuQdyxj0Q9x9ZWe/jCg9PJaglWKRAh2euvfR91N3u5u0Gg39czNGBr2OevweLH6drftEzS2bQTdzd5mt2Njjd9Nkap6mZtPU5XWRXquhRpdKqaSezjbKFwo0GI6To7WJfLfO5o+Yzcu1hA2z/UatUgUPsJ9eZj89Ep0UmYfNaqG9IhhVkM/i2fQijbEP72xzkN1qEWwY+GNbga24R479IbeX9nd6SMsHHBiNk0ajJvjtvSYkAV4OmICdmltga/eQxWQw8qorDNx3X6vdqDbCO3iRux86PHYFN2HRiek5OhjsEIFxr2ooEqf5xSwd2t8pyhPXBsK0vFL4nVcd6TscylbtRhg0UpxvORIL0DOcS8f50rWdX+9l0LcDppoD5rjw5weDPlIqlY/zqq+Zm6Iq2PwBnBqXDDptswgMKwWR+lg573TbW2ivSwRM/+2AaeI0ONTVhlWvIGhWa9lf8g4fRkDEjm/wDpWc3gV8bpJVCZg67R0BE7k4gibrBBvra5uCzRse5+7oPs4ljewuUGBKs38K8KmjVqvqDgq+v6QB02lbC5hIB102ZMl0njn2bQibNzjC3Se4aLG3WEQRZmxiSlyON5mNdQd6MbtEMYaNXip5XTZh1UPsZlEdDHa4qdlixKX8pUrc+y/sSupygTdUIa0r8NXhDU7zzAYD+Vz1dTle4gwLRtI/PCbeo4/Ep8RySQImu1dNJWCWSmVRJWQ3A59yuXJBeBs2L8AvcVGn1TiwIa6+oxMpATzAv1S9XY4jvnR4HNTLKSqE3s/+VCnROJD+IWBy+kfRRArFKuoN+EitUqLE8X2lUrpWYj3DX+RJBERNxS/DBxn1OpFPViOL0UAGvXZXQDcb9eI0R1+NcuwOFrK5qo9n5HGDW6fXIRigBM1n1fN8Qp3m1e9iDvINFJj2+d3s3K1rH0ShCTWQaieE4YLW76ceNZmao3AsWfXn4AE8divn4a61ZRNTc3QzmsDLN2HZJ8UMy12A4OjRqhGfLg2V3m000b1ZeRxWWshkKTmTPgmf7a/HTKOeZDEJvh1KGcUDDNwyAhm2DFuWDFuGLUuGLcOWYcva3bBRG0CJsd6FMWCGalfDRnVtcQvVst0mjMEowaR2TWGjoDWbzojbbetV2aVlMQaMZVfDdjusoqY7GI5Rtg6B4ztjthxjwFhqLXVNfzn22b3BduofHqfrw2Pilluz0bDrn7MpFkvCdcCiARpjkGJWR13rHeLmlUdDflE0T87MiwlXPAy0m4VgiJmVLq9T1J+lmgZUS7FTfFk8i4ImS86zZdgybFky7HqUeicPjtskRmNJzDxToVCUdqAqFTltTSLj2KmbjnYUNkDPL+ao0+cWMKQU7u6aSKbEo4S4iWbPuRFYtMdpkxz0qmXjWInUnOyz5QApsZytTZRIzohTXGohJuBY7h28NQ4+O18ql3bkTkgEK/jtcDQhOfDVAOlvsz/wceLJYNYiYI/klvKhnYCNrKDb5xKtkYW7YlkRuJEf8W8x5XKZZEmT3lb+jecqYJ9fXikU8XyjrNoL/8QDvvzynLLvcOg6vzg7Mp6s+sZ3WRsLPEdj4m9JzoLzajZynM39av9QlOIcsWWXsn3XEU/OEnjy65/BV8SoVbCV52o+4/aOVqNW4gkoFNSlmGVuVGGSBMEQT0PnVwpIQb4AaLbq3B2wV8XQe7l7m9sL3Lq5aWSMmxb+CzCMYAgfXXHRa/pXgAEAdjq+qfD3Of4AAAAASUVORK5CYII="},tPsg:function(e,t,i){"use strict";i("Wew5")},tQ05:function(e,t,i){"use strict";i.r(t);var n=i("u0fD"),a=i("Abqk");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("sJ3n");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"c3012aea",null);t.default=o.exports},tgnH:function(e,t,i){"use strict";i.r(t);var n=i("P2aA"),a=i("pnfo");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("JtQW");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"248e77f2",null);t.default=o.exports},tl4E:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-get-param"},[t("div",{staticClass:"bk-params-title"},[e._v("\n    "+e._s(e.$t('m.treeinfo["返回数据"]'))+"\n  ")]),e._v(" "),t("div",{staticClass:"bk-param-three"},[t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['选取数组']"),required:!0}},[t("div",{staticClass:"bk-form-content bk-dialog-input"},[t("div",{ref:"cascader"},[[t("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeOther0,expression:"closeOther0"}],staticClass:"bk-search-tree",staticStyle:{width:"100%",float:"left"}},[[(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key?t("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-border-red":e.checkInfo.assignors,"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key}},[t("span",{class:{"bk-color-tree":e.organization.assignorTree.name}},[e._v(e._s(e.organization.assignorTree.name||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),t("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]):t("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-border-red":e.checkInfo.assignors,"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key},on:{click:function(t){return t.stopPropagation(),e.showTree(0)}}},[t("span",{class:{"bk-color-tree":e.organization.assignorTree.name}},[e._v(e._s(e.organization.assignorTree.name||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),t("i",{staticClass:"bk-select-angle bk-icon icon-framework"})])],e._v(" "),t("transition",{attrs:{name:"fade"}},[e.organizaInfo.assignorShow[0]?t("div",{staticClass:"bk-search-tree-content",style:{width:50*e.maxLevelTree[0]+"%"}},[t("export-tree",{attrs:{disabled:(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key,"tree-data-list":e.organization.assignorPerson,"is-key-value":0},on:{toggle:e.assignorToggle,toggleChildren:e.toggleChildren}})],1):e._e()])],2)]],2)])]),e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['关键字字段']"),required:!0}},[t("div",{staticClass:"bk-form-content bk-dialog-input"},[t("div",{ref:"cascader"},[[t("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeOther1,expression:"closeOther1"}],staticClass:"bk-search-tree",staticStyle:{width:"100%",float:"left"}},[[(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key?t("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key}},[t("span",{class:{"bk-color-tree":e.settingKeyName}},[e._v(e._s(e.settingKeyName||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),t("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]):t("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key},on:{click:function(t){return t.stopPropagation(),e.showTree(1)}}},[t("span",{class:{"bk-color-tree":e.settingKeyName}},[e._v(e._s(e.settingKeyName||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),t("i",{staticClass:"bk-select-angle bk-icon icon-framework"})])],e._v(" "),t("transition",{attrs:{name:"fade"}},[e.organizaInfo.assignorShow[1]?t("div",{staticClass:"bk-search-tree-content",style:{width:50*e.maxLevelTree[1]+"%"}},[t("export-tree",{attrs:{disabled:(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key,"tree-data-list":e.selectInfo.selectkeylist,"is-key-value":1},on:{toggle:e.assignorToggle,toggleChildren:e.toggleChildren}})],1):e._e()])],2)]],2)])]),e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.treeinfo['显示字段']"),required:!0}},[t("div",{staticClass:"bk-form-content bk-dialog-input"},[t("div",{ref:"cascader"},[[t("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeOther2,expression:"closeOther2"}],staticClass:"bk-search-tree",staticStyle:{width:"100%",float:"left"}},[[(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key?t("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key}},[t("span",{class:{"bk-color-tree":e.settingValueName}},[e._v(e._s(e.settingValueName||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),t("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]):t("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key},on:{click:function(t){return t.stopPropagation(),e.showTree(2)}}},[t("span",{class:{"bk-color-tree":e.settingValueName}},[e._v(e._s(e.settingValueName||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),t("i",{staticClass:"bk-select-angle bk-icon icon-framework"})])],e._v(" "),t("transition",{attrs:{name:"fade"}},[e.organizaInfo.assignorShow[2]?t("div",{staticClass:"bk-search-tree-content",style:{width:50*e.maxLevelTree[2]+"%"}},[t("export-tree",{attrs:{disabled:(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key,"tree-data-list":e.selectInfo.selectvaluelist,"is-key-value":2},on:{toggle:e.assignorToggle,toggleChildren:e.toggleChildren}})],1):e._e()])],2)]],2)])])],1)])},a=[];n._withStripped=!0},tnQB:function(e,t,i){},u0fD:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{ref:"fieldContent",staticClass:"bk-field-preview",attrs:{id:"bkPreview"}},[t("bk-form",{attrs:{"label-width":e.labelWidth,"form-type":"vertical","ext-cls":"bk-ext-form"}},[e._l(e.fields,(function(i,n){return[i.showFeild?t("div",{key:n,class:{"bk-field-line":"COL_12"===i.layout,"bk-field-half":"COL_6"===i.layout,"bk-field-trigger":"trigger"===e.origin}},[t("CW-"+i.type,{ref:"component"+n,refInFor:!0,tag:"component",attrs:{item:i,fields:e.fields,"basic-infomation":e.basicInfomation,"type-info":e.typeInfo,disabled:e.disabled}}),e._v(" "),"trigger"!==e.origin?["API"===i.source_type?t("i",{staticClass:"bk-icon icon-refresh bk-icon-refresh",class:{"not-rotate":!e.rotate,rotate:e.rotate},on:{click:function(t){return e.freshBtn(i)}}}):e._e(),e._v(" "),"RPC"===i.source_type?t("i",{staticClass:"bk-icon icon-refresh bk-icon-refresh",class:{"not-rotate":!e.rotate,rotate:e.rotate},on:{click:function(t){return e.freshRpc(i)}}}):e._e()]:e._e()],2):e._e()]}))],2)],1)},a=[];n._withStripped=!0},u14n:function(e,t,i){"use strict";i.r(t);var n=i("Axd5"),a=i("pRHh");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},ucVW:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"DevopsPreview",components:{},props:{stages:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{isFullScreen:!1}},methods:{openFullScreen:function(){this.isFullScreen=!0,this.$bkMessage({message:this.$t('m.common["按 ESC 键退出全屏"]')}),document.addEventListener("keydown",this.handlerKeyDown)},onCloseFullScreen:function(){this.isFullScreen=!1},handlerKeyDown:function(e){27===e.keyCode&&(this.onCloseFullScreen(),document.removeEventListener("keydown",this.handlerKeyDown))},getPath:function(e,t){if(0===t)return"M 60 2 L 55 2 Q 50 2 50 7 L 50 60 Q 50 62 45 62 L 0 62";var i=56*(e.containers[t-1].elements.length+1);return"M 50 2 L 50 "+(i-10)+" Q 50 "+(i-5)+" 45 "+(i-5)+" L 0 "+(i-5)},getSvgStyle:function(e,t){if(0===t)return"";var i=56*(e.containers[t-1].elements.length+1)-27;return i?"top: "+-i+"px;":""},isElementCanExecute:function(e){if(!e.additionalOptions||!e.additionalOptions.runCondition)return!0;var t=e.additionalOptions,i=t.runCondition,n=t.customVariables;if(!t.enable)return!1;switch(i){case"CUSTOM_VARIABLE_MATCH":return n.every((function(e){return!!e.value}));case"CUSTOM_VARIABLE_MATCH_NOT_RUN":return!n.every((function(e){return!!e.value}));default:return!0}}}}},ughI:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CUSTOM_FORM_DEFAULT_VALUE=void 0;var n,a=i("gDS+"),r=(n=a)&&n.__esModule?n:{default:n};t.CUSTOM_FORM_DEFAULT_VALUE=(0,r.default)({schemes:{},form_data:[]},null,4)},ukIK:function(e,t,i){"use strict";i.r(t);var n=i("unyW"),a=i("ml4i");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("hj6f");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"fd4c2596",null);t.default=o.exports},unqN:function(e,t,i){},unyW:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-change-conductor"},["STRING"===e.itemInfo.type?[t("bk-input",{directives:[{name:"cursorIndex",rawName:"v-cursorIndex",value:"conductorId"+e.index,expression:"'conductorId' + index"}],staticStyle:{width:"260px"},attrs:{placeholder:e.$t("m.trigger['20个字符以内']")},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}})]:e._e(),e._v(" "),"SELECT"===e.itemInfo.type?[t("bk-select",{staticStyle:{width:"260px"},attrs:{"ext-cls":"bk-insert-info",clearable:!1,searchable:""},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}},e._l(e.itemInfo.choice,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"MULTISELECT"===e.itemInfo.type?[t("bk-select",{staticStyle:{width:"260px"},attrs:{"ext-cls":"bk-insert-info",clearable:!1,searchable:"",multiple:""},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}},e._l(e.itemInfo.choice,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"MEMBERS"===e.itemInfo.type||"MULTI_MEMBERS"===e.itemInfo.type?e._l(e.itemInfo.value,(function(i,n){return t("div",{key:n,staticClass:"bk-send-recipient",class:{"bk-none-margin":e.itemInfo.value.length-1===n}},[t("member-info",{attrs:{"item-info":e.itemInfo,"recipient-item":i,"recipient-index":n}})],1)})):e._e(),e._v(" "),"TEXT"===e.itemInfo.type?[t("bk-input",{directives:[{name:"cursorIndex",rawName:"v-cursorIndex",value:"conductorId"+e.index,expression:"'conductorId' + index"}],attrs:{type:"textarea","ext-cls":"bk-remindway-form",rows:6},on:{blur:e.changeMessagePanel},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}})]:e._e(),e._v(" "),"RADIO"===e.itemInfo.type?[t("bk-radio-group",{model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}},[e._l(e.itemInfo.choice,(function(i,n){return[t("bk-radio",{key:n,attrs:{value:i.key,"ext-cls":"mr50"}},[e._v(e._s(i.name))])]}))],2)]:e._e(),e._v(" "),"CHECKBOX"===e.itemInfo.type?[t("bk-checkbox-group",{model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}},[e._l(e.itemInfo.choice,(function(i,n){return[t("bk-checkbox",{key:n,attrs:{value:i.key,"ext-cls":"mr10"}},[e._v(e._s(i.name))])]}))],2)]:e._e(),e._v(" "),"INT"===e.itemInfo.type?[t("bk-input",{attrs:{clearable:!0,precision:e.precision,type:"number"},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}})]:e._e(),e._v(" "),!e.isShowVar||"STRING"!==e.itemInfo.type&&"TEXT"!==e.itemInfo.type?e._e():[t("div",{staticClass:"bk-select-btn"},[t("bk-button",{staticClass:"bk-form-btn plus-cus",attrs:{theme:"default",title:e.$t("m.slaContent['插入变量']"),icon:"plus"}},[e._v("\n        "+e._s(e.$t('m.slaContent["插入变量"]'))+"\n      ")]),e._v(" "),t("bk-select",{attrs:{"ext-cls":"bk-select-btn-opacity",searchable:""},on:{selected:e.changeInsert},model:{value:e.insertValue,callback:function(t){e.insertValue=t},expression:"insertValue"}},e._l(e.variableList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1)],e._v(" "),e.isShowVar&&"VARIABLE"===e.itemInfo.value?[t("bk-select",{staticStyle:{width:"260px"},attrs:{"ext-cls":"bk-insert-info",searchable:"",multiple:Array.isArray(e.itemInfo.insertValue)},on:{selected:e.changeImport},model:{value:e.itemInfo.insertValue,callback:function(t){e.$set(e.itemInfo,"insertValue",t)},expression:"itemInfo.insertValue"}},e._l(e.variableList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e()],2)},a=[];n._withStripped=!0},utoA:function(e,t,i){},uz2X:function(e,t,i){"use strict";i.r(t);var n=i("676K"),a=i("dU2m");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("iGEm");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"20fd9ae2",null);t.default=o.exports},"v4/x":function(e,t,i){"use strict";i("jfEP")},v6xn:function(e,t,i){var n=i("C2SN");e.exports=function(e,t){return new(n(e))(t)}},vT7S:function(e,t,i){},vXIu:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i("GQeE")),a=c(i("QbLZ")),r=c(i("gDS+")),s=i("CeR/"),o=c(i("EstQ")),l=c(i("tgnH"));function c(e){return e&&e.__esModule?e:{default:e}}function u(){return{required:!0,message:o.default.t('m.treeinfo["字段必填"]'),trigger:"blur"}}var f={project_id:[u()],pipeline_id:[u()]};t.default={name:"DEVOPS_TEMPLATE",components:{DevopsPreview:l.default},props:{item:{type:Object,required:!0,default:function(){}},basicInfomation:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1}},data:function(){return{projectLoading:!1,pipelineLoading:!1,pipelineStartLoading:!1,pipelineDetailLoading:!1,showPipelineVariable:!0,showPipelineStages:!0,defaultRules:{project_id:[{required:!0,message:o.default.t('m.treeinfo["字段必填"]'),trigger:"blur"}],pipeline_id:[{required:!0,message:o.default.t('m.treeinfo["字段必填"]'),trigger:"blur"}]},rules:{project_id:[u()],pipeline_id:[u()]},projectList:[],pipelineList:[],pipelineStartInfo:{},pipelineVariableList:[],pipelineStages:[]}},created:function(){this.item.devopsContent||this.$set(this.item,"devopsContent",{project_id:"",pipeline_id:"",variables:{}})},mounted:function(){if(this.getDevopsUserProjectList(),this.item.value){var e=this.item.value,t=e.pipeline_id,i=e.project_id;this.item.devopsContent={project_id:i,pipeline_id:t,variables:JSON.parse((0,r.default)((0,a.default)({},this.item.value,{project_id:void 0,pipeline_id:void 0})))},this.getDevopsPipelineList(i),this.getDevopsPipelineStartInfo(),this.getDevopsPipelineDetail()}},methods:{getDevopsUserProjectList:function(){var e=this;this.projectLoading=!0,this.$store.dispatch("ticket/getDevopsUserProjectList",{ticket_id:this.basicInfomation.id}).then((function(t){e.projectList=t.data})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.projectLoading=!1}))},getDevopsPipelineList:function(e){var t=this;this.pipelineLoading=!0,this.$store.dispatch("ticket/getDevopsPipelineList",{project_id:e}).then((function(e){t.pipelineList=e.data})).catch((function(e){(0,s.errorHandler)(e,t)})).finally((function(){t.pipelineLoading=!1}))},getDevopsPipelineStartInfo:function(){var e=this;this.pipelineStartLoading=!0;var t=this.item.devopsContent,i=t.project_id,n=t.pipeline_id;this.$store.dispatch("ticket/getDevopsPipelineStartInfo",{project_id:i,pipeline_id:n}).then((function(t){e.pipelineStartInfo=t.data,e.pipelineVariableList=t.data.properties;var i=e.item.devopsContent.variables;t.data.properties.forEach((function(t){Object.prototype.hasOwnProperty.call(i,t.id)||e.$set(i,t.id,t.defaultValue||"")})),e.resetFormRules()})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.pipelineStartLoading=!1}))},getDevopsPipelineDetail:function(){var e=this;this.pipelineDetailLoading=!0;var t=this.item.devopsContent,i=t.project_id,n=t.pipeline_id;this.$store.dispatch("ticket/getDevopsPipelineDetail",{project_id:i,pipeline_id:n}).then((function(t){e.pipelineStages=t.data.stages||[]})).finally((function(){e.pipelineDetailLoading=!1}))},handleProjectChange:function(e){this.pipelineList=[],this.pipelineStartInfo={},this.pipelineVariableList=[],this.item.devopsContent.pipeline_id="",this.item.devopsContent.variables={},this.resetFormRules(),this.getDevopsPipelineList(e)},handlePipelineChange:function(){this.pipelineStartInfo={},this.pipelineVariableList=[],this.item.devopsContent.variables={},this.resetFormRules(),this.getDevopsPipelineStartInfo(),this.getDevopsPipelineDetail()},resetFormRules:function(){var e=this,t={};(0,n.default)(this.item.devopsContent.variables).forEach((function(i){e.pipelineVariableList.find((function(e){return e.id===i})).required&&(t[i]=[u()])})),this.rules=(0,a.default)({},f,t)},validate:function(){this.$refs.devopsForm.validate(),this.$refs.devopsVariable.validate();var e=this.item.devopsContent,t=e.project_id,i=e.pipeline_id,a=e.variables,r=(0,n.default)(a).every((function(e){return!!a[e]}));return r||(this.showPipelineVariable=!0),!!t&&!!i&&r}}}},vlfB:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-data-source"},[t("bk-select",{attrs:{"ext-cls":e.typeClass,clearable:!1,disabled:e.dataSourceDisable,searchable:""},on:{selected:e.changeSource},model:{value:e.formInfo.source_type,callback:function(t){e.$set(e.formInfo,"source_type",t)},expression:"formInfo.source_type"}},e._l(e.sourceList,(function(e){return t("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),"DATADICT"===e.formInfo.source_type?[t("bk-select",{attrs:{"ext-cls":"bk-halfline-item",clearable:!1,disabled:e.dataSourceDisable,searchable:""},model:{value:e.dictionaryData.check,callback:function(t){e.$set(e.dictionaryData,"check",t)},expression:"dictionaryData.check"}},e._l(e.dictionaryData.list,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"API"===e.formInfo.source_type?[t("bk-select",{attrs:{"ext-cls":"bk-threeline-item bk-halfline-margin",placeholder:e.$t("m.treeinfo['请选择接入系统']"),clearable:!1,loading:e.isSystemLoading,searchable:""},on:{selected:e.changeApiSystem},model:{value:e.apiInfo.remote_system_id,callback:function(t){e.$set(e.apiInfo,"remote_system_id",t)},expression:"apiInfo.remote_system_id"}},e._l(e.apiSysList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),t("bk-select",{attrs:{"ext-cls":"bk-threeline-item",placeholder:e.$t("m.treeinfo['请选择接口']"),clearable:!1,loading:e.isApiLoading,searchable:""},on:{selected:e.changeApiPort},model:{value:e.apiInfo.remote_api_id,callback:function(t){e.$set(e.apiInfo,"remote_api_id",t)},expression:"apiInfo.remote_api_id"}},e._l(e.apiPortList,(function(e){return t("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]:e._e(),e._v(" "),"RPC"===e.formInfo.source_type?[t("bk-select",{attrs:{"ext-cls":"bk-halfline-item",clearable:!1,searchable:""},on:{selected:e.changeRpc},model:{value:e.prcData.check,callback:function(t){e.$set(e.prcData,"check",t)},expression:"prcData.check"}},e._l(e.prcData.list,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e()],2)},a=[];n._withStripped=!0},wA6F:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-get-param"},[t("bk-table",{attrs:{data:e.tableList,size:"small"}},[t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),"min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"bk-more"},[t("span",{style:{paddingLeft:20*i.row.level+"px"}},[i.row.has_children?t("span",{class:["bk-icon","tree-expanded-icon",i.row.showChildren?"icon-down-shape":"icon-right-shape"],on:{click:function(t){return e.changeState(i.row)}}}):t("span",{staticClass:"bk-icon bk-more-icon"}),e._v(" "),t("span",[e._v(e._s(i.row.key||"--"))])])])]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['类型']"),prop:"type"}}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['是否必须']")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n      ")]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{attrs:{title:i.row.desc}},[e._v(e._s(i.row.desc||"--"))])]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.isStatic&&"object"!==i.row.type&&"array"!==i.row.type?[e._v("\n          "+e._s(i.row.customValue||"--")+"\n        ")]:e.isCustom&&"object"!==i.row.type&&"array"!==i.row.type?[t("bk-input",{attrs:{type:"string"===i.row.type?"text":"number",placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:i.row.customValue,callback:function(t){e.$set(i.row,"customValue",t)},expression:"props.row.customValue"}})]:["object"!==i.row.type&&"array"!==i.row.type?[t("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",left:"15px"}},[t("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:i.row.source_type,callback:function(t){e.$set(i.row,"source_type",t)},expression:"props.row.source_type"}},e._l(e.sourceTypeList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),i.row.source_type&&"CUSTOM"!==i.row.source_type?t("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[t("bk-select",{class:{"bk-border-error":i.row.isCheck&&!i.row.value_key.toString()},attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:i.row.value_key,callback:function(t){e.$set(i.row,"value_key",t)},expression:"props.row.value_key"}},[e._l(e.stateList,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),e._v(" "),"addField"!==e.entry?[t("div",{staticStyle:{cursor:"pointer"},attrs:{slot:"extension"},on:{click:function(t){return e.addNewItem(i.row)}},slot:"extension"},[t("i",{staticClass:"bk-icon icon-plus-circle"}),e._v(e._s(e.$t('m.treeinfo["添加变量"]'))+"\n                  ")])]:e._e()],2)],1):t("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},["string"===i.row.type||"number"===i.row.type?[t("bk-input",{class:{"bk-border-error":i.row.isCheck&&!i.row.value.toString()},attrs:{type:"string"===i.row.type?"text":"number",placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:i.row.value,callback:function(t){e.$set(i.row,"value",t)},expression:"props.row.value"}})]:e._e(),e._v(" "),"boolean"===i.row.type?[t("bk-radio-group",{model:{value:i.row.value,callback:function(t){e.$set(i.row,"value",t)},expression:"props.row.value"}},[t("bk-radio",{attrs:{value:e.trueSatatus}},[e._v("true")]),e._v(" "),t("bk-radio",{attrs:{value:e.falseSatatus}},[e._v("false")])],1)]:e._e()],2)]:e._e(),e._v(" "),e.isStatic||"array"!==i.row.lastType?e._e():t("div",{staticClass:"bk-between-operat"},[t("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(t){return e.addChildren(i.row)}}}),e._v(" "),"array"===i.row.lastType?t("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":e.countSon(i.row)},on:{click:function(t){return e.deletChildren(i.row)}}}):e._e()])]]}}])})],1)],1)},a=[];n._withStripped=!0},wQ82:function(e,t,i){},wSaC:function(e,t,i){"use strict";i("unqN")},wXXQ:function(e,t,i){},wegR:function(e,t,i){"use strict";i.r(t);var n=i("Jje2"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},wqxU:function(e,t,i){"use strict";i("+PGD")},"x+Aj":function(e,t,i){"use strict";i("e42N")},"x+JR":function(e,t,i){"use strict";i.r(t);var n=i("zCbU"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},x6yq:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){return(0,this._self._c)("section",{staticClass:"code-editor"})},a=[];n._withStripped=!0},"x9y/":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bk-add-trigger"},[t("div",{staticClass:"bk-service-name"},[t("h1",[t("span",{staticClass:"is-outline"}),e._v(e._s(e.$t('m.trigger["基础信息"]')))])]),e._v(" "),t("div",{staticClass:"bk-trigger-basic"},[t("bk-form",{ref:"triggerBasic",attrs:{"label-width":170,model:e.formData,"ext-cls":"bk-basic-form","form-type":"vertical",rules:e.rules}},[t("bk-form-item",{attrs:{label:e.$t("m.trigger['触发器名称']"),"data-test-id":"trigger-input-name",required:!0,property:"name"}},[t("bk-input",{attrs:{placeholder:e.$t("m.trigger['请输入触发器名称']")},on:{change:function(t){return e.$emit("change")}},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.trigger['是否启用']")}},[t("bk-switcher",{attrs:{"data-test-id":"triggers_switcher_isUseTrigger",size:"small"},on:{change:function(t){return e.$emit("change")}},model:{value:e.formData.is_enabled,callback:function(t){e.$set(e.formData,"is_enabled",t)},expression:"formData.is_enabled"}})],1),e._v(" "),t("bk-form-item",{attrs:{label:e.$t("m.trigger['触发器描述']")}},[t("bk-input",{attrs:{placeholder:e.$t("m.trigger['请输入触发器描述']"),type:"textarea",rows:3,maxlength:100},on:{change:function(t){return e.$emit("change")}},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],1)],1)],1),e._v(" "),t("div",{staticClass:"bk-service-name"},[t("h1",[t("span",{staticClass:"is-outline"}),e._v(e._s(e.$t("m.trigger['触发机制']")))])]),e._v(" "),t("div",{staticClass:"bk-trigger-made"},[t("bk-form",{ref:"triggerMade",attrs:{"label-width":170,model:e.formData,"form-type":"vertical",rules:e.rules}},[t("bk-form-item",{staticStyle:{width:"300px"},attrs:{label:e.$t("m.trigger['触发事件']"),"data-test-id":"trigger-select-triggerEvent",required:!0,property:"signal"}},[t("bk-select",{attrs:{"data-test-id":"triggers_select_choiceEvent",placeholder:e.$t("m.trigger['请选择触发事件']")},on:{change:function(t){return e.$emit("change")}},model:{value:e.formData.signal,callback:function(t){e.$set(e.formData,"signal",t)},expression:"formData.signal"}},e._l(e.triggerEventList,(function(i,n){return t("bk-option-group",{key:n,attrs:{name:i.name}},e._l(i.children,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)})),1)],1),e._v(" "),t("bk-form-item",{attrs:{"data-test-id":"trigger-div-triggerRules",label:e.$t("m.trigger['触发规则']"),required:!0}},[t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.contentLoading},expression:"{ isLoading: contentLoading }"}],staticStyle:{"min-height":"300px"}},[e._l(e.rulesList,(function(i,n){return t("div",{key:n,staticClass:"bk-trigger-rule mb10"},[t("div",{staticClass:"bk-rule-title"},[t("div",{staticStyle:{float:"left","margin-right":"10px"}},[i.showContent?t("i",{staticClass:"bk-icon icon-down-shape icon-cus",on:{click:function(t){return e.showContent(i)}}}):t("i",{staticClass:"bk-icon icon-right-shape icon-cus",on:{click:function(t){return e.showContent(i)}}})]),e._v(" "),i.nameChange?t("div",{staticClass:"bk-name-input"},[t("bk-input",{staticStyle:{width:"260px",display:"inline-block"},attrs:{clearable:!0},on:{change:function(t){return e.$emit("change")}},model:{value:i.name,callback:function(t){e.$set(i,"name",t)},expression:"item.name"}}),e._v(" "),t("span",{staticClass:"bk-input-submit",on:{click:function(t){return t.stopPropagation(),e.handleClickName(i,"submit")}}},[e._v(e._s(e.$t("m.trigger['确认']")))]),e._v(" "),t("span",{staticClass:"bk-input-submit",on:{click:function(t){return t.stopPropagation(),e.handleClickName(i,"close")}}},[e._v(e._s(e.$t("m.trigger['取消']")))])],1):t("span",{staticClass:"bk-title-name",on:{click:function(t){return t.stopPropagation(),e.changeName(i)}}},[e._v("\n                "+e._s(i.name||e.$t("m.trigger['规则']")+"-"+(n+1))+"\n              ")]),e._v(" "),1!==e.rulesList.length?[t("i",{staticClass:"bk-icon icon-close icon-nodelete",on:{click:function(t){return t.stopPropagation(),e.deleteRule(n)}}})]:[t("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top-start",value:e.$t("m.trigger['规则不能为空']"),expression:"$t(`m.trigger['规则不能为空']`)",modifiers:{"top-start":!0}}],staticClass:"bk-icon icon-close icon-nodelete",attrs:{"data-test-id":"trigger_i_closeTriggerRule"}})],e._v(" "),t("div",{staticClass:"bk-condition-switch"},[t("span",{staticClass:"mr5"},[e._v(e._s(e.$t("m.trigger['条件触发']")))]),e._v(" "),t("bk-switcher",{attrs:{"data-test-id":"triggers_switcher_conditionTriggered",size:"small"},on:{change:function(t){return e.$emit("change")}},model:{value:i.triggerStatus,callback:function(t){e.$set(i,"triggerStatus",t)},expression:"item.triggerStatus"}})],1)],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:i.showContent,expression:"item.showContent"}]},[i.triggerStatus?t("trigger-condition",{attrs:{"trigger-rules":i.triggerRules}}):e._e(),e._v(" "),t("response-condition",{attrs:{signal:e.formData.signal,"response-way-list":e.responseWayList,"response-list":i.responseList}})],1)])})),e._v(" "),t("p",{staticClass:"bk-add-rules",on:{click:e.addRule}},[t("i",{staticClass:"bk-icon icon-plus-circle"}),t("span",{attrs:{"data-test-id":"trigger_span_addTriggerRules"}},[e._v(e._s(e.$t("m.trigger['添加规则']")))])])],2)])],1)],1),e._v(" "),t("div",{staticClass:"bk-submit-trigger"},[t("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"trigger_button_submitTrigger",title:e.$t("m.trigger['确认']"),disabled:e.btnLoading},on:{click:function(t){return e.submitTrigger(!1)}}},[e._v("\n      "+e._s(e.$t("m.trigger['确认']"))+"\n    ")]),e._v(" "),t("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"trigger_button_submitTrigger",title:e.$t("m.trigger['保持草稿']"),disabled:e.btnLoading},on:{click:function(t){return e.submitTrigger(!0)}}},[e._v("\n      "+e._s(e.$t("m.trigger['保持草稿']"))+"\n    ")]),e._v(" "),t("bk-button",{attrs:{theme:"default","data-test-id":"trigger_button_KeepDraft",disabled:e.btnLoading,title:e.$t("m.trigger['取消']")},on:{click:e.closeTrigger}},[e._v("\n      "+e._s(e.$t("m.trigger['取消']"))+"\n    ")])],1)])},a=[];n._withStripped=!0},xBbh:function(e,t,i){},xXNg:function(e,t,i){"use strict";i("n6O2")},xgIe:function(e,t,i){"use strict";i("m4Da")},"xl+m":function(e,t,i){"use strict";i.r(t);var n=i("CPxG"),a=i("1hFm");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("yfOj");var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,"1dd614c2",null);t.default=o.exports},xvv9:function(e,t,i){i("cHUd")("Set")},y5Cw:function(e,t,i){"use strict";i("rcsN")},yfOj:function(e,t,i){"use strict";i("jK1o")},ymPp:function(e,t,i){"use strict";i.r(t);var n=i("7DqX"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t.default=a.a},"z/5e":function(e,t,i){e.exports={default:i("Nxk6"),__esModule:!0}},"z/kA":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i("gDS+")),a=c(i("u8Ap")),r=c(i("ybrk")),s=c(i("hk/f")),o=i("dGg1"),l=i("CeR/");function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"defaultValue",components:{memberSelect:a.default,RichTextEditor:r.default,CodeEditor:s.default},props:{formInfo:{type:Object,default:function(){return{}}},fieldInfo:{type:Object,default:function(){return{}}},dictionaryData:{type:Object,default:function(){return{}}},changeInfo:{type:Object,default:function(){return{}}},label:{type:String,default:""},checkStatus:{type:Object,default:function(){return{}}}},data:function(){return{selectList:[],updateStatus:!1,typeList:["MULTISELECT","CHECKBOX","MEMBERS","MEMBER"],precision:0}},watch:{"formInfo.source_type":function(){var e=this;this.updateStatus&&(this.formInfo.default_value=this.typeList.some((function(t){return t===e.formInfo.type}))?[]:""),this.formInfo.source_type!==this.changeInfo.source_type&&(this.updateStatus=!0,this.formInfo.default_value=this.typeList.some((function(t){return t===e.formInfo.type}))?[]:""),"API"!==this.formInfo.source_type&&"RPC"!==this.formInfo.source_type||(this.formInfo.default_value="")},"formInfo.type":function(){var e=this;this.updateStatus&&(this.formInfo.default_value=this.typeList.some((function(t){return t===e.formInfo.type}))?[]:""),this.formInfo.type!==this.changeInfo.type&&(this.updateStatus=!0,this.formInfo.default_value=this.typeList.some((function(t){return t===e.formInfo.type}))?[]:""),"API"!==this.formInfo.source_type&&"RPC"!==this.formInfo.source_type||(this.formInfo.default_value="")},"formInfo.default_value":function(){"CUSTOM-FORM"===this.formInfo.type&&(this.checkStatus.customFormStatus=!1)}},mounted:function(){this.changeInfo.id&&"DATADICT"===this.changeInfo.source_type&&this.getDictionList(this.changeInfo.source_uri),""!==this.formInfo.default_value&&this.getSelectList(this.formInfo.default_value)},methods:{getSelectList:function(e){this.selectList=[],e&&("CUSTOM"===this.formInfo.source_type?this.selectList=this.fieldInfo.list.filter((function(e){return e.key&&e.name})):"DATADICT"===this.formInfo.source_type?this.dictionaryData.check&&this.getDictionList(this.dictionaryData.check):"API"!==this.formInfo.source_type&&"RPC"!==this.formInfo.source_type||this.getApiList())},getDictionList:function(e){var t=this,i={key:e};this.$store.dispatch("datadict/get_data_by_key",i).then((function(e){t.selectList=e.data})).catch((function(e){(0,l.errorHandler)(e,t)}))},downCustomFormTempalte:function(){var e=document.createElement("a"),t=+new Date;e.download="bk_itsm_custom_form_template_"+t+".json",e.href="data:text/plain,"+(0,n.default)(o.CUSTOM_FORM_TEMPLATE,null,4),e.click()},getApiList:function(){}}}},z1yn:function(e,t,i){"use strict";i.r(t);var n=i("8aPs"),a=i("wegR");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);var s=i("KHd+"),o=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);t.default=o.exports},zCbU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("u8Ap")),a=s(i("db1v")),r=i("CeR/");function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"COMPLEX-MEMBERS",components:{SelectTree:a.default,memberSelect:n.default},props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},checkValue:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1}},data:function(){return{isLoading:!1,formData:{levelOne:"",levelSecond:[]},secondLevelList:[],organizationList:[]}},computed:{firstLevelList:function(){var e=this.$store.state.common.configurInfo.processor_type,t=["OPEN","STARTER","BY_ASSIGNOR","EMPTY","VARIABLE","CMDB","ORGANIZATION"];return e.filter((function(e){return!t.some((function(t){return t===e.typeName}))}))}},mounted:function(){this.formData.levelOne="PERSON",this.getSecondLevelList(this.formData.levelOne)},methods:{getSecondLevelList:function(e){this.formData.levelSecond=[],this.secondLevelList=[],"ORGANIZATION"===e?(this.formData.levelSecond="",this.getOrganization()):"PERSON"===e?this.secondLevelList=[]:"GENERAL"===e?(this.formData.levelSecond="",this.secondListFn(e)):this.secondListFn(e)},secondListFn:function(e){var t=this;e&&(this.isLoading=!0,this.$store.dispatch("deployCommon/getSecondUser",{role_type:e,project_key:this.$store.state.project.id}).then((function(i){var n=i.data,a=[];"GENERAL"===e?n.forEach((function(e){a.push({id:String(e.id),name:e.name+"("+e.count+")",disabled:0===e.count})})):n.forEach((function(e){a.push({id:String(e.id),name:e.name})})),t.secondLevelList=a})).catch((function(e){(0,r.errorHandler)(e,t)})).finally((function(){t.isLoading=!1})))},getOrganization:function(){var e=this;this.$store.dispatch("cdeploy/getTreeInfo").then((function(t){e.organizationList=t.data})).catch((function(t){(0,r.errorHandler)(t,e)}))}}}},zcr8:function(e,t,i){},zfNu:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i("GQeE")),a=o(i("gDS+")),r=o(i("QbLZ")),s=o(i("5hmv"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"FILE",components:{customUpload:s.default},props:{item:{type:Object,required:!0,default:function(){}},idInfo:{type:Object,required:!1,default:function(){return null}},isCurrent:{type:Boolean,default:!1},isFilePreview:{type:Boolean,default:!1},isBuild:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{datas:[],uploadFileList:[],tempFileList:[],historyList:[],url:this.isFilePreview?"":window.SITE_URL+"api/misc/upload_file/",tempObj:{}}},mounted:function(){this.item.val=[],this.choiceToList()},methods:{choiceToList:function(){for(var e in this.item.choice)this.tempFileList.push((0,r.default)({},this.item.choice[e],{key:e}));if(this.item.value){var t=JSON.parse(this.item.value);for(var i in t)this.historyList.push((0,r.default)({},t[i],{key:i}));this.datas=this.historyList.concat([]),this.item.val="";var n=[];this.datas.forEach((function(e){var t={};t[e.key]={path:e.path,name:e.name},n.push((0,a.default)(t))})),this.item.val=n.join(",")}},downloadFile:function(e){var t=e.key;this.isBuild?window.open(window.SITE_URL+"api/ticket/fields/"+this.item.id+"/download_file/?unique_key="+t+"&file_type=version&flow_id="+this.item.version_id):this.isCurrent?window.open(window.SITE_URL+"api/ticket/fields/"+this.item.id+"/download_file/?unique_key="+t+"&file_type=template"):window.open(window.SITE_URL+"api/workflow/fields/"+this.item.id+"/download_file/?unique_key="+t+"&file_type=template")},uploadErr:function(){},uploadSuccess:function(e){var t=this;this.datas=e,this.uploadFileList=e,this.item.value="",this.item.val=this.item.value,e.forEach((function(e){if(!e.errorMsg&&e.responseData.data)for(var i in e.responseData.data.succeed_files)t.$set(t.tempObj,i,e.responseData.data.succeed_files[i])})),this.historyList.length&&(this.datas=this.datas.concat(this.historyList),this.historyList.forEach((function(e){t.tempObj[e.key]={path:e.path,name:e.name}}))),this.item.value=(0,a.default)(this.tempObj),this.item.val=this.item.value},uploadProgress:function(){this.$store.commit("changeFileStatus",!0)},uploadDone:function(){this.$store.commit("changeFileStatus",!1)},deleteFile:function(e){if(this.datas.splice(this.datas.indexOf(e),1),this.historyList.length&&this.historyList.some((function(t){return t.key===e.key})))for(var t in this.historyList=this.historyList.filter((function(t){return t.key!==e.key})),this.tempObj)t===e.key&&delete this.tempObj[t];else for(var i in this.tempObj)for(var r in e.responseData.data.succeed_files)i===r&&delete this.tempObj[i];var s=this.uploadFileList.indexOf(e);-1!==s&&this.$refs.upload.deleteFile(s,e),(0,n.default)(this.tempObj).length?this.item.val=(0,a.default)(this.tempObj):this.item.val=""}}}},zi6X:function(e,t,i){}}]);