(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"6kK8":function(t,e,s){t.exports=s.p+"assets/img/setting-group.c749763.svg"},CgoI:function(t,e,s){"use strict";s.d(e,"a",(function(){return r})),s.d(e,"b",(function(){return a}));var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bk-itsm-service"},[e("div",{staticClass:"is-title",class:{"bk-title-left":!t.sliderStatus}},[e("p",{staticClass:"bk-come-back"},[t._v("\n      "+t._s(t.$t('m["自定义角色组"]'))+"\n    ")])]),t._v(" "),e("div",{staticClass:"itsm-page-content"},[!t.isDataLoading&&0===t.tableList.length&&t.searchToggle?e("empty-tip",{attrs:{title:t.emptyTip.title,"sub-title":t.emptyTip.subTitle,desc:t.emptyTip.desc,links:t.emptyTip.links}},[e("template",{slot:"btns"},[e("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!t.hasPermission(["user_group_create"],t.$store.state.project.projectAuthActions)},expression:"{ active: !hasPermission(['user_group_create'], $store.state.project.projectAuthActions) }"}],class:{"btn-permission-disable":!t.hasPermission(["user_group_create"],t.$store.state.project.projectAuthActions)},attrs:{theme:"primary","data-test-id":"userGroup_button_create_permission"},on:{click:function(e){return t.showEditor({name:"",staffInputValue:[],ownersInputValue:[]},"new")}}},[t._v("\n          "+t._s(t.$t("m['立即创建']"))+"\n        ")])],1)],2):[e("div",{staticClass:"bk-only-btn"},[e("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!t.hasPermission(["user_group_create"],t.$store.state.project.projectAuthActions)},expression:"{ active: !hasPermission(['user_group_create'], $store.state.project.projectAuthActions) }"}],class:["mr10","plus-cus",{"btn-permission-disable":!t.hasPermission(["user_group_create"],t.$store.state.project.projectAuthActions)}],attrs:{theme:"primary","data-test-id":"userGroup_button_create",icon:"plus",title:t.$t("m.deployPage['新增']")},on:{click:function(e){return t.showEditor({name:"",staffInputValue:[],ownersInputValue:[]},"new")}}},[t._v("\n          "+t._s(t.$t("m.deployPage['新增']"))+"\n        ")]),t._v(" "),e("div",{staticClass:"bk-only-search"},[e("bk-input",{attrs:{"data-test-id":"userGroup_input_search",placeholder:t.$t("m.systemConfig['请输入角色名称']"),clearable:!0,"right-icon":"bk-icon icon-search"},on:{enter:function(e){return t.getList(1)},clear:function(e){return t.getList(1)}},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}})],1)],1),t._v(" "),e("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isDataLoading},expression:"{ isLoading: isDataLoading }"}],attrs:{data:t.tableList,size:"small"}},[e("bk-table-column",{attrs:{label:t.$t("m.common['ID']"),"min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{attrs:{title:s.row.id}},[t._v(t._s(s.row.id||"--"))])]}}])}),t._v(" "),e("bk-table-column",{attrs:{"render-header":t.$renderHeader,"show-overflow-tooltip":!0,label:t.$t("m['角色组名']"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{attrs:{title:s.row.name}},[t._v(t._s(s.row.name||"--"))])]}}])}),t._v(" "),e("bk-table-column",{attrs:{"render-header":t.$renderHeader,"show-overflow-tooltip":!0,label:t.$t("m.user['人员']")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{attrs:{title:s.row.members}},[t._v(t._s(s.row.members))])]}}])}),t._v(" "),e("bk-table-column",{attrs:{"render-header":t.$renderHeader,"show-overflow-tooltip":!0,label:t.$t("m.common['创建人']")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{attrs:{title:s.row.creator}},[t._v(t._s(s.row.creator||"--"))])]}}])}),t._v(" "),e("bk-table-column",{attrs:{"render-header":t.$renderHeader,"show-overflow-tooltip":!0,label:t.$t("m.common['负责人']")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{attrs:{title:s.row.owners}},[t._v(t._s(s.row.owners||"--"))])]}}])}),t._v(" "),e("bk-table-column",{attrs:{label:t.$t("m.user['操作']"),width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!t.hasPermission(["user_group_edit"],[...s.row.auth_actions,...t.$store.state.project.projectAuthActions])},expression:"{ active: !hasPermission(['user_group_edit'], [...props.row.auth_actions, ...$store.state.project.projectAuthActions]) }"}],class:[{"btn-permission-disable":!t.hasPermission(["user_group_edit"],[...s.row.auth_actions,...t.$store.state.project.projectAuthActions])}],attrs:{"data-test-id":"userGroup_button_edit",theme:"primary",text:""},on:{click:function(e){return t.showEditor(s.row,"edit")}}},[t._v("\n              "+t._s(t.$t('m.user["编辑"]'))+"\n            ")]),t._v(" "),s.row.is_builtin?t._e():e("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!t.hasPermission(["user_group_delete"],[...s.row.auth_actions,...t.$store.state.project.projectAuthActions])},expression:"{ active: !hasPermission(['user_group_delete'], [...props.row.auth_actions, ...$store.state.project.projectAuthActions]) }"}],class:[{"btn-permission-disable":!t.hasPermission(["user_group_delete"],[...s.row.auth_actions,...t.$store.state.project.projectAuthActions])}],attrs:{"data-test-id":"userGroup_button_delete",theme:"primary",text:""},on:{click:function(e){return t.deleteUser(s.row)}}},[t._v("\n              "+t._s(t.$t('m.user["删除"]'))+"\n            ")])]}}])}),t._v(" "),e("div",{staticClass:"empty",attrs:{slot:"empty"},slot:"empty"},[e("empty",{attrs:{"is-error":t.listError,"is-search":!t.searchToggle},on:{onRefresh:function(e){return t.getList()},onClearSearch:function(e){return t.getList(1)}}})],1)],1)]],2),t._v(" "),e("bk-dialog",{attrs:{"data-test-id":"userGroup_dialog_editAndCreate","render-directive":"if",width:t.openDialog.width,"header-position":t.openDialog.headerPosition,loading:t.secondClick,"auto-close":t.openDialog.autoClose,"mask-close":t.openDialog.autoClose},on:{confirm:t.submitUser},model:{value:t.openDialog.isShow,callback:function(e){t.$set(t.openDialog,"isShow",e)},expression:"openDialog.isShow"}},[e("p",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.itemContent.id?t.$t('m["修改自定义角色组"]'):t.$t('m["新增自定义角色组"]')))]),t._v(" "),e("div",{staticClass:"bk-add-project bk-add-module"},[e("bk-form",{ref:"dynamicForm",attrs:{"label-width":200,"form-type":"vertical",rules:t.rules,model:t.formData}},[e("bk-form-item",{attrs:{"data-test-id":"role-input-roleName",label:t.$t("m['角色组名：']"),required:!0,property:"name"}},[e("bk-input",{attrs:{maxlength:"120"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name","string"==typeof e?e.trim():e)},expression:"formData.name"}})],1),t._v(" "),e("bk-form-item",{attrs:{"data-test-id":"role-input-staffList",label:t.$t("m.user['人员名单：']"),required:!0}},[e("member-select",{model:{value:t.formData.staffInputValue,callback:function(e){t.$set(t.formData,"staffInputValue",e)},expression:"formData.staffInputValue"}})],1),t._v(" "),e("bk-form-item",{attrs:{label:t.$t("m.user['负责人：']")}},[e("member-select",{model:{value:t.formData.ownersInputValue,callback:function(e){t.$set(t.formData,"ownersInputValue",e)},expression:"formData.ownersInputValue"}})],1)],1)],1)])],1)},a=[];r._withStripped=!0},H0Ha:function(t,e,s){"use strict";s.r(e);var r=s("cHy4"),a=s.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return r[t]}))}(i);e.default=a.a},OVUe:function(t,e,s){"use strict";s.r(e);var r=s("CgoI"),a=s("H0Ha");for(var i in a)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return a[t]}))}(i);var o=s("KHd+"),n=Object(o.a)(a.default,r.a,r.b,!1,null,null,null);e.default=n.exports},Qa33:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"EmptyPageTip",props:{title:{type:String,value:""},subTitle:{type:String,value:""},desc:{type:Array,default:function(){return[]}},links:{type:Array,default:function(){return[]}}}}},"Re/m":function(t,e,s){"use strict";s.d(e,"a",(function(){return r})),s.d(e,"b",(function(){return a}));var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"empty-page-tip"},[e("div",{staticClass:"tip-content-wrap"},[e("h3",[t._v(t._s(t.title))]),t._v(" "),e("p",[t._v(t._s(t.subTitle))]),t._v(" "),e("div",{staticClass:"btns-area"},[t._t("btns")],2),t._v(" "),e("div",{staticClass:"desc-area"},t._l(t.desc,(function(s,r){return e("div",{key:r,staticClass:"desc-item"},[e("div",{staticClass:"desc-img"},[e("img",{attrs:{src:s.src,alt:"tips"}})]),t._v(" "),e("div",{staticClass:"desc-content"},[e("h4",[t._v(t._s(s.title))]),t._v(" "),e("p",[t._v(t._s(s.content))])])])})),0),t._v(" "),e("div",{staticClass:"link-area"},t._l(t.links,(function(s,r){return e("div",{key:r,staticClass:"link-item"},[t._v("\n        "+t._s(s.text)+"\n        "),e("a",{staticClass:"link-btn",attrs:{href:s.href,target:"_blank"}},[t._v("\n          "+t._s(s.btn)+"\n          "),e("i",{staticClass:"bk-itsm-icon icon-itsm-icon-three-seven"})])])})),0)])])},a=[];r._withStripped=!0},Ss2a:function(t,e,s){},cHy4:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=c(s("m1cH")),a=c(s("u8Ap")),i=c(s("0hVY")),o=s("CeR/"),n=c(s("gzP0")),u=c(s("hztf"));function c(t){return t&&t.__esModule?t:{default:t}}e.default={components:{memberSelect:a.default,EmptyTip:n.default,Empty:u.default},mixins:[i.default],data:function(){return{secondClick:!1,isDataLoading:!1,tableList:[],openDialog:{isShow:!1,width:700,headerPosition:"left",autoClose:!1},rules:{name:[{required:!0,message:this.$t('m.systemConfig["格式为长度小于120"]'),trigger:"blur"},{max:120,message:this.$t('m.systemConfig["格式为长度小于120"]'),trigger:"blur"}]},formData:{name:"",staffInputValue:[],ownersInputValue:[]},itemContent:{},searchName:"",searchToggle:!1,listError:!1,emptyTip:{title:this.$t("m['当前项目下还没有 <用户组>']"),subTitle:this.$t("m['同一个职能团队可能会出现在多个不同的服务处理流程中，为了达到人员配置的一致性管理目的，你只需将对应的人员设置到同一个<用户组>中即可，这样便可以在不同的服务中配置引用它。']"),desc:[{src:s("6kK8"),title:this.$t("m['配置用户组的名称和成员']"),content:this.$t("m['你只需要为其设计一个合理的名称（如：行政仓库管理员、IT技术人员、等等...），并将相应的成员加入到该用户组中即可。']")},{src:s("ntqO"),title:this.$t("m['在服务流程配置中使用它']"),content:this.$t("m['服务的处理流程节点中，你可以在处理人、关注人等跟人员属性有关的字段中使用<用户组>；这种“引用”的逻辑，可以达到在一个地方编辑，所有引用方同时更新的效果，提升配置管理的效率。']")}],links:[{text:this.$t("m['快速入门如何配置一个用户组']"),btn:this.$t("m['产品白皮书']"),href:"https://bk.tencent.com/docs/document/6.0/145/6592"}]}}},computed:{sliderStatus:function(){return this.$store.state.common.slideStatus}},mounted:function(){this.getList()},methods:{getList:function(t){var e=this;this.isDataLoading=!0;var s={role_type:"GENERAL",name__icontains:this.searchName,project_key:this.$store.state.project.id};t&&(this.searchName=""),this.listError=!1,this.$store.dispatch("user/getRoleList",s).then((function(t){e.tableList=t.data,e.searchToggle=0!==t.data.length,e.tableList.forEach((function(t){e.$set(t,"staffInputValue",t.members?t.members.split(","):[]),e.$set(t,"ownersInputValue",t.owners?t.owners.split(","):[])}))})).catch((function(t){e.listError=!0,(0,o.errorHandler)(t,e)})).finally((function(){e.isDataLoading=!1}))},submitUser:function(){var t=this;this.$refs.dynamicForm.validate().then((function(){0!==t.formData.staffInputValue.length?t.secondClick||(t.secondClick=!0,t.itemContent.id?t.updateUser():t.addUser()):t.$bkMessage({message:t.$t('m.user["人员不能为空！"]'),theme:"warning"})}))},addUser:function(){var t=this,e={members:"",name:this.formData.name,role_type:"GENERAL",project_key:this.$store.state.project.id};e.members=this.formData.staffInputValue.join(","),e.owners=this.formData.ownersInputValue.join(","),this.$store.dispatch("user/submit",e).then((function(){t.$bkMessage({message:t.$t("m.user['新增成功']"),theme:"success"}),t.openDialog.isShow=!1,t.getList()})).catch((function(e){(0,o.errorHandler)(e,t)})).finally((function(){t.secondClick=!1}))},updateUser:function(){var t=this,e={id:this.itemContent.id,role_key:this.itemContent.role_key,members:"",name:this.formData.name,role_type:"GENERAL",project_key:this.$store.state.project.id};e.members=this.formData.staffInputValue.join(","),e.owners=this.formData.ownersInputValue.join(","),this.$store.dispatch("user/update",e).then((function(){t.$bkMessage({message:t.$t("m.user['保存成功']"),theme:"success"}),t.openDialog.isShow=!1,t.getList()})).catch((function(e){(0,o.errorHandler)(e,t)})).finally((function(){t.secondClick=!1}))},showEditor:function(t,e){var s="new"===e?"user_group_create":"user_group_edit",a="new"===e?this.$store.state.project.projectAuthActions:[].concat((0,r.default)(this.$store.state.project.projectAuthActions),(0,r.default)(t.auth_actions));if(!this.hasPermission([s],a||[])){var i={},o=this.$store.state.project.projectInfo;return i="user_group_create"===s?{project:[{id:o.key,name:o.name}]}:{project:[{id:o.key,name:o.name}],user_group:[{id:t.id,name:t.name}]},this.applyForPermission([s],a,i),!1}this.openDialog.isShow=!0,this.formData.name=t.name,this.formData.staffInputValue=t.staffInputValue,this.formData.ownersInputValue=t.ownersInputValue,this.itemContent=t},deleteUser:function(t){var e=this;if(!this.hasPermission(["user_group_delete"],[].concat((0,r.default)(this.$store.state.project.projectAuthActions),(0,r.default)(t.auth_actions)))){var s=this.$store.state.project.projectInfo,a={project:[{id:s.key,name:s.name}],user_group:[{id:t.id,name:t.name}]};return this.applyForPermission(["user_group_delete"],[].concat((0,r.default)(this.$store.state.project.projectAuthActions),(0,r.default)(t.auth_actions)),a),!1}this.$bkInfo({type:"warning",title:this.$t('m.user["确认要删除此角色？"]'),confirmFn:function(){var s=t.id;e.secondClick||(e.secondClick=!0,e.$store.dispatch("user/delete",s).then((function(){e.$bkMessage({message:e.$t('m.user["删除成功"]'),theme:"success"})})).catch((function(t){(0,o.errorHandler)(t,e)})).finally((function(){e.secondClick=!1,e.getList()})))}})},handleChange:function(t,e){this.formData.staffInputValue=e}}}},ch58:function(t,e,s){"use strict";s("Ss2a")},gzP0:function(t,e,s){"use strict";s.r(e);var r=s("Re/m"),a=s("ltoX");for(var i in a)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return a[t]}))}(i);s("ch58");var o=s("KHd+"),n=Object(o.a)(a.default,r.a,r.b,!1,null,"02db9a5a",null);e.default=n.exports},ltoX:function(t,e,s){"use strict";s.r(e);var r=s("Qa33"),a=s.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return r[t]}))}(i);e.default=a.a},ntqO:function(t,e,s){t.exports=s.p+"assets/img/use-group.3b85d52.svg"}}]);