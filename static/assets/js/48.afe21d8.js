(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{Bbko:function(t,e,o){"use strict";o.r(e);var i=o("tBf1"),n=o("g3if");for(var s in n)["default"].indexOf(s)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(s);o("MWF6");var a=o("KHd+"),r=Object(a.a)(n.default,i.a,i.b,!1,null,"7efbbcc0",null);e.default=r.exports},Dvz2:function(t,e,o){},GNPu:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=f(o("QbLZ")),n=f(o("Y+p1")),s=o("CeR/"),a=f(o("Whvt")),r=f(o("0hVY")),c=o("L2JU"),l=f(o("hztf"));function f(t){return t&&t.__esModule?t:{default:t}}e.default={name:"noticeConfigure",components:{editorNotice:a.default,Empty:l.default},mixins:[r.default],data:function(){return{isDataLoading:!0,remindWayList:[{id:"WEIXIN",name:this.$t('m.treeinfo["企业微信"]')},{id:"EMAIL",name:this.$t('m.treeinfo["邮件"]')},{id:"SMS",name:this.$t('m.treeinfo["手机短信"]')}],checkId:"WEIXIN",noticeList:[],noticeInfo:{show:!1,title:this.$t('m.deployPage["编辑"]'),width:700,formInfo:{}},listError:!1}},computed:(0,i.default)({sliderStatus:function(){return this.$store.state.common.slideStatus}},(0,c.mapState)({noticeType:function(t){return t.common.configurInfo.notify_type}})),mounted:function(){this.getNoticeList(),console.log(this.noticeInfo)},methods:{getNoticeList:function(){var t=this;this.isDataLoading=!0,this.listError=!1;var e={notify_type:this.checkId};this.$store.dispatch("noticeConfigure/getNoticeList",{params:e}).then((function(e){t.noticeList=e.data})).catch((function(e){t.listError=!0,(0,s.errorHandler)(e,t)})).finally((function(){t.isDataLoading=!1}))},changeNotice:function(t){this.checkId=t.typeName,this.getNoticeList()},editorInfo:function(t){this.hasPermission(["notification_manage"],this.$store.state.project.projectAuthActions)?(this.noticeInfo.formInfo=t,this.noticeInfo.show=!0):this.applyForPermission(["notification_manage"],this.$store.state.project.projectAuthActions,{})},closeEditor:function(){this.noticeInfo.show=!1},closeSideslider:function(){var t=this;(0,n.default)(this.$refs.editorNotice.formInfo,this.$refs.editorNotice.initFromData)?this.noticeInfo.show=!1:this.$bkInfo({title:this.$t('m["确定离开当前页？"]'),subTitle:this.$t('m["离开将会导致未保存信息丢失"]'),okText:this.$t('m["离开"]'),confirmLoading:!0,confirmFn:function(){t.noticeInfo.show=!1},cancelFn:function(){t.noticeInfo.show=!0}})}}}},MWF6:function(t,e,o){"use strict";o("Dvz2")},g3if:function(t,e,o){"use strict";o.r(e);var i=o("GNPu"),n=o.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(s);e.default=n.a},tBf1:function(t,e,o){"use strict";o.d(e,"a",(function(){return i})),o.d(e,"b",(function(){return n}));var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bk-itsm-service"},[e("div",{staticClass:"is-title",class:{"bk-title-left":!t.sliderStatus}},[e("p",{staticClass:"bk-come-back"},[t._v("\n      "+t._s(t.$t('m.navigation["通知配置"]'))+"\n    ")])]),t._v(" "),e("div",{staticClass:"itsm-page-content"},[e("ul",{staticClass:"bk-notice-tab"},t._l(t.noticeType,(function(o,i){return e("li",{key:o.typeName,class:{"bk-check-notice":t.checkId===o.typeName},on:{click:function(e){return t.changeNotice(o,i)}}},[e("span",[t._v(t._s(o.name))])])})),0),t._v(" "),e("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isDataLoading},expression:"{ isLoading: isDataLoading }"}],attrs:{data:t.noticeList,size:"small"}},[e("bk-table-column",{attrs:{type:"index",label:"No.",align:"center",width:"60"}}),t._v(" "),e("bk-table-column",{attrs:{"render-header":t.$renderHeader,"show-overflow-tooltip":!0,label:t.$t("m.deployPage['通知类型']")},scopedSlots:t._u([{key:"default",fn:function(o){return[t.hasPermission(["notification_manage"],t.$store.state.project.projectAuthActions)?[e("span",{staticClass:"bk-lable-primary",on:{click:function(e){return t.editorInfo(o.row)}}},[t._v(t._s(o.row.action_name))])]:e("span",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!t.hasPermission(["notification_manage"],t.$store.state.project.projectAuthActions)},expression:"{ active: !hasPermission(['notification_manage'], $store.state.project.projectAuthActions) }"}],staticClass:"bk-table-permission",on:{click:function(e){return t.editorInfo(o.row)}}},[t._v(t._s(o.row.action_name))])]}}])}),t._v(" "),e("bk-table-column",{attrs:{"render-header":t.$renderHeader,"show-overflow-tooltip":!0,label:t.$t("m.slaContent['更新时间']"),prop:"update_at"}}),t._v(" "),e("bk-table-column",{attrs:{"render-header":t.$renderHeader,"show-overflow-tooltip":!0,label:t.$t("m.deployPage['更新人']"),prop:"updated_by"}}),t._v(" "),e("bk-table-column",{attrs:{"show-overflow-tooltip":!0,label:t.$t("m.deployPage['操作']"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("bk-button",{directives:[{name:"cursor",rawName:"v-cursor",value:{active:!t.hasPermission(["notification_manage"],t.$store.state.project.projectAuthActions)},expression:"{ active: !hasPermission(['notification_manage'], $store.state.project.projectAuthActions) }"}],attrs:{theme:"primary",disabled:!t.hasPermission(["notification_manage"],t.$store.state.project.projectAuthActions),text:""},on:{click:function(e){return t.editorInfo(o.row)}}},[t._v("\n            "+t._s(t.$t('m.deployPage["编辑"]'))+"\n          ")])]}}])}),t._v(" "),e("div",{staticClass:"empty",attrs:{slot:"empty"},slot:"empty"},[e("empty",{attrs:{"is-error":t.listError},on:{onRefresh:function(e){return t.getNoticeList()}}})],1)],1)],1),t._v(" "),e("div",{staticClass:"bk-add-data"},[e("bk-sideslider",{attrs:{"is-show":t.noticeInfo.show,title:t.noticeInfo.title,"quick-close":!0,"before-close":t.closeSideslider,width:t.noticeInfo.width},on:{"update:isShow":function(e){return t.$set(t.noticeInfo,"show",e)},"update:is-show":function(e){return t.$set(t.noticeInfo,"show",e)}}},[t.noticeInfo.show?e("div",{staticStyle:{padding:"20px 34px"},attrs:{slot:"content"},slot:"content"},[e("editor-notice",{ref:"editorNotice",attrs:{"check-id":t.checkId,"notice-info":t.noticeInfo.formInfo},on:{closeEditor:t.closeEditor}})],1):t._e()])],1)])},n=[];i._withStripped=!0}}]);